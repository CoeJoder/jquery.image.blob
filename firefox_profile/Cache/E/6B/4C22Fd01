(function(){var e=this;var t=e._;var i={};var n=Array.prototype,a=Object.prototype,r=Function.prototype;var s=n.push,o=n.slice,l=n.concat,c=n.unshift,u=a.toString,d=a.hasOwnProperty;var f=n.forEach,h=n.map,p=n.reduce,m=n.reduceRight,g=n.filter,v=n.every,b=n.some,y=n.indexOf,_=n.lastIndexOf,w=Array.isArray,$=Object.keys,k=r.bind;var x=function(e){if(e instanceof x)return e;if(!(this instanceof x))return new x(e);this._wrapped=e};if(typeof exports!=="undefined"){if(typeof module!=="undefined"&&module.exports){exports=module.exports=x}exports._=x}else{e["_"]=x}x.VERSION="1.4.0";var C=x.each=x.forEach=function(e,t,n){if(f&&e.forEach===f){e.forEach(t,n)}else if(e.length===+e.length){for(var a=0,r=e.length;a<r;a++){if(t.call(n,e[a],a,e)===i)return}}else{for(var s in e){if(x.has(e,s)){if(t.call(n,e[s],s,e)===i)return}}}};x.map=x.collect=function(e,t,i){var n=[];if(h&&e.map===h)return e.map(t,i);C(e,function(e,a,r){n[n.length]=t.call(i,e,a,r)});return n};x.reduce=x.foldl=x.inject=function(e,t,i,n){var a=arguments.length>2;if(p&&e.reduce===p){if(n)t=x.bind(t,n);return a?e.reduce(t,i):e.reduce(t)}C(e,function(e,r,s){if(!a){i=e;a=true}else{i=t.call(n,i,e,r,s)}});if(!a)throw new TypeError("Reduce of empty array with no initial value");return i};x.reduceRight=x.foldr=function(e,t,i,n){var a=arguments.length>2;if(m&&e.reduceRight===m){if(n)t=x.bind(t,n);return arguments.length>2?e.reduceRight(t,i):e.reduceRight(t)}var r=e.length;if(r!==+r){var s=x.keys(e);r=s.length}C(e,function(o,l,c){l=s?s[--r]:--r;if(!a){i=e[l];a=true}else{i=t.call(n,i,e[l],l,c)}});if(!a)throw new TypeError("Reduce of empty array with no initial value");return i};x.find=x.detect=function(e,t,i){var n;D(e,function(e,a,r){if(t.call(i,e,a,r)){n=e;return true}});return n};x.filter=x.select=function(e,t,i){var n=[];if(g&&e.filter===g)return e.filter(t,i);C(e,function(e,a,r){if(t.call(i,e,a,r))n[n.length]=e});return n};x.reject=function(e,t,i){var n=[];C(e,function(e,a,r){if(!t.call(i,e,a,r))n[n.length]=e});return n};x.every=x.all=function(e,t,n){t||(t=x.identity);var a=true;if(v&&e.every===v)return e.every(t,n);C(e,function(e,r,s){if(!(a=a&&t.call(n,e,r,s)))return i});return!!a};var D=x.some=x.any=function(e,t,n){t||(t=x.identity);var a=false;if(b&&e.some===b)return e.some(t,n);C(e,function(e,r,s){if(a||(a=t.call(n,e,r,s)))return i});return!!a};x.contains=x.include=function(e,t){var i=false;if(y&&e.indexOf===y)return e.indexOf(t)!=-1;i=D(e,function(e){return e===t});return i};x.invoke=function(e,t){var i=o.call(arguments,2);return x.map(e,function(e){return(x.isFunction(t)?t:e[t]).apply(e,i)})};x.pluck=function(e,t){return x.map(e,function(e){return e[t]})};x.where=function(e,t){if(x.isEmpty(t))return[];return x.filter(e,function(e){for(var i in t){if(t[i]!==e[i])return false}return true})};x.max=function(e,t,i){if(!t&&x.isArray(e)&&e[0]===+e[0]&&e.length<65535){return Math.max.apply(Math,e)}if(!t&&x.isEmpty(e))return-Infinity;var n={computed:-Infinity};C(e,function(e,a,r){var s=t?t.call(i,e,a,r):e;s>=n.computed&&(n={value:e,computed:s})});return n.value};x.min=function(e,t,i){if(!t&&x.isArray(e)&&e[0]===+e[0]&&e.length<65535){return Math.min.apply(Math,e)}if(!t&&x.isEmpty(e))return Infinity;var n={computed:Infinity};C(e,function(e,a,r){var s=t?t.call(i,e,a,r):e;s<n.computed&&(n={value:e,computed:s})});return n.value};x.shuffle=function(e){var t;var i=0;var n=[];C(e,function(e){t=x.random(i++);n[i-1]=n[t];n[t]=e});return n};var P=function(e){return x.isFunction(e)?e:function(t){return t[e]}};x.sortBy=function(e,t,i){var n=P(t);return x.pluck(x.map(e,function(e,t,a){return{value:e,index:t,criteria:n.call(i,e,t,a)}}).sort(function(e,t){var i=e.criteria;var n=t.criteria;if(i!==n){if(i>n||i===void 0)return 1;if(i<n||n===void 0)return-1}return e.index<t.index?-1:1}),"value")};var I=function(e,t,i,n){var a={};var r=P(t);C(e,function(t,s){var o=r.call(i,t,s,e);n(a,o,t)});return a};x.groupBy=function(e,t,i){return I(e,t,i,function(e,t,i){(x.has(e,t)?e[t]:e[t]=[]).push(i)})};x.countBy=function(e,t,i){return I(e,t,i,function(e,t,i){if(!x.has(e,t))e[t]=0;e[t]++})};x.sortedIndex=function(e,t,i,n){i=i==null?x.identity:P(i);var a=i.call(n,t);var r=0,s=e.length;while(r<s){var o=r+s>>>1;i.call(n,e[o])<a?r=o+1:s=o}return r};x.toArray=function(e){if(!e)return[];if(e.length===+e.length)return o.call(e);return x.values(e)};x.size=function(e){return e.length===+e.length?e.length:x.keys(e).length};x.first=x.head=x.take=function(e,t,i){return t!=null&&!i?o.call(e,0,t):e[0]};x.initial=function(e,t,i){return o.call(e,0,e.length-(t==null||i?1:t))};x.last=function(e,t,i){if(t!=null&&!i){return o.call(e,Math.max(e.length-t,0))}else{return e[e.length-1]}};x.rest=x.tail=x.drop=function(e,t,i){return o.call(e,t==null||i?1:t)};x.compact=function(e){return x.filter(e,function(e){return!!e})};var S=function(e,t,i){C(e,function(e){if(x.isArray(e)){t?s.apply(i,e):S(e,t,i)}else{i.push(e)}});return i};x.flatten=function(e,t){return S(e,t,[])};x.without=function(e){return x.difference(e,o.call(arguments,1))};x.uniq=x.unique=function(e,t,i,n){var a=i?x.map(e,i,n):e;var r=[];var s=[];C(a,function(i,n){if(t?!n||s[s.length-1]!==i:!x.contains(s,i)){s.push(i);r.push(e[n])}});return r};x.union=function(){return x.uniq(l.apply(n,arguments))};x.intersection=function(e){var t=o.call(arguments,1);return x.filter(x.uniq(e),function(e){return x.every(t,function(t){return x.indexOf(t,e)>=0})})};x.difference=function(e){var t=l.apply(n,o.call(arguments,1));return x.filter(e,function(e){return!x.contains(t,e)})};x.zip=function(){var e=o.call(arguments);var t=x.max(x.pluck(e,"length"));var i=new Array(t);for(var n=0;n<t;n++){i[n]=x.pluck(e,""+n)}return i};x.object=function(e,t){var i={};for(var n=0,a=e.length;n<a;n++){if(t){i[e[n]]=t[n]}else{i[e[n][0]]=e[n][1]}}return i};x.indexOf=function(e,t,i){var n=0,a=e.length;if(i){if(typeof i=="number"){n=i<0?Math.max(0,a+i):i}else{n=x.sortedIndex(e,t);return e[n]===t?n:-1}}if(y&&e.indexOf===y)return e.indexOf(t,i);for(;n<a;n++)if(e[n]===t)return n;return-1};x.lastIndexOf=function(e,t,i){if(_&&e.lastIndexOf===_)return e.lastIndexOf(t,i);var n=i!=null?i:e.length;while(n--)if(e[n]===t)return n;return-1};x.range=function(e,t,i){if(arguments.length<=1){t=e||0;e=0}i=arguments[2]||1;var n=Math.max(Math.ceil((t-e)/i),0);var a=0;var r=new Array(n);while(a<n){r[a++]=e;e+=i}return r};var M=function(){};x.bind=function T(e,t){var i,n;if(e.bind===k&&k)return k.apply(e,o.call(arguments,1));if(!x.isFunction(e))throw new TypeError;n=o.call(arguments,2);return i=function(){if(!(this instanceof i))return e.apply(t,n.concat(o.call(arguments)));M.prototype=e.prototype;var a=new M;var r=e.apply(a,n.concat(o.call(arguments)));if(Object(r)===r)return r;return a}};x.bindAll=function(e){var t=o.call(arguments,1);if(t.length==0)t=x.functions(e);C(t,function(t){e[t]=x.bind(e[t],e)});return e};x.memoize=function(e,t){var i={};t||(t=x.identity);return function(){var n=t.apply(this,arguments);return x.has(i,n)?i[n]:i[n]=e.apply(this,arguments)}};x.delay=function(e,t){var i=o.call(arguments,2);return setTimeout(function(){return e.apply(null,i)},t)};x.defer=function(e){return x.delay.apply(x,[e,1].concat(o.call(arguments,1)))};x.throttle=function(e,t){var i,n,a,r,s,o;var l=x.debounce(function(){s=r=false},t);return function(){i=this;n=arguments;var c=function(){a=null;if(s){o=e.apply(i,n)}l()};if(!a)a=setTimeout(c,t);if(r){s=true}else{r=true;o=e.apply(i,n)}l();return o}};x.debounce=function(e,t,i){var n,a;return function(){var r=this,s=arguments;var o=function(){n=null;if(!i)a=e.apply(r,s)};var l=i&&!n;clearTimeout(n);n=setTimeout(o,t);if(l)a=e.apply(r,s);return a}};x.once=function(e){var t=false,i;return function(){if(t)return i;t=true;i=e.apply(this,arguments);e=null;return i}};x.wrap=function(e,t){return function(){var i=[e];s.apply(i,arguments);return t.apply(this,i)}};x.compose=function(){var e=arguments;return function(){var t=arguments;for(var i=e.length-1;i>=0;i--){t=[e[i].apply(this,t)]}return t[0]}};x.after=function(e,t){if(e<=0)return t();return function(){if(--e<1){return t.apply(this,arguments)}}};x.keys=$||function(e){if(e!==Object(e))throw new TypeError("Invalid object");var t=[];for(var i in e)if(x.has(e,i))t[t.length]=i;return t};x.values=function(e){var t=[];for(var i in e)if(x.has(e,i))t.push(e[i]);return t};x.pairs=function(e){var t=[];for(var i in e)if(x.has(e,i))t.push([i,e[i]]);return t};x.invert=function(e){var t={};for(var i in e)if(x.has(e,i))t[e[i]]=i;return t};x.functions=x.methods=function(e){var t=[];for(var i in e){if(x.isFunction(e[i]))t.push(i)}return t.sort()};x.extend=function(e){C(o.call(arguments,1),function(t){for(var i in t){e[i]=t[i]}});return e};x.pick=function(e){var t={};var i=l.apply(n,o.call(arguments,1));C(i,function(i){if(i in e)t[i]=e[i]});return t};x.omit=function(e){var t={};var i=l.apply(n,o.call(arguments,1));for(var a in e){if(!x.contains(i,a))t[a]=e[a]}return t};x.defaults=function(e){C(o.call(arguments,1),function(t){for(var i in t){if(e[i]==null)e[i]=t[i]}});return e};x.clone=function(e){if(!x.isObject(e))return e;return x.isArray(e)?e.slice():x.extend({},e)};x.tap=function(e,t){t(e);return e};var A=function(e,t,i,n){if(e===t)return e!==0||1/e==1/t;if(e==null||t==null)return e===t;if(e instanceof x)e=e._wrapped;if(t instanceof x)t=t._wrapped;var a=u.call(e);if(a!=u.call(t))return false;switch(a){case"[object String]":return e==String(t);case"[object Number]":return e!=+e?t!=+t:e==0?1/e==1/t:e==+t;case"[object Date]":case"[object Boolean]":return+e==+t;case"[object RegExp]":return e.source==t.source&&e.global==t.global&&e.multiline==t.multiline&&e.ignoreCase==t.ignoreCase}if(typeof e!="object"||typeof t!="object")return false;var r=i.length;while(r--){if(i[r]==e)return n[r]==t}i.push(e);n.push(t);var s=0,o=true;if(a=="[object Array]"){s=e.length;o=s==t.length;if(o){while(s--){if(!(o=A(e[s],t[s],i,n)))break}}}else{var l=e.constructor,c=t.constructor;if(l!==c&&!(x.isFunction(l)&&l instanceof l&&x.isFunction(c)&&c instanceof c)){return false}for(var d in e){if(x.has(e,d)){s++;if(!(o=x.has(t,d)&&A(e[d],t[d],i,n)))break}}if(o){for(d in t){if(x.has(t,d)&&!s--)break}o=!s}}i.pop();n.pop();return o};x.isEqual=function(e,t){return A(e,t,[],[])};x.isEmpty=function(e){if(e==null)return true;if(x.isArray(e)||x.isString(e))return e.length===0;for(var t in e)if(x.has(e,t))return false;return true};x.isElement=function(e){return!!(e&&e.nodeType===1)};x.isArray=w||function(e){return u.call(e)=="[object Array]"};x.isObject=function(e){return e===Object(e)};C(["Arguments","Function","String","Number","Date","RegExp"],function(e){x["is"+e]=function(t){return u.call(t)=="[object "+e+"]"}});if(!x.isArguments(arguments)){x.isArguments=function(e){return!!(e&&x.has(e,"callee"))}}if(typeof/./!=="function"){x.isFunction=function(e){return typeof e==="function"}}x.isFinite=function(e){return x.isNumber(e)&&isFinite(e)};x.isNaN=function(e){return x.isNumber(e)&&e!=+e};x.isBoolean=function(e){return e===true||e===false||u.call(e)=="[object Boolean]"};x.isNull=function(e){return e===null};x.isUndefined=function(e){return e===void 0};x.has=function(e,t){return d.call(e,t)};x.noConflict=function(){e._=t;return this};x.identity=function(e){return e};x.times=function(e,t,i){for(var n=0;n<e;n++)t.call(i,n)};x.random=function(e,t){if(t==null){t=e;e=0}return e+(0|Math.random()*(t-e+1))};var j={escape:{"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#x27;","/":"&#x2F;"}};j.unescape=x.invert(j.escape);var N={escape:new RegExp("["+x.keys(j.escape).join("")+"]","g"),unescape:new RegExp("("+x.keys(j.unescape).join("|")+")","g")};x.each(["escape","unescape"],function(e){x[e]=function(t){if(t==null)return"";return(""+t).replace(N[e],function(t){return j[e][t]})}});x.result=function(e,t){if(e==null)return null;var i=e[t];return x.isFunction(i)?i.call(e):i};x.mixin=function(e){C(x.functions(e),function(t){var i=x[t]=e[t];x.prototype[t]=function(){var e=[this._wrapped];s.apply(e,arguments);return H.call(this,i.apply(x,e))}})};var z=0;x.uniqueId=function(e){var t=z++;return e?e+t:t};x.templateSettings={evaluate:/<%([\s\S]+?)%>/g,interpolate:/<%=([\s\S]+?)%>/g,escape:/<%-([\s\S]+?)%>/g};var E=/(.)^/;var O={"'":"'","\\":"\\","\r":"r","\n":"n","	":"t","\u2028":"u2028","\u2029":"u2029"};var F=/\\|'|\r|\n|\t|\u2028|\u2029/g;x.template=function(e,t,i){i=x.defaults({},i,x.templateSettings);var n=new RegExp([(i.escape||E).source,(i.interpolate||E).source,(i.evaluate||E).source].join("|")+"|$","g");var a=0;var r="__p+='";e.replace(n,function(t,i,n,s,o){r+=e.slice(a,o).replace(F,function(e){return"\\"+O[e]});r+=i?"'+\n((__t=("+i+"))==null?'':_.escape(__t))+\n'":n?"'+\n((__t=("+n+"))==null?'':__t)+\n'":s?"';\n"+s+"\n__p+='":"";a=o+t.length});r+="';\n";if(!i.variable)r="with(obj||{}){\n"+r+"}\n";r="var __t,__p='',__j=Array.prototype.join,"+"print=function(){__p+=__j.call(arguments,'');};\n"+r+"return __p;\n";try{var s=new Function(i.variable||"obj","_",r)}catch(o){o.source=r;throw o}if(t)return s(t,x);var l=function(e){return s.call(this,e,x)};l.source="function("+(i.variable||"obj")+"){\n"+r+"}";return l};x.chain=function(e){return x(e).chain()};var H=function(e){return this._chain?x(e).chain():e};x.mixin(x);C(["pop","push","reverse","shift","sort","splice","unshift"],function(e){var t=n[e];x.prototype[e]=function(){var i=this._wrapped;t.apply(i,arguments);if((e=="shift"||e=="splice")&&i.length===0)delete i[0];return H.call(this,i)}});C(["concat","join","slice"],function(e){var t=n[e];x.prototype[e]=function(){return H.call(this,t.apply(this._wrapped,arguments))}});x.extend(x.prototype,{chain:function(){this._chain=true;return this},value:function(){return this._wrapped}})}).call(this);(function(e){e.fn.zCarousel=function(t){t=e.extend({itemsPerPage:1,circular:false,useTransitions:z.cssTransitions},t);var i=e(this).eq(0),n=e(".slider",i),a=n.find(".panel"),r=e(t.btnPrev),s=e(t.btnNext),o=t.prop||(e("body").hasClass("html-rtl")?"right":"left"),l=0,c=Math.ceil(a.length/t.itemsPerPage);if(!n.length)return i;function u(e){if(t.useTransitions){if(t.circular){l=e>c+1?e-c:e<0?e+c:e;if(n.hasClass("noslide")){l=e>c?1:e<1?c:e}}else{l=Math.min(Math.max(0,e),c-1)}}else{if(t.circular){l=e>c?1:e<1?c:e}else{l=Math.min(Math.max(0,e),c-1)}}n.css(o,l*-100+"%");r.toggleClass("disabled",l==0&&!t.circular);s.toggleClass("disabled",l==c-1&&!t.circular);setTimeout(function(){n.removeClass("noslide")},0)}function d(){u(l+1)}function f(){u(l-1)}s.click(_pd(d));r.click(_pd(f));i.gofwd=d;i.goback=f;var h=n[0].childNodes;for(var p=0;p<h.length;p++){if(h[p].nodeType==3){n[0].removeChild(h[p])}}if(t.circular){n.prepend(a.slice(-t.itemsPerPage).clone().addClass("cloned")).append(a.slice(0,t.itemsPerPage).clone().addClass("cloned"));if(t.useTransitions){n.addClass("noslide");n.bind("transitionend webkitTransitionEnd",function(){if(l>c||l<1){n.addClass("noslide");setTimeout(function(){u(l)},0)}})}u(t.itemsPerPage)}else{u(0)}return i}})(jQuery);function BrowserUtils(){"use strict";var e={firefox:/Mozilla.*(Firefox|Minefield|Namoroka|Shiretoko|GranParadiso|BonEcho|Iceweasel|Fennec|MozillaDeveloperPreview)\/([^\s]*).*$/,seamonkey:/Mozilla.*(SeaMonkey|Iceape)\/([^\s]*).*$/,mobile:/Mozilla.*(Fennec|Mobile)\/([^\s]*)$/,thunderbird:/Mozilla.*(Thunderbird|Shredder|Lanikai)\/([^\s*]*).*$/},t={windows:"Windows",mac:"Mac",linux:"Linux",android:"Android",maemo:"Maemo"};var i={},n=0,a,r,s,o=true;for(s in e){if(e.hasOwnProperty(s)){a=e[s];r=a.exec(navigator.userAgent);i[s]=!!(r&&r.length===3);if(i[s]){n=escape_(r[2]);o=false}}}if(i.firefox&&i.seamonkey){i.firefox=false}var l={},c="";for(s in t){if(t.hasOwnProperty(s)){a=t[s];l[s]=navigator.userAgent.indexOf(a)!=-1;if(l[s]){c=s}}}if(!c){l["other"]=!c;c="other"}return{browser:i,browserVersion:n,badBrowser:o,os:l,platform:c,platformName:gettext(t[c])}}var VersionCompare={compareVersions:function(e,t){var i=e.split("."),n=t.split("."),a,r,s,o;for(o=0;o<i.length||o<n.length;o++){a=o<i.length?i[o]:null;r=o<n.length?n[o]:null;s=this.compareVersionParts(a,r);if(s!==0)return s}return 0},compareVersionParts:function(e,t){var i=this.parseVersionPart(e),n=this.parseVersionPart(t),a=this.cmp(i["numA"],n["numA"]);if(a)return a;a=this.strcmp(i["strB"],n["strB"]);if(a)return a;a=this.cmp(i["numC"],n["numC"]);if(a)return a;return this.strcmp(i["extraD"],n["extraD"])},parseVersionPart:function(e){if(e=="*"){return{numA:Number.MAX_VALUE,strB:"",numC:0,extraD:""}}var t=/^([-\d]*)([^-\d]*)([-\d]*)(.*)$/,i=t.exec(e),n={numA:parseInt(i[1],10),strB:i[2],numC:parseInt(i[3],10),extraD:i[4]};if(n["strB"]=="+"){n["numA"]++;n["strB"]="pre"}return n},cmp:function(e,t){if(isNaN(e))e=0;if(isNaN(t))t=0;if(e<t)return-1;if(e>t)return 1;return 0},strcmp:function(e,t){if(e==t)return 0;if(e==="")return 1;if(t==="")return-1;if(e<t)return-1;else if(e>t)return 1;else return 0}};function bandwagonRefreshEvent(){if(document.createEvent){var e=document.createEvent("Events");e.initEvent("bandwagonRefresh",true,false);document.dispatchEvent(e)}}$(document).ready(function(){$("form.go").change(function(){this.submit()}).find("button").hide()});var AMO={};$(document).ready(function(){$('a[href="#install-beta"]').click(function(e){e.preventDefault();$(".install-beta").slideDown("slow").show()})});var z={};$(document).ready(function(){$(".install").installButton();$(window).trigger("buttons_loaded");if($(".backup-button").length){$(".backup-button").showBackupButton()}if($.fn.tabify){$(".tab-wrapper").tabify()}$("span.emaillink").each(function(){$(this).find(".i").remove();var e=$(this).text().split("").reverse().join("");$(this).prev("a").attr("href","mailto:"+e).addClass("email")});if(!("placeholder"in document.createElement("input"))){$("input[placeholder]").placeholder()}if(z.readonly){$("form[method=post]").before(gettext("This feature is temporarily disabled while we perform website maintenance. Please check back a little later.")).find("input, button, select").attr("disabled",true).addClass("disabled")}});z.inlineSVG=function(){var e=document.createElement("div");e.innerHTML="<svg></svg>";return!!(window.SVGSVGElement&&e.firstChild instanceof window.SVGSVGElement)}();if(!z.inlineSVG){$("body").addClass("noInlineSVG")}z.cssTransitions=function(){var e=document.createElement("div");e.innerHTML='<div style="-webkit-transition:color 1s linear;-moz-transition:color 1s linear;"></div>';var t=document.body.style.webkitTransition!==undefined||document.body.style.MozTransition!==undefined;return t}();z.hasTruncation=function(){var e=document.createElement("div");e.innerHTML='<div style="text-overflow: ellipsis"></div>';var t=e.firstChild.style;return"textOverflow"in t||"OTextOverflow"in t}();function _pd(e){return function(t){t.preventDefault();e.apply(this,arguments)}}jQuery.fn.placeholder=function(e){if(e){this.attr("placeholder",e)}if("placeholder"in document.createElement("input")){return this}if(e&&this.hasClass("placeholder")){this.val("").blur()}return this.focus(function(){var e=$(this),t=e.attr("placeholder");if(e.val()==t){e.val("").removeClass("placeholder")}}).blur(function(){var e=$(this),t=e.attr("placeholder");if(e.val()===""){e.val(t).addClass("placeholder")}}).each(function(){var e=$(this);e.closest("form").submit(function(){if(e.hasClass("placeholder")){e.val("")}})}).blur()};jQuery.fn.hasattr=function(e){return this.attr(e)!==undefined};var escape_=function(e){if(e===undefined){return}return e.replace(/&/g,"&amp;").replace(/>/g,"&gt;").replace(/</g,"&lt;").replace(/'/g,"&#39;").replace(/"/g,"&#34;")};if(!("_"in window))_={};_.haskey=function(e,t){return typeof e[t]!=="undefined"};$.extend(z,BrowserUtils());$(document.body).addClass(z.platform).toggleClass("badbrowser",z.badBrowser);z.app=document.body.getAttribute("data-app");z.appName=document.body.getAttribute("data-appname");z.appMatchesUserAgent=z.browser[z.app];z.anonymous=JSON.parse(document.body.getAttribute("data-anonymous"));z.media_url=document.body.getAttribute("data-media-url");z.readonly=JSON.parse(document.body.getAttribute("data-readonly"));z.hasNightly=false;if(z.browser.firefox){var nightlyVer=document.body.getAttribute("data-nightly-version");if(nightlyVer){z.hasNightly=VersionCompare.compareVersions(z.browserVersion,nightlyVer)>-1}var betaVer=document.body.getAttribute("data-min-beta-version");z.fxBeta=VersionCompare.compareVersions(z.browserVersion,betaVer)>-1;if(z.fxBeta){$(document.body).addClass("fxbeta")}}else{z.fxBeta=false}if(z.badBrowser){$(".get-fx-message").show()}z.apps=$(document.body).hasClass("apps");z.capabilities={JSON:window.JSON&&typeof JSON.parse=="function",debug:(""+document.location).indexOf("dbg")>=0,debug_in_page:(""+document.location).indexOf("dbginpage")>=0,console:window.console&&typeof window.console.log=="function",replaceState:typeof history.replaceState==="function",chromeless:window.locationbar&&!window.locationbar.visible,localStorage:false,sessionStorage:false,webApps:!!(navigator.mozApps&&navigator.mozApps.install),app_runtime:!!(navigator.mozApps&&typeof navigator.mozApps.html5Implementation==="undefined"),fileAPI:!!window.FileReader,performance:!!(window.performance||window.msPerformance||window.webkitPerformance||window.mozPerformance),webactivities:!!(window.setMessageHandler||window.mozSetMessageHandler)};try{if("localStorage"in window&&window["localStorage"]!==null){z.capabilities.localStorage=true}}catch(e){}try{if("sessionStorage"in window&&window["sessionStorage"]!==null){z.capabilities.sessionStorage=true}}catch(e){}var format=function(){var e=/\{([^}]+)\}/g;return function(t,i){if(!t){throw"Format string is empty!"}if(!i)return;if(!(i instanceof Array||i instanceof Object))i=Array.prototype.slice.call(arguments,1);return t.replace(e,function(e,t){return i[t]})}}();function template(e){if(!e){throw"Template string is empty!"}return function(t){return format(e,t)}}jQuery.cookie=function(e,t,i){if(typeof t!="undefined"){i=i||{};if(t===null){t="";i.expires=-1}var n="";if(i.expires&&(typeof i.expires=="number"||i.expires.toUTCString)){var a;if(typeof i.expires=="number"){a=new Date;a.setTime(a.getTime()+i.expires*24*60*60*1e3)}else{a=i.expires}n="; expires="+a.toUTCString()}var r=i.path?"; path="+i.path:"";var s=i.domain?"; domain="+i.domain:"";var o=i.secure?"; secure":"";document.cookie=[e,"=",encodeURIComponent(t),n,r,s,o].join("")}else{var l=null;if(document.cookie&&document.cookie!=""){var c=document.cookie.split(";");for(var u=0;u<c.length;u++){var d=jQuery.trim(c[u]);if(d.substring(0,e.length+1)==e+"="){l=decodeURIComponent(d.substring(e.length+1));break}}}return l}};z.Storage=function(){var e={expires:30,getItem:function(e){return $.cookie(e)},setItem:function(e,t){return $.cookie(e,t,{path:"/",expires:this.expires})},removeItem:function(e){return $.cookie(e,null)}};var t=z.capabilities.localStorage?localStorage:e;return function(e){e=e?e+"-":"";return{get:function(i){return t.getItem(e+i)},set:function(i,n){return t.setItem(e+i,n)},remove:function(i){return t.removeItem(e+i)}}}}();z.SessionStorage=function(){var e={getItem:function(e){return $.cookie(e)},setItem:function(e,t){return $.cookie(e,t,{path:"/"})},removeItem:function(e){return $.cookie(e,null)}};var t=z.capabilities.localStorage?sessionStorage:e;return function(e){e=e?e+"-":"";return{get:function(i){return t.getItem(e+i)},set:function(i,n){return t.setItem(e+i,n)},remove:function(i){return t.removeItem(e+i)}}}}();(function(e){"use strict";e.install=function(e,t){t=$.extend({domContext:document,navigator:navigator,data:undefined,success:undefined,error:undefined,errModalCallback:undefined},t||{});var i=apps,n,a=true;if(t.navigator.mozApps&&t.navigator.mozApps.install){t.navigator.mozApps.install(e,t.data,t.success,function(e){switch(e.code){case"denied":a=false;break;case"permissionDenied":n=gettext("App installation not allowed.");break;case"manifestURLError":n=gettext("App manifest is malformed.");break;case"networkError":n=gettext("App host could not be reached.");break;case"manifestParseError":n=gettext("App manifest is unparsable.");break;case"invalidManifest":n=gettext("App manifest is invalid.");break;default:n=gettext("Install failed. Please try again later.");break}if(a){i._showError(n,e.message,t)}if(t.error){t.error.call(this,e)}})}else{i._showError(gettext("App installation failed."),gettext("This system does not support installing apps."),t)}};e._showError=function(e,t,i){var n=$("<a>"),a,r,s=i.window||window;if(i.mobile){$(".apps-error-msg h2",i.domContext).text(e);$(".apps-error-msg p",i.domContext).text(t);$(".apps-error-msg",i.domContext).show();$(i.domContext).trigger("mobile_error_shown.apps")}else{a=$(".modal:visible",i.domContext);if(a.length){r=$(".inner-modal-error",a);if(!r.length){r=$('<div class="inner-modal-error"><h2></h2><p></p></div>');$(".modal-inside",a).prepend(r)}$("h2",r).text(e);$("p",r).text(t);$(s).trigger("resize")}else{$(".apps-error-msg:first",i.domContext).modal(n,{width:"400px",close:true,callback:i.errModalCallback});n.trigger("click");$(".apps-error-msg h2",i.domContext).text(e);$(".apps-error-msg p",i.domContext).text(t)}$(i.domContext).trigger("error_shown.apps")}}})(typeof exports==="undefined"?this.apps={}:exports);(function(){z.button={};z.button.after={contrib:function(e,t){if(t===0){document.location=$(this).attr("data-developers")}}};var e='<div class="extra"><span class="notavail">{0}</span></div>',t='<div class="extra"><span class="notavail acr-incompat">{0}</span></div>',i='<div class="extra"><span class="notsupported">{0}</span></div>',n=new RegExp("(/downloads/(?:latest|file)/\\d+)");var a={firefox:"4.0",mobile:"11.0",seamonkey:"2.1",thunderbird:"5.0"};var r=function(){var e=$(this),t=e.hasClass("premium"),i=e.attr("data-manifest-url");if(i){e.find(".button").removeClass("disabled").addClass("add").click(function(t){t.preventDefault();purchases.record(e,function(e){purchases.install_app(i,e)})})}if(t){return s.call(e)}};var s=function(){var e=$(this),t=e.attr("data-addon"),i=e.find(".button");if($.inArray(parseInt(t,10),c)>=0){purchases.reset(i);return false}else{i.addPaypal();return true}};var o=function(){var t=this,o=$(this),l=o.find(".button");if(o.hasClass("webapp")){r.call(this);return}l.each(function(){var e=$(this);if(e.hasattr("data-realurl")){e.attr("href",e.attr("data-realurl"))}if(z.app==="mobile"&&!z.appMatchesUserAgent){var t=e.attr("href");e.attr("href",t.replace(n,"$1/type:attachment"))}});var c=o.attr("data-addon"),u=o.attr("data-min"),d=o.attr("data-max"),f=o.attr("data-name"),h=o.attr("data-icon"),p=o.attr("data-after"),m=o.hasattr("data-search"),g=o.hasClass("premium"),v=o.hasClass("accept"),b=o.hasattr("data-manifest-url"),y=o.attr("data-is-compatible")=="true",w=o.attr("data-is-compatible-app")=="true",k=o.hasattr("data-compat-overrides"),x=o.attr("data-versions"),C=v?gettext("Accept and Install"):gettext("Add to {0}"),D=format(C,[z.appName]),P={addon:c,msg:z.appMatchesUserAgent?D:gettext("Download Now")},I=z.appMatchesUserAgent&&u&&d,S=$(document.body),M=o.closest(".install-shell").find(".d2c-reasons-popup ul"),T,A;var j=l.find(".os").length&&!l.hasClass(z.platform);var N=false;if(d){if(z.browser.firefox&&VersionCompare.compareVersions(d,a.firefox)>=0){N=true}else if(z.browser.mobile&&VersionCompare.compareVersions(d,a.mobile)>=0){N=true}else if(z.browser.seamonkey&&VersionCompare.compareVersions(d,a.seamonkey)>=0){N=true}else if(z.browser.thunderbird&&VersionCompare.compareVersions(d,a.thunderbird)>=0){N=true}}if(I){T=VersionCompare.compareVersions(z.browserVersion,u)<0;A=VersionCompare.compareVersions(z.browserVersion,d)>0;if(T){y=false}}if(N&&y){if(!w){M.append($("<li>",{text:gettext("Add-on has not been updated to support default-to-compatible.")}));y=false}if(z.browserVersion!=0&&VersionCompare.compareVersions(z.browserVersion,"10.0")<0){M.append($("<li>",{text:gettext("You need to be using Firefox 10.0 or higher.")}));y=false}if(y&&k){var E=JSON.parse(o.attr("data-compat-overrides"));_.each(E,function(e){var t=e[0],i=e[1];if(VersionCompare.compareVersions(z.browserVersion,t)>=0&&VersionCompare.compareVersions(z.browserVersion,i)<=0){y=false;M.append($("<li>",{text:gettext("Mozilla has marked this version as incompatible with your Firefox version.")}));return}})}}else{y=false}var O=function(e){return function(){P.url=escape_(l.filter(":visible").attr("href"));return format(z.button.messages[e],P)}};var F=function(t,i){o.parent().append(format(i||e,[t]))};var H=function(){if(I||m&&z.appMatchesUserAgent){l.addClass("add").removeClass("download").find("span").text(D)}};var R=function(){if(!I&&!m||!("InstallTrigger"in window))return;o.addClass("clickHijack");o.bind("mousedown focus",function(e){o.addClass("active")}).bind("mouseup blur",function(e){o.removeClass("active")}).click(function(e){var i=$(e.target);if(i.hasClass("installer")){var n=i}else{var n=i.parents(".installer").first();if(_.indexOf(o.find(".installer"),n[0])==-1){return}}e.preventDefault();var a={};o.find(".button[data-hash]").each(function(){a[$(this).attr("href")]=$(this).attr("data-hash")});var r=a[n.attr("href")];var s=_.haskey(z.button.after,p)?z.button.after[p]:_.identity,l=_.bind(s,t),c=m?z.installSearch:z.installAddon;c(f,n[0].href,h,r,l)})};var L=l.map(function(){var e=$(this).find(".os").attr("data-os"),t=z.appMatchesUserAgent?gettext("Install for {0} anyway"):gettext("Download for {0} anyway");return{href:$(this).attr("href"),msg:format(t,[e])}});var W=function(e){var t=$.extend({addPopup:true,addWarning:true,extra:""},e);warn=t.addWarning?F:_.identity;var n=function(e){return function(){var i=$.isFunction(t.extra)?t.extra():t.extra;return $(e.apply(this,arguments)).append(i)}};var a=n(function(){var e=$.map(L,function(e){return format(z.button.messages["platform_link"],e)});return format(z.button.messages["bad_platform"],{platforms:e.join("")})});var r=n(function(){P["new_version"]=d;P["old_version"]=z.browserVersion;return O(A?"not_updated":"newer_version")()});var s=n(function(){return O("not_compatible")()});var o=n(function(){return O("not_compatible_no_reasons")()});var c=n(function(){var e=$(a()),t=$(r());t.prepend(e.find(".msg").clone());if(this.switchInstaller){t.find(".installer").parent().html(e.find("ul").clone())}return t});if(j){warn(gettext("Not available for your platform"));l.addClass("concealed");l.first().css("display","inherit")}if(I&&!y&&(T||A)){if(N){if(!j){var f=gettext("Not available for {0} {1}");if(M.children().length){f+='<span><a class="d2c-reasons-help" href="#">?</a></span>'}warn(format(f,[z.appName,z.browserVersion]))}l.closest("div").attr("data-version-supported",false);l.addClass("concealed");var h=l.closest(".install-shell");if(!y&&M.children().length){h.find(".d2c-reasons-popup").popup(h.find(".d2c-reasons-help"),{callback:function(e){return{pointTo:$(e.click_target)}}})}if(!t.addPopup)return;if(j){l.addPopup(a)}else if(!y){P["versions_url"]=x;P["reasons"]=M.html();l.addPopup(P["reasons"]?s:o)}else{l.addPopup(r)}return true}else{warn(format(gettext("Not available for {0} {1}"),[z.appName,z.browserVersion]));l.closest("div").attr("data-version-supported",false);l.addClass("concealed");if(!t.addPopup)return;if(j&&T){l.addPopup(c)}else if(j&&A){l.addPopup(_.bind(c,{switchInstaller:true}))}else{l.addPopup(r)}return true}}else if(j&&t.addPopup){l.addPopup(a);l.closest("div").attr("data-version-supported",true);return true}else if(!unreviewed&&(I||m)){l.addClass("installer");l.closest("div").attr("data-version-supported",true)}else if(!I){var p=template(gettext("Works with {app} {min} - {max}")+'<span class="more-versions"><a href="{versions_url}">'+gettext("View other versions")+"</a></span>");var g={app:z.appName,min:u,max:d,versions_url:x};F(p(g),i)}return false};var Y=o.hasClass("beta");unreviewed=o.hasClass("unreviewed")&&!Y,persona=o.hasClass("persona"),contrib=o.hasClass("contrib"),m=o.hasattr("data-search"),eula=o.hasClass("eula");if(unreviewed&&!(eula||contrib||Y||b)){l.addPopup(O("unreviewed"))}if(eula||contrib){W({addPopup:false})}else if(g){s.call(o);W({addPopup:false})}else if(persona){l.removeClass("download").addClass("add").find("span").text(D);
if($.hasPersonas()){l.personasButton()}else{l.addClass("concealed");if(z.appMatchesUserAgent){P["old_version"]=z.browserVersion;l.addPopup(O("personas_need_upgrade"))}else{l.addPopup(O("learn_more_personas"))}}}else if(z.appMatchesUserAgent){R();H();var q=m?{addPopup:false,addWarning:false}:{};W(q)}else if(z.app=="firefox"){l.addPopup(O("learn_more")).addClass("concealed");W({addPopup:false})}else if(z.app=="thunderbird"){var B=function(){return $(O("learn_more")()).html()};if(!W({extra:B})){l.addPopup(O("learn_more"),true)}}else{R();H();W()}};var l=$("body").attr("data-purchases")||"",c=$.map(l.split(","),function(e){return parseInt(e,10)});jQuery.fn.installButton=function(){return this.each(o)};jQuery.fn.showBackupButton=function(){this.each(function(){var e,t,i=$(this),n=i.parent().find(".install"),a="data-version-supported";if(i.find(".install").attr(a)=="true"&&n.attr(a)=="false"){n.closest(".install-shell").first().addClass("hidden");i.removeClass("hidden").show();t=$("#addon-summary table");if(t.exists()){e=i.find("div.install");t.find(".addon-compatible td").text(e.attr("data-compatible-apps"));t.find(".addon-updated time").attr("datetime",e.attr("data-lastupdated-isotime")).text(e.attr("data-lastupdated-datetime"));$("h2.addon span.version").text(e.attr("data-version"))}}})};jQuery.fn.addPaypal=function(e,t){function i(e){var t=$(e);$("#id_username",t).focus();if($("#addon_info").exists()){purchases.reset(purchases.find_button(t.closest("body")),t);purchases.trigger(t)}}return this.click(_pd(function(){var e=$(this).closest(".install"),t=e.attr("data-start-purchase");if(t){modalFromURL(t,{callback:function(){var e=$(this);i(this);$(".browserid-login",this).bind("login-complete",function(){$(this).addClass("loading-submit");$(".ajax-submit",e).load(t,function(){i(this)})})},data:{realurl:e.find("a.premium").attr("data-realurl")}})}}))};jQuery.fn.addPopup=function(e,t){return this.each(function(){var i=$(this),n=this,a=$(document.body);if(this.hasPopup){i.bind("newPopup",function(e,t){i.unbind("newPopup");$(t).find(".installer").click(function(e){i.unbind("click");n.hasPopup=false;var t=n.popupQueue.pop();if(!t[1]){e.preventDefault();e.stopPropagation()}jQuery.fn.addPopup.apply(i,t);i.click()})});n.popupQueue=n.popupQueue||[];n.popupQueue.push([e,t])}else{this.hasPopup=true;i.click(function(n){var r=$($.isFunction(e)?e():e),s=r.get(0);if(!i.filter(":visible").length){return}if(!t){n.preventDefault()}if(i.offset().left>$(window).width()/2){r.addClass("left")}i.trigger("newPopup",[r]);i.after(r);a.trigger("newStatic");var o=function(e){if(e.type=="click"&&s==e.target||_.indexOf($(e.target).parents(),s)!=-1){return}r.remove();a.unbind("click newPopup",o);a.trigger("closeStatic")};setTimeout(function(){a.bind("click newPopup",o)},0)})}})};z.installAddon=function(e,t,i,n,a){var r={};r[e]={URL:t,IconURL:i,toString:function(){return t}};if(n){r[e]["Hash"]=n}InstallTrigger.install(r,a)};z.installSearch=function(e,t,i,n,a){if(window.external&&window.external.AddSearchProvider){window.external.AddSearchProvider(t);a()}else{alert(gettext("Sorry, you need a Mozilla-based browser (such as Firefox) to install a search plugin."))}}})();(function(e){e.fn.pjax=function(e,i){i=n(e,i);return this.live("click",function(e){return t(e,i)})};function t(t,i,a){a=n(i,a);var r=t.currentTarget;if(t.which>1||t.metaKey)return;if(location.protocol!==r.protocol||location.host!==r.host)return;if(r.hash&&r.href.replace(r.hash,"")===location.href.replace(location.hash,""))return;var s={url:r.href,container:e(r).attr("data-pjax"),clickedElement:e(r),fragment:null};e.pjax(e.extend({},s,a));t.preventDefault();return false}var i=e.pjax=function(t){var n=a(t.container),r=t.success||e.noop;delete t.success;t=e.extend(true,{},i.defaults,t);if(e.isFunction(t.url)){t.url=t.url()}t.context=n;t.success=function(a){if(t.fragment){var s=e(a).find(t.fragment);if(s.length)a=s.children();else return window.location=t.url}else{if(!e.trim(a)||/<html/i.test(a))return window.location=t.url}this.html(a);var o=document.title,l=e.trim(this.find("title").remove().text());if(!l&&t.fragment){l=s.attr("title")||s.data("title")}if(l)document.title=l;var c={pjax:n.selector,fragment:t.fragment,timeout:t.timeout};var u=e.param(t.data);if(u!="_pjax=true")c.url=t.url+(/\?/.test(t.url)?"&":"?")+u;if(t.replace){i.active=true;window.history.replaceState(c,document.title,t.url)}else if(t.push){if(!i.active){window.history.replaceState(e.extend({},c,{url:null}),o);i.active=true}window.history.pushState(c,document.title,t.url)}if((t.replace||t.push)&&window._gaq)_gaq.push(["_trackPageview"]);var d=window.location.hash.toString();if(d!==""){window.location.href=d}r.apply(this,arguments)};var s=i.xhr;if(s&&s.readyState<4){s.onreadystatechange=e.noop;s.abort()}i.options=t;i.xhr=e.ajax(t);e(document).trigger("pjax",[i.xhr,t]);return i.xhr};function n(t,i){if(t&&i)i.container=t;else if(e.isPlainObject(t))i=t;else i={container:t};if(i.container)i.container=a(i.container);return i}function a(t){t=e(t);if(!t.length){throw"no pjax container for "+t.selector}else if(t.selector!==""&&t.context===document){return t}else if(t.attr("id")){return e("#"+t.attr("id"))}else{throw"cant get selector for pjax container!"}}var r=null;i.defaults={timeout:650,push:true,replace:false,data:{_pjax:true},type:"GET",dataType:"html",beforeSend:function(t,n){var a=this;if(n.async&&n.timeout>0){r=setTimeout(function(){var n=e.Event("pjax:timeout");a.trigger(n,[t,i.options]);if(n.result!==false)t.abort("timeout")},n.timeout);n.timeout=0}this.trigger("pjax:start",[t,i.options]);this.trigger("start.pjax",[t,i.options]);t.setRequestHeader("X-PJAX","true")},error:function(e,t,n){if(t!=="abort")window.location=i.options.url},complete:function(e){if(r)clearTimeout(r);this.trigger("pjax:end",[e,i.options]);this.trigger("end.pjax",[e,i.options])}};i.click=t;var s="state"in window.history,o=location.href;e(window).bind("popstate",function(t){var i=!s&&location.href==o;s=true;if(i)return;var n=t.state;if(n&&n.pjax){var a=n.pjax;if(e(a+"").length)e.pjax({url:n.url||location.href,fragment:n.fragment,container:a,push:false,timeout:n.timeout});else window.location=location.href}});if(e.inArray("state",e.event.props)<0)e.event.props.push("state");e.support.pjax=window.history&&window.history.pushState&&window.history.replaceState&&!navigator.userAgent.match(/((iPod|iPhone|iPad).+\bOS\s+[1-4]|WebApps\/.+CFNetwork)/);if(!e.support.pjax){e.pjax=function(t){window.location=e.isFunction(t.url)?t.url():t.url};e.pjax.click=e.noop;e.fn.pjax=function(){return this}}})(jQuery);(function(){var e=$("#footer"),t=$("#page"),i=$(window);function n(){e.toggleClass("sticky",i.height()-e.outerHeight()>t.outerHeight())}n();i.resize(_.debounce(n,200))})();$(document).ready(function(){$(window).trigger("resize")});z.keys={SHIFT:16,CONTROL:17,ALT:18,PAUSE:19,CAPS_LOCK:20,ESCAPE:27,ENTER:13,PAGE_UP:33,PAGE_DOWN:34,LEFT:37,UP:38,RIGHT:39,DOWN:40,HOME:36,END:35,COMMAND:91,WINDOWS_RIGHT:92,COMMAND_RIGHT:93,WINDOWS_LEFT_OPERA:219,WINDOWS_RIGHT_OPERA:220,APPLE:24};function browserIDRedirect(e,t){if(!t)t={};return function(t,i,n){if(e){if(typeof e=="object"){e["on"].removeClass("loading-submit").trigger(e["fire"])}else{window.location=e}}}}function gotVerifiedEmail(e,t,i){function n(e){$(".loading-submit").removeClass("loading-submit");$("section.primary",i).eq(0).prepend(format('<div class="notification-box error">'+"<ul><h2>{0}</h2></ul></div>",[e]))}if(e){var a=$.ajax({url:$(".browserid-login",i).attr("data-url"),type:"POST",data:{assertion:e},success:browserIDRedirect(t),error:function(e,t,i){if(e.status==400){n(gettext("Admins and editors must "+"provide a password to log in."))}else{var a=e.responseText;if(!a){a=gettext("BrowserID login failed. Maybe you don't have an account under that email address?")+" "+t+" "+i}n(a)}}});return a}else{$(".loading-submit").removeClass("loading-submit");return null}}function initBrowserID(e,t){if($("body").data("pers-handle")){return}else{$("body").data("pers-handle",true)}var i=e.location.href.split("?to=")[1],n="/";if(i){n=decodeURIComponent(i);if(n.indexOf("://")>-1)n="/"}else if(e.location.href.indexOf("://")==-1&&e.location.href.indexOf("users/login")==-1){n=e.location.href}$(t||e).delegate(".browserid-login","click",function(e){var i=$(this),a=i.attr("data-event"),r=a?{fire:a,on:i}:n;e.preventDefault();i.addClass("loading-submit");$(".primary .notification-box",t).remove();navigator.id.watch({onlogin:function(e){gotVerifiedEmail(e,r)},onlogout:function(){}})})}$(document).ready(function(){initBrowserID(window)});(function(e,t){e.ui=e.ui||{};if(e.ui.version){return}e.extend(e.ui,{version:"1.8.16",keyCode:{ALT:18,BACKSPACE:8,CAPS_LOCK:20,COMMA:188,COMMAND:91,COMMAND_LEFT:91,COMMAND_RIGHT:93,CONTROL:17,DELETE:46,DOWN:40,END:35,ENTER:13,ESCAPE:27,HOME:36,INSERT:45,LEFT:37,MENU:93,NUMPAD_ADD:107,NUMPAD_DECIMAL:110,NUMPAD_DIVIDE:111,NUMPAD_ENTER:108,NUMPAD_MULTIPLY:106,NUMPAD_SUBTRACT:109,PAGE_DOWN:34,PAGE_UP:33,PERIOD:190,RIGHT:39,SHIFT:16,SPACE:32,TAB:9,UP:38,WINDOWS:91}});e.fn.extend({propAttr:e.fn.prop||e.fn.attr,_focus:e.fn.focus,focus:function(t,i){return typeof t==="number"?this.each(function(){var n=this;setTimeout(function(){e(n).focus();if(i){i.call(n)}},t)}):this._focus.apply(this,arguments)},scrollParent:function(){var t;if(e.browser.msie&&/(static|relative)/.test(this.css("position"))||/absolute/.test(this.css("position"))){t=this.parents().filter(function(){return/(relative|absolute|fixed)/.test(e.curCSS(this,"position",1))&&/(auto|scroll)/.test(e.curCSS(this,"overflow",1)+e.curCSS(this,"overflow-y",1)+e.curCSS(this,"overflow-x",1))}).eq(0)}else{t=this.parents().filter(function(){return/(auto|scroll)/.test(e.curCSS(this,"overflow",1)+e.curCSS(this,"overflow-y",1)+e.curCSS(this,"overflow-x",1))}).eq(0)}return/fixed/.test(this.css("position"))||!t.length?e(document):t},zIndex:function(i){if(i!==t){return this.css("zIndex",i)}if(this.length){var n=e(this[0]),a,r;while(n.length&&n[0]!==document){a=n.css("position");if(a==="absolute"||a==="relative"||a==="fixed"){r=parseInt(n.css("zIndex"),10);if(!isNaN(r)&&r!==0){return r}}n=n.parent()}}return 0},disableSelection:function(){return this.bind((e.support.selectstart?"selectstart":"mousedown")+".ui-disableSelection",function(e){e.preventDefault()})},enableSelection:function(){return this.unbind(".ui-disableSelection")}});e.each(["Width","Height"],function(i,n){var a=n==="Width"?["Left","Right"]:["Top","Bottom"],r=n.toLowerCase(),s={innerWidth:e.fn.innerWidth,innerHeight:e.fn.innerHeight,outerWidth:e.fn.outerWidth,outerHeight:e.fn.outerHeight};function o(t,i,n,r){e.each(a,function(){i-=parseFloat(e.curCSS(t,"padding"+this,true))||0;if(n){i-=parseFloat(e.curCSS(t,"border"+this+"Width",true))||0}if(r){i-=parseFloat(e.curCSS(t,"margin"+this,true))||0}});return i}e.fn["inner"+n]=function(i){if(i===t){return s["inner"+n].call(this)}return this.each(function(){e(this).css(r,o(this,i)+"px")})};e.fn["outer"+n]=function(t,i){if(typeof t!=="number"){return s["outer"+n].call(this,t)}return this.each(function(){e(this).css(r,o(this,t,true,i)+"px")})}});function i(t,i){var a=t.nodeName.toLowerCase();if("area"===a){var r=t.parentNode,s=r.name,o;if(!t.href||!s||r.nodeName.toLowerCase()!=="map"){return false}o=e("img[usemap=#"+s+"]")[0];return!!o&&n(o)}return(/input|select|textarea|button|object/.test(a)?!t.disabled:"a"==a?t.href||i:i)&&n(t)}function n(t){return!e(t).parents().andSelf().filter(function(){return e.curCSS(this,"visibility")==="hidden"||e.expr.filters.hidden(this)}).length}e.extend(e.expr[":"],{data:function(t,i,n){return!!e.data(t,n[3])},focusable:function(t){return i(t,!isNaN(e.attr(t,"tabindex")))},tabbable:function(t){var n=e.attr(t,"tabindex"),a=isNaN(n);return(a||n>=0)&&i(t,!a)}});e(function(){var t=document.body,i=t.appendChild(i=document.createElement("div"));e.extend(i.style,{minHeight:"100px",height:"auto",padding:0,borderWidth:0});e.support.minHeight=i.offsetHeight===100;e.support.selectstart="onselectstart"in i;t.removeChild(i).style.display="none"});e.extend(e.ui,{plugin:{add:function(t,i,n){var a=e.ui[t].prototype;for(var r in n){a.plugins[r]=a.plugins[r]||[];a.plugins[r].push([i,n[r]])}},call:function(e,t,i){var n=e.plugins[t];if(!n||!e.element[0].parentNode){return}for(var a=0;a<n.length;a++){if(e.options[n[a][0]]){n[a][1].apply(e.element,i)}}}},contains:function(e,t){return document.compareDocumentPosition?e.compareDocumentPosition(t)&16:e!==t&&e.contains(t)},hasScroll:function(t,i){if(e(t).css("overflow")==="hidden"){return false}var n=i&&i==="left"?"scrollLeft":"scrollTop",a=false;if(t[n]>0){return true}t[n]=1;a=t[n]>0;t[n]=0;return a},isOverAxis:function(e,t,i){return e>t&&e<t+i},isOver:function(t,i,n,a,r,s){return e.ui.isOverAxis(t,n,r)&&e.ui.isOverAxis(i,a,s)}})})(jQuery);(function(e,t){e.ui=e.ui||{};var i=/left|center|right/,n=/top|center|bottom/,a="center",r=e.fn.position,s=e.fn.offset;e.fn.position=function(t){if(!t||!t.of){return r.apply(this,arguments)}t=e.extend({},t);var s=e(t.of),o=s[0],l=(t.collision||"flip").split(" "),c=t.offset?t.offset.split(" "):[0,0],u,d,f;if(o.nodeType===9){u=s.width();d=s.height();f={top:0,left:0}}else if(o.setTimeout){u=s.width();d=s.height();f={top:s.scrollTop(),left:s.scrollLeft()}}else if(o.preventDefault){t.at="left top";u=d=0;f={top:t.of.pageY,left:t.of.pageX}}else{u=s.outerWidth();d=s.outerHeight();f=s.offset()}e.each(["my","at"],function(){var e=(t[this]||"").split(" ");if(e.length===1){e=i.test(e[0])?e.concat([a]):n.test(e[0])?[a].concat(e):[a,a]}e[0]=i.test(e[0])?e[0]:a;e[1]=n.test(e[1])?e[1]:a;t[this]=e});if(l.length===1){l[1]=l[0]}c[0]=parseInt(c[0],10)||0;if(c.length===1){c[1]=c[0]}c[1]=parseInt(c[1],10)||0;if(t.at[0]==="right"){f.left+=u}else if(t.at[0]===a){f.left+=u/2}if(t.at[1]==="bottom"){f.top+=d}else if(t.at[1]===a){f.top+=d/2}f.left+=c[0];f.top+=c[1];return this.each(function(){var i=e(this),n=i.outerWidth(),r=i.outerHeight(),s=parseInt(e.curCSS(this,"marginLeft",true))||0,o=parseInt(e.curCSS(this,"marginTop",true))||0,h=n+s+(parseInt(e.curCSS(this,"marginRight",true))||0),p=r+o+(parseInt(e.curCSS(this,"marginBottom",true))||0),m=e.extend({},f),g;if(t.my[0]==="right"){m.left-=n}else if(t.my[0]===a){m.left-=n/2}if(t.my[1]==="bottom"){m.top-=r}else if(t.my[1]===a){m.top-=r/2}m.left=Math.round(m.left);m.top=Math.round(m.top);g={left:m.left-s,top:m.top-o};e.each(["left","top"],function(i,a){if(e.ui.position[l[i]]){e.ui.position[l[i]][a](m,{targetWidth:u,targetHeight:d,elemWidth:n,elemHeight:r,collisionPosition:g,collisionWidth:h,collisionHeight:p,offset:c,my:t.my,at:t.at})}});if(e.fn.bgiframe){i.bgiframe()}i.offset(e.extend(m,{using:t.using}))})};e.ui.position={fit:{left:function(t,i){var n=e(window),a=i.collisionPosition.left+i.collisionWidth-n.width()-n.scrollLeft();t.left=a>0?t.left-a:Math.max(t.left-i.collisionPosition.left,t.left)},top:function(t,i){var n=e(window),a=i.collisionPosition.top+i.collisionHeight-n.height()-n.scrollTop();t.top=a>0?t.top-a:Math.max(t.top-i.collisionPosition.top,t.top)}},flip:{left:function(t,i){if(i.at[0]===a){return}var n=e(window),r=i.collisionPosition.left+i.collisionWidth-n.width()-n.scrollLeft(),s=i.my[0]==="left"?-i.elemWidth:i.my[0]==="right"?i.elemWidth:0,o=i.at[0]==="left"?i.targetWidth:-i.targetWidth,l=-2*i.offset[0];t.left+=i.collisionPosition.left<0?s+o+l:r>0?s+o+l:0},top:function(t,i){if(i.at[1]===a){return}var n=e(window),r=i.collisionPosition.top+i.collisionHeight-n.height()-n.scrollTop(),s=i.my[1]==="top"?-i.elemHeight:i.my[1]==="bottom"?i.elemHeight:0,o=i.at[1]==="top"?i.targetHeight:-i.targetHeight,l=-2*i.offset[1];t.top+=i.collisionPosition.top<0?s+o+l:r>0?s+o+l:0}}};if(!e.offset.setOffset){e.offset.setOffset=function(t,i){if(/static/.test(e.curCSS(t,"position"))){t.style.position="relative"}var n=e(t),a=n.offset(),r=parseInt(e.curCSS(t,"top",true),10)||0,s=parseInt(e.curCSS(t,"left",true),10)||0,o={top:i.top-a.top+r,left:i.left-a.left+s};if("using"in i){i.using.call(t,o)}else{n.css(o)}};e.fn.offset=function(t){var i=this[0];if(!i||!i.ownerDocument){return null}if(t){return this.each(function(){e.offset.setOffset(this,t)})}return s.call(this)}}})(jQuery);(function(e,t){if(e.cleanData){var i=e.cleanData;e.cleanData=function(t){for(var n=0,a;(a=t[n])!=null;n++){try{e(a).triggerHandler("remove")}catch(r){}}i(t)}}else{var n=e.fn.remove;e.fn.remove=function(t,i){return this.each(function(){if(!i){if(!t||e.filter(t,[this]).length){e("*",this).add([this]).each(function(){try{e(this).triggerHandler("remove")}catch(t){}})}}return n.call(e(this),t,i)})}}e.widget=function(t,i,n){var a=t.split(".")[0],r;t=t.split(".")[1];r=a+"-"+t;if(!n){n=i;i=e.Widget}e.expr[":"][r]=function(i){return!!e.data(i,t)};e[a]=e[a]||{};e[a][t]=function(e,t){if(arguments.length){this._createWidget(e,t)}};var s=new i;s.options=e.extend(true,{},s.options);e[a][t].prototype=e.extend(true,s,{namespace:a,widgetName:t,widgetEventPrefix:e[a][t].prototype.widgetEventPrefix||t,widgetBaseClass:r},n);e.widget.bridge(t,e[a][t])};e.widget.bridge=function(i,n){e.fn[i]=function(a){var r=typeof a==="string",s=Array.prototype.slice.call(arguments,1),o=this;a=!r&&s.length?e.extend.apply(null,[true,a].concat(s)):a;if(r&&a.charAt(0)==="_"){return o}if(r){this.each(function(){var n=e.data(this,i),r=n&&e.isFunction(n[a])?n[a].apply(n,s):n;if(r!==n&&r!==t){o=r;return false}})}else{this.each(function(){var t=e.data(this,i);if(t){t.option(a||{})._init()}else{e.data(this,i,new n(a,this))}})}return o}};e.Widget=function(e,t){if(arguments.length){this._createWidget(e,t)}};e.Widget.prototype={widgetName:"widget",widgetEventPrefix:"",options:{disabled:false},_createWidget:function(t,i){e.data(i,this.widgetName,this);this.element=e(i);this.options=e.extend(true,{},this.options,this._getCreateOptions(),t);var n=this;this.element.bind("remove."+this.widgetName,function(){n.destroy()});this._create();this._trigger("create");this._init()},_getCreateOptions:function(){return e.metadata&&e.metadata.get(this.element[0])[this.widgetName]},_create:function(){},_init:function(){},destroy:function(){this.element.unbind("."+this.widgetName).removeData(this.widgetName);this.widget().unbind("."+this.widgetName).removeAttr("aria-disabled").removeClass(this.widgetBaseClass+"-disabled "+"ui-state-disabled")},widget:function(){return this.element},option:function(i,n){var a=i;if(arguments.length===0){return e.extend({},this.options)}if(typeof i==="string"){if(n===t){return this.options[i]}a={};a[i]=n}this._setOptions(a);return this},_setOptions:function(t){var i=this;e.each(t,function(e,t){i._setOption(e,t)});return this},_setOption:function(e,t){this.options[e]=t;if(e==="disabled"){this.widget()[t?"addClass":"removeClass"](this.widgetBaseClass+"-disabled"+" "+"ui-state-disabled").attr("aria-disabled",t)}return this},enable:function(){return this._setOption("disabled",false)},disable:function(){return this._setOption("disabled",true)},_trigger:function(t,i,n){var a=this.options[t];i=e.Event(i);i.type=(t===this.widgetEventPrefix?t:this.widgetEventPrefix+t).toLowerCase();n=n||{};if(i.originalEvent){for(var r=e.event.props.length,s;r;){s=e.event.props[--r];i[s]=i.originalEvent[s]}}this.element.trigger(i,n);return!(e.isFunction(a)&&a.call(this.element[0],i,n)===false||i.isDefaultPrevented())}}})(jQuery);(function(e,t){var i=false;e(document).mouseup(function(e){i=false});e.widget("ui.mouse",{options:{cancel:":input,option",distance:1,delay:0},_mouseInit:function(){var t=this;this.element.bind("mousedown."+this.widgetName,function(e){return t._mouseDown(e)}).bind("click."+this.widgetName,function(i){if(true===e.data(i.target,t.widgetName+".preventClickEvent")){e.removeData(i.target,t.widgetName+".preventClickEvent");i.stopImmediatePropagation();return false}});this.started=false},_mouseDestroy:function(){this.element.unbind("."+this.widgetName)},_mouseDown:function(t){if(i){return}this._mouseStarted&&this._mouseUp(t);this._mouseDownEvent=t;var n=this,a=t.which==1,r=typeof this.options.cancel=="string"&&t.target.nodeName?e(t.target).closest(this.options.cancel).length:false;if(!a||r||!this._mouseCapture(t)){return true}this.mouseDelayMet=!this.options.delay;if(!this.mouseDelayMet){this._mouseDelayTimer=setTimeout(function(){n.mouseDelayMet=true},this.options.delay)}if(this._mouseDistanceMet(t)&&this._mouseDelayMet(t)){this._mouseStarted=this._mouseStart(t)!==false;if(!this._mouseStarted){t.preventDefault();return true}}if(true===e.data(t.target,this.widgetName+".preventClickEvent")){e.removeData(t.target,this.widgetName+".preventClickEvent")}this._mouseMoveDelegate=function(e){return n._mouseMove(e)};this._mouseUpDelegate=function(e){return n._mouseUp(e)};e(document).bind("mousemove."+this.widgetName,this._mouseMoveDelegate).bind("mouseup."+this.widgetName,this._mouseUpDelegate);t.preventDefault();i=true;return true},_mouseMove:function(t){if(e.browser.msie&&!(document.documentMode>=9)&&!t.button){return this._mouseUp(t)}if(this._mouseStarted){this._mouseDrag(t);return t.preventDefault()}if(this._mouseDistanceMet(t)&&this._mouseDelayMet(t)){this._mouseStarted=this._mouseStart(this._mouseDownEvent,t)!==false;this._mouseStarted?this._mouseDrag(t):this._mouseUp(t)}return!this._mouseStarted},_mouseUp:function(t){e(document).unbind("mousemove."+this.widgetName,this._mouseMoveDelegate).unbind("mouseup."+this.widgetName,this._mouseUpDelegate);if(this._mouseStarted){this._mouseStarted=false;if(t.target==this._mouseDownEvent.target){e.data(t.target,this.widgetName+".preventClickEvent",true)}this._mouseStop(t)}return false},_mouseDistanceMet:function(e){return Math.max(Math.abs(this._mouseDownEvent.pageX-e.pageX),Math.abs(this._mouseDownEvent.pageY-e.pageY))>=this.options.distance},_mouseDelayMet:function(e){return this.mouseDelayMet},_mouseStart:function(e){},_mouseDrag:function(e){},_mouseStop:function(e){},_mouseCapture:function(e){return true}})})(jQuery);(function(e,t){var i=0;e.widget("ui.autocomplete",{options:{appendTo:"body",autoFocus:false,delay:300,minLength:1,position:{my:"left top",at:"left bottom",collision:"none"},source:null},pending:0,_create:function(){var t=this,i=this.element[0].ownerDocument,n;this.element.addClass("ui-autocomplete-input").attr("autocomplete","off").attr({role:"textbox","aria-autocomplete":"list","aria-haspopup":"true"}).bind("keydown.autocomplete",function(i){if(t.options.disabled||t.element.propAttr("readOnly")){return}n=false;var a=e.ui.keyCode;switch(i.keyCode){case a.PAGE_UP:t._move("previousPage",i);break;case a.PAGE_DOWN:t._move("nextPage",i);break;case a.UP:t._move("previous",i);i.preventDefault();break;case a.DOWN:t._move("next",i);i.preventDefault();break;case a.ENTER:case a.NUMPAD_ENTER:if(t.menu.active){n=true;i.preventDefault()}case a.TAB:if(!t.menu.active){return}t.menu.select(i);break;case a.ESCAPE:t.element.val(t.term);t.close(i);break;default:clearTimeout(t.searching);t.searching=setTimeout(function(){if(t.term!=t.element.val()){t.selectedItem=null;t.search(null,i)}},t.options.delay);break}}).bind("keypress.autocomplete",function(e){if(n){n=false;e.preventDefault()}}).bind("focus.autocomplete",function(){if(t.options.disabled){return}t.selectedItem=null;t.previous=t.element.val()}).bind("blur.autocomplete",function(e){if(t.options.disabled){return}clearTimeout(t.searching);t.closing=setTimeout(function(){t.close(e);t._change(e)},150)});this._initSource();this.response=function(){return t._response.apply(t,arguments)};this.menu=e("<ul></ul>").addClass("ui-autocomplete").appendTo(e(this.options.appendTo||"body",i)[0]).mousedown(function(i){var n=t.menu.element[0];if(!e(i.target).closest(".ui-menu-item").length){setTimeout(function(){e(document).one("mousedown",function(i){if(i.target!==t.element[0]&&i.target!==n&&!e.ui.contains(n,i.target)){t.close()}})},1)}setTimeout(function(){clearTimeout(t.closing)},13)}).menu({focus:function(e,i){var n=i.item.data("item.autocomplete");if(false!==t._trigger("focus",e,{item:n})){if(/^key/.test(e.originalEvent.type)){t.element.val(n.value)}}},selected:function(e,n){var a=n.item.data("item.autocomplete"),r=t.previous;if(t.element[0]!==i.activeElement){t.element.focus();t.previous=r;setTimeout(function(){t.previous=r;t.selectedItem=a},1)}if(false!==t._trigger("select",e,{item:a})){t.element.val(a.value)}t.term=t.element.val();t.close(e);t.selectedItem=a},blur:function(e,i){if(t.menu.element.is(":visible")&&t.element.val()!==t.term){t.element.val(t.term)}}}).zIndex(this.element.zIndex()+1).css({top:0,left:0}).hide().data("menu");if(e.fn.bgiframe){this.menu.element.bgiframe()}},destroy:function(){this.element.removeClass("ui-autocomplete-input").removeAttr("autocomplete").removeAttr("role").removeAttr("aria-autocomplete").removeAttr("aria-haspopup");this.menu.element.remove();e.Widget.prototype.destroy.call(this)},_setOption:function(t,i){e.Widget.prototype._setOption.apply(this,arguments);if(t==="source"){this._initSource()}if(t==="appendTo"){this.menu.element.appendTo(e(i||"body",this.element[0].ownerDocument)[0])}if(t==="disabled"&&i&&this.xhr){this.xhr.abort()}},_initSource:function(){var t=this,n,a;if(e.isArray(this.options.source)){n=this.options.source;this.source=function(t,i){i(e.ui.autocomplete.filter(n,t.term))}}else if(typeof this.options.source==="string"){a=this.options.source;this.source=function(n,r){if(t.xhr){t.xhr.abort()}t.xhr=e.ajax({url:a,data:n,dataType:"json",autocompleteRequest:++i,success:function(e,t){if(this.autocompleteRequest===i){r(e)}},error:function(){if(this.autocompleteRequest===i){r([])}}})}}else{this.source=this.options.source}},search:function(e,t){e=e!=null?e:this.element.val();this.term=this.element.val();if(e.length<this.options.minLength){return this.close(t)}clearTimeout(this.closing);if(this._trigger("search",t)===false){return}return this._search(e)},_search:function(e){this.pending++;this.element.addClass("ui-autocomplete-loading");this.source({term:e},this.response)},_response:function(e){if(!this.options.disabled&&e&&e.length){e=this._normalize(e);this._suggest(e);this._trigger("open")}else{this.close()}this.pending--;if(!this.pending){this.element.removeClass("ui-autocomplete-loading")}},close:function(e){clearTimeout(this.closing);if(this.menu.element.is(":visible")){this.menu.element.hide();this.menu.deactivate();this._trigger("close",e)}},_change:function(e){if(this.previous!==this.element.val()){this._trigger("change",e,{item:this.selectedItem})}},_normalize:function(t){if(t.length&&t[0].label&&t[0].value){return t}return e.map(t,function(t){if(typeof t==="string"){return{label:t,value:t}}return e.extend({label:t.label||t.value,value:t.value||t.label},t)})},_suggest:function(t){var i=this.menu.element.empty().zIndex(this.element.zIndex()+1);this._renderMenu(i,t);this.menu.deactivate();this.menu.refresh();i.show();this._resizeMenu();i.position(e.extend({of:this.element},this.options.position));if(this.options.autoFocus){this.menu.next(new e.Event("mouseover"))}},_resizeMenu:function(){var e=this.menu.element;e.outerWidth(Math.max(e.width("").outerWidth(),this.element.outerWidth()))},_renderMenu:function(t,i){var n=this;e.each(i,function(e,i){n._renderItem(t,i)})},_renderItem:function(t,i){return e("<li></li>").data("item.autocomplete",i).append(e("<a></a>").text(i.label)).appendTo(t)},_move:function(e,t){if(!this.menu.element.is(":visible")){this.search(null,t);return}if(this.menu.first()&&/^previous/.test(e)||this.menu.last()&&/^next/.test(e)){this.element.val(this.term);this.menu.deactivate();return}this.menu[e](t)},widget:function(){return this.menu.element}});e.extend(e.ui.autocomplete,{escapeRegex:function(e){return e.replace(/[-[\]{}()*+?.,\\^$|#\s]/g,"\\$&")},filter:function(t,i){var n=new RegExp(e.ui.autocomplete.escapeRegex(i),"i");return e.grep(t,function(e){return n.test(e.label||e.value||e)})}})})(jQuery);(function(e){e.widget("ui.menu",{_create:function(){var t=this;this.element.addClass("ui-menu ui-widget ui-widget-content ui-corner-all").attr({role:"listbox","aria-activedescendant":"ui-active-menuitem"}).click(function(i){if(!e(i.target).closest(".ui-menu-item a").length){return}i.preventDefault();t.select(i)});this.refresh()},refresh:function(){var t=this;var i=this.element.children("li:not(.ui-menu-item):has(a)").addClass("ui-menu-item").attr("role","menuitem");i.children("a").addClass("ui-corner-all").attr("tabindex",-1).mouseenter(function(i){t.activate(i,e(this).parent())}).mouseleave(function(){t.deactivate()})},activate:function(e,t){this.deactivate();if(this.hasScroll()){var i=t.offset().top-this.element.offset().top,n=this.element.scrollTop(),a=this.element.height();if(i<0){this.element.scrollTop(n+i)}else if(i>=a){this.element.scrollTop(n+i-a+t.height())}}this.active=t.eq(0).children("a").addClass("ui-state-hover").attr("id","ui-active-menuitem").end();this._trigger("focus",e,{item:t})},deactivate:function(){if(!this.active){return}this.active.children("a").removeClass("ui-state-hover").removeAttr("id");this._trigger("blur");this.active=null},next:function(e){this.move("next",".ui-menu-item:first",e)},previous:function(e){this.move("prev",".ui-menu-item:last",e)},first:function(){return this.active&&!this.active.prevAll(".ui-menu-item").length},last:function(){return this.active&&!this.active.nextAll(".ui-menu-item").length},move:function(e,t,i){if(!this.active){this.activate(i,this.element.children(t));return}var n=this.active[e+"All"](".ui-menu-item").eq(0);if(n.length){this.activate(i,n)}else{this.activate(i,this.element.children(t))}},nextPage:function(t){if(this.hasScroll()){if(!this.active||this.last()){this.activate(t,this.element.children(".ui-menu-item:first"));return}var i=this.active.offset().top,n=this.element.height(),a=this.element.children(".ui-menu-item").filter(function(){var t=e(this).offset().top-i-n+e(this).height();return t<10&&t>-10});if(!a.length){a=this.element.children(".ui-menu-item:last")}this.activate(t,a)}else{this.activate(t,this.element.children(".ui-menu-item").filter(!this.active||this.last()?":first":":last"))}},previousPage:function(t){if(this.hasScroll()){if(!this.active||this.first()){this.activate(t,this.element.children(".ui-menu-item:last"));return}var i=this.active.offset().top,n=this.element.height();result=this.element.children(".ui-menu-item").filter(function(){var t=e(this).offset().top-i+n-e(this).height();return t<10&&t>-10});if(!result.length){result=this.element.children(".ui-menu-item:first")}this.activate(t,result)}else{this.activate(t,this.element.children(".ui-menu-item").filter(!this.active||this.first()?":last":":first"))}},hasScroll:function(){return this.element.height()<this.element[e.fn.prop?"prop":"attr"]("scrollHeight")},select:function(e){this._trigger("selected",e,{item:this.active})}})})(jQuery);(function($,undefined){$.extend($.ui,{datepicker:{version:"1.8.16"}});var PROP_NAME="datepicker";var dpuuid=(new Date).getTime();var instActive;function Datepicker(){this.debug=false;this._curInst=null;this._keyEvent=false;this._disabledInputs=[];this._datepickerShowing=false;this._inDialog=false;this._mainDivId="ui-datepicker-div";this._inlineClass="ui-datepicker-inline";this._appendClass="ui-datepicker-append";this._triggerClass="ui-datepicker-trigger";this._dialogClass="ui-datepicker-dialog";this._disableClass="ui-datepicker-disabled";this._unselectableClass="ui-datepicker-unselectable";this._currentClass="ui-datepicker-current-day";this._dayOverClass="ui-datepicker-days-cell-over";this.regional=[];this.regional[""]={closeText:"Done",prevText:"Prev",nextText:"Next",currentText:"Today",monthNames:["January","February","March","April","May","June","July","August","September","October","November","December"],monthNamesShort:["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"],dayNames:["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"],dayNamesShort:["Sun","Mon","Tue","Wed","Thu","Fri","Sat"],dayNamesMin:["Su","Mo","Tu","We","Th","Fr","Sa"],weekHeader:"Wk",dateFormat:"mm/dd/yy",firstDay:0,isRTL:false,showMonthAfterYear:false,yearSuffix:""};this._defaults={showOn:"focus",showAnim:"fadeIn",showOptions:{},defaultDate:null,appendText:"",buttonText:"...",buttonImage:"",buttonImageOnly:false,hideIfNoPrevNext:false,navigationAsDateFormat:false,gotoCurrent:false,changeMonth:false,changeYear:false,yearRange:"c-10:c+10",showOtherMonths:false,selectOtherMonths:false,showWeek:false,calculateWeek:this.iso8601Week,shortYearCutoff:"+10",minDate:null,maxDate:null,duration:"fast",beforeShowDay:null,beforeShow:null,onSelect:null,onChangeMonthYear:null,onClose:null,numberOfMonths:1,showCurrentAtPos:0,stepMonths:1,stepBigMonths:12,altField:"",altFormat:"",constrainInput:true,showButtonPanel:false,autoSize:false,disabled:false};
$.extend(this._defaults,this.regional[""]);this.dpDiv=bindHover($('<div id="'+this._mainDivId+'" class="ui-datepicker ui-widget ui-widget-content ui-helper-clearfix ui-corner-all"></div>'))}$.extend(Datepicker.prototype,{markerClassName:"hasDatepicker",maxRows:4,log:function(){if(this.debug)console.log.apply("",arguments)},_widgetDatepicker:function(){return this.dpDiv},setDefaults:function(e){extendRemove(this._defaults,e||{});return this},_attachDatepicker:function(target,settings){var inlineSettings=null;for(var attrName in this._defaults){var attrValue=target.getAttribute("date:"+attrName);if(attrValue){inlineSettings=inlineSettings||{};try{inlineSettings[attrName]=eval(attrValue)}catch(err){inlineSettings[attrName]=attrValue}}}var nodeName=target.nodeName.toLowerCase();var inline=nodeName=="div"||nodeName=="span";if(!target.id){this.uuid+=1;target.id="dp"+this.uuid}var inst=this._newInst($(target),inline);inst.settings=$.extend({},settings||{},inlineSettings||{});if(nodeName=="input"){this._connectDatepicker(target,inst)}else if(inline){this._inlineDatepicker(target,inst)}},_newInst:function(e,t){var i=e[0].id.replace(/([^A-Za-z0-9_-])/g,"\\\\$1");return{id:i,input:e,selectedDay:0,selectedMonth:0,selectedYear:0,drawMonth:0,drawYear:0,inline:t,dpDiv:!t?this.dpDiv:bindHover($('<div class="'+this._inlineClass+' ui-datepicker ui-widget ui-widget-content ui-helper-clearfix ui-corner-all"></div>'))}},_connectDatepicker:function(e,t){var i=$(e);t.append=$([]);t.trigger=$([]);if(i.hasClass(this.markerClassName))return;this._attachments(i,t);i.addClass(this.markerClassName).keydown(this._doKeyDown).keypress(this._doKeyPress).keyup(this._doKeyUp).bind("setData.datepicker",function(e,i,n){t.settings[i]=n}).bind("getData.datepicker",function(e,i){return this._get(t,i)});this._autoSize(t);$.data(e,PROP_NAME,t);if(t.settings.disabled){this._disableDatepicker(e)}},_attachments:function(e,t){var i=this._get(t,"appendText");var n=this._get(t,"isRTL");if(t.append)t.append.remove();if(i){t.append=$('<span class="'+this._appendClass+'">'+i+"</span>");e[n?"before":"after"](t.append)}e.unbind("focus",this._showDatepicker);if(t.trigger)t.trigger.remove();var a=this._get(t,"showOn");if(a=="focus"||a=="both")e.focus(this._showDatepicker);if(a=="button"||a=="both"){var r=this._get(t,"buttonText");var s=this._get(t,"buttonImage");t.trigger=$(this._get(t,"buttonImageOnly")?$("<img/>").addClass(this._triggerClass).attr({src:s,alt:r,title:r}):$('<button type="button"></button>').addClass(this._triggerClass).html(s==""?r:$("<img/>").attr({src:s,alt:r,title:r})));e[n?"before":"after"](t.trigger);t.trigger.click(function(){if($.datepicker._datepickerShowing&&$.datepicker._lastInput==e[0])$.datepicker._hideDatepicker();else $.datepicker._showDatepicker(e[0]);return false})}},_autoSize:function(e){if(this._get(e,"autoSize")&&!e.inline){var t=new Date(2009,12-1,20);var i=this._get(e,"dateFormat");if(i.match(/[DM]/)){var n=function(e){var t=0;var i=0;for(var n=0;n<e.length;n++){if(e[n].length>t){t=e[n].length;i=n}}return i};t.setMonth(n(this._get(e,i.match(/MM/)?"monthNames":"monthNamesShort")));t.setDate(n(this._get(e,i.match(/DD/)?"dayNames":"dayNamesShort"))+20-t.getDay())}e.input.attr("size",this._formatDate(e,t).length)}},_inlineDatepicker:function(e,t){var i=$(e);if(i.hasClass(this.markerClassName))return;i.addClass(this.markerClassName).append(t.dpDiv).bind("setData.datepicker",function(e,i,n){t.settings[i]=n}).bind("getData.datepicker",function(e,i){return this._get(t,i)});$.data(e,PROP_NAME,t);this._setDate(t,this._getDefaultDate(t),true);this._updateDatepicker(t);this._updateAlternate(t);if(t.settings.disabled){this._disableDatepicker(e)}t.dpDiv.css("display","block")},_dialogDatepicker:function(e,t,i,n,a){var r=this._dialogInst;if(!r){this.uuid+=1;var s="dp"+this.uuid;this._dialogInput=$('<input type="text" id="'+s+'" style="position: absolute; top: -100px; width: 0px; z-index: -10;"/>');this._dialogInput.keydown(this._doKeyDown);$("body").append(this._dialogInput);r=this._dialogInst=this._newInst(this._dialogInput,false);r.settings={};$.data(this._dialogInput[0],PROP_NAME,r)}extendRemove(r.settings,n||{});t=t&&t.constructor==Date?this._formatDate(r,t):t;this._dialogInput.val(t);this._pos=a?a.length?a:[a.pageX,a.pageY]:null;if(!this._pos){var o=document.documentElement.clientWidth;var l=document.documentElement.clientHeight;var c=document.documentElement.scrollLeft||document.body.scrollLeft;var u=document.documentElement.scrollTop||document.body.scrollTop;this._pos=[o/2-100+c,l/2-150+u]}this._dialogInput.css("left",this._pos[0]+20+"px").css("top",this._pos[1]+"px");r.settings.onSelect=i;this._inDialog=true;this.dpDiv.addClass(this._dialogClass);this._showDatepicker(this._dialogInput[0]);if($.blockUI)$.blockUI(this.dpDiv);$.data(this._dialogInput[0],PROP_NAME,r);return this},_destroyDatepicker:function(e){var t=$(e);var i=$.data(e,PROP_NAME);if(!t.hasClass(this.markerClassName)){return}var n=e.nodeName.toLowerCase();$.removeData(e,PROP_NAME);if(n=="input"){i.append.remove();i.trigger.remove();t.removeClass(this.markerClassName).unbind("focus",this._showDatepicker).unbind("keydown",this._doKeyDown).unbind("keypress",this._doKeyPress).unbind("keyup",this._doKeyUp)}else if(n=="div"||n=="span")t.removeClass(this.markerClassName).empty()},_enableDatepicker:function(e){var t=$(e);var i=$.data(e,PROP_NAME);if(!t.hasClass(this.markerClassName)){return}var n=e.nodeName.toLowerCase();if(n=="input"){e.disabled=false;i.trigger.filter("button").each(function(){this.disabled=false}).end().filter("img").css({opacity:"1.0",cursor:""})}else if(n=="div"||n=="span"){var a=t.children("."+this._inlineClass);a.children().removeClass("ui-state-disabled");a.find("select.ui-datepicker-month, select.ui-datepicker-year").removeAttr("disabled")}this._disabledInputs=$.map(this._disabledInputs,function(t){return t==e?null:t})},_disableDatepicker:function(e){var t=$(e);var i=$.data(e,PROP_NAME);if(!t.hasClass(this.markerClassName)){return}var n=e.nodeName.toLowerCase();if(n=="input"){e.disabled=true;i.trigger.filter("button").each(function(){this.disabled=true}).end().filter("img").css({opacity:"0.5",cursor:"default"})}else if(n=="div"||n=="span"){var a=t.children("."+this._inlineClass);a.children().addClass("ui-state-disabled");a.find("select.ui-datepicker-month, select.ui-datepicker-year").attr("disabled","disabled")}this._disabledInputs=$.map(this._disabledInputs,function(t){return t==e?null:t});this._disabledInputs[this._disabledInputs.length]=e},_isDisabledDatepicker:function(e){if(!e){return false}for(var t=0;t<this._disabledInputs.length;t++){if(this._disabledInputs[t]==e)return true}return false},_getInst:function(e){try{return $.data(e,PROP_NAME)}catch(t){throw"Missing instance data for this datepicker"}},_optionDatepicker:function(e,t,i){var n=this._getInst(e);if(arguments.length==2&&typeof t=="string"){return t=="defaults"?$.extend({},$.datepicker._defaults):n?t=="all"?$.extend({},n.settings):this._get(n,t):null}var a=t||{};if(typeof t=="string"){a={};a[t]=i}if(n){if(this._curInst==n){this._hideDatepicker()}var r=this._getDateDatepicker(e,true);var s=this._getMinMaxDate(n,"min");var o=this._getMinMaxDate(n,"max");extendRemove(n.settings,a);if(s!==null&&a["dateFormat"]!==undefined&&a["minDate"]===undefined)n.settings.minDate=this._formatDate(n,s);if(o!==null&&a["dateFormat"]!==undefined&&a["maxDate"]===undefined)n.settings.maxDate=this._formatDate(n,o);this._attachments($(e),n);this._autoSize(n);this._setDate(n,r);this._updateAlternate(n);this._updateDatepicker(n)}},_changeDatepicker:function(e,t,i){this._optionDatepicker(e,t,i)},_refreshDatepicker:function(e){var t=this._getInst(e);if(t){this._updateDatepicker(t)}},_setDateDatepicker:function(e,t){var i=this._getInst(e);if(i){this._setDate(i,t);this._updateDatepicker(i);this._updateAlternate(i)}},_getDateDatepicker:function(e,t){var i=this._getInst(e);if(i&&!i.inline)this._setDateFromField(i,t);return i?this._getDate(i):null},_doKeyDown:function(e){var t=$.datepicker._getInst(e.target);var i=true;var n=t.dpDiv.is(".ui-datepicker-rtl");t._keyEvent=true;if($.datepicker._datepickerShowing)switch(e.keyCode){case 9:$.datepicker._hideDatepicker();i=false;break;case 13:var a=$("td."+$.datepicker._dayOverClass+":not(."+$.datepicker._currentClass+")",t.dpDiv);if(a[0])$.datepicker._selectDay(e.target,t.selectedMonth,t.selectedYear,a[0]);var r=$.datepicker._get(t,"onSelect");if(r){var s=$.datepicker._formatDate(t);r.apply(t.input?t.input[0]:null,[s,t])}else $.datepicker._hideDatepicker();return false;break;case 27:$.datepicker._hideDatepicker();break;case 33:$.datepicker._adjustDate(e.target,e.ctrlKey?-$.datepicker._get(t,"stepBigMonths"):-$.datepicker._get(t,"stepMonths"),"M");break;case 34:$.datepicker._adjustDate(e.target,e.ctrlKey?+$.datepicker._get(t,"stepBigMonths"):+$.datepicker._get(t,"stepMonths"),"M");break;case 35:if(e.ctrlKey||e.metaKey)$.datepicker._clearDate(e.target);i=e.ctrlKey||e.metaKey;break;case 36:if(e.ctrlKey||e.metaKey)$.datepicker._gotoToday(e.target);i=e.ctrlKey||e.metaKey;break;case 37:if(e.ctrlKey||e.metaKey)$.datepicker._adjustDate(e.target,n?+1:-1,"D");i=e.ctrlKey||e.metaKey;if(e.originalEvent.altKey)$.datepicker._adjustDate(e.target,e.ctrlKey?-$.datepicker._get(t,"stepBigMonths"):-$.datepicker._get(t,"stepMonths"),"M");break;case 38:if(e.ctrlKey||e.metaKey)$.datepicker._adjustDate(e.target,-7,"D");i=e.ctrlKey||e.metaKey;break;case 39:if(e.ctrlKey||e.metaKey)$.datepicker._adjustDate(e.target,n?-1:+1,"D");i=e.ctrlKey||e.metaKey;if(e.originalEvent.altKey)$.datepicker._adjustDate(e.target,e.ctrlKey?+$.datepicker._get(t,"stepBigMonths"):+$.datepicker._get(t,"stepMonths"),"M");break;case 40:if(e.ctrlKey||e.metaKey)$.datepicker._adjustDate(e.target,+7,"D");i=e.ctrlKey||e.metaKey;break;default:i=false}else if(e.keyCode==36&&e.ctrlKey)$.datepicker._showDatepicker(this);else{i=false}if(i){e.preventDefault();e.stopPropagation()}},_doKeyPress:function(e){var t=$.datepicker._getInst(e.target);if($.datepicker._get(t,"constrainInput")){var i=$.datepicker._possibleChars($.datepicker._get(t,"dateFormat"));var n=String.fromCharCode(e.charCode==undefined?e.keyCode:e.charCode);return e.ctrlKey||e.metaKey||n<" "||!i||i.indexOf(n)>-1}},_doKeyUp:function(e){var t=$.datepicker._getInst(e.target);if(t.input.val()!=t.lastVal){try{var i=$.datepicker.parseDate($.datepicker._get(t,"dateFormat"),t.input?t.input.val():null,$.datepicker._getFormatConfig(t));if(i){$.datepicker._setDateFromField(t);$.datepicker._updateAlternate(t);$.datepicker._updateDatepicker(t)}}catch(e){$.datepicker.log(e)}}return true},_showDatepicker:function(e){e=e.target||e;if(e.nodeName.toLowerCase()!="input")e=$("input",e.parentNode)[0];if($.datepicker._isDisabledDatepicker(e)||$.datepicker._lastInput==e)return;var t=$.datepicker._getInst(e);if($.datepicker._curInst&&$.datepicker._curInst!=t){if($.datepicker._datepickerShowing){$.datepicker._triggerOnClose($.datepicker._curInst)}$.datepicker._curInst.dpDiv.stop(true,true)}var i=$.datepicker._get(t,"beforeShow");var n=i?i.apply(e,[e,t]):{};if(n===false){return}extendRemove(t.settings,n);t.lastVal=null;$.datepicker._lastInput=e;$.datepicker._setDateFromField(t);if($.datepicker._inDialog)e.value="";if(!$.datepicker._pos){$.datepicker._pos=$.datepicker._findPos(e);$.datepicker._pos[1]+=e.offsetHeight}var a=false;$(e).parents().each(function(){a|=$(this).css("position")=="fixed";return!a});if(a&&$.browser.opera){$.datepicker._pos[0]-=document.documentElement.scrollLeft;$.datepicker._pos[1]-=document.documentElement.scrollTop}var r={left:$.datepicker._pos[0],top:$.datepicker._pos[1]};$.datepicker._pos=null;t.dpDiv.empty();t.dpDiv.css({position:"absolute",display:"block",top:"-1000px"});$.datepicker._updateDatepicker(t);r=$.datepicker._checkOffset(t,r,a);t.dpDiv.css({position:$.datepicker._inDialog&&$.blockUI?"static":a?"fixed":"absolute",display:"none",left:r.left+"px",top:r.top+"px"});if(!t.inline){var s=$.datepicker._get(t,"showAnim");var o=$.datepicker._get(t,"duration");var l=function(){var e=t.dpDiv.find("iframe.ui-datepicker-cover");if(!!e.length){var i=$.datepicker._getBorders(t.dpDiv);e.css({left:-i[0],top:-i[1],width:t.dpDiv.outerWidth(),height:t.dpDiv.outerHeight()})}};t.dpDiv.zIndex($(e).zIndex()+1);$.datepicker._datepickerShowing=true;if($.effects&&$.effects[s])t.dpDiv.show(s,$.datepicker._get(t,"showOptions"),o,l);else t.dpDiv[s||"show"](s?o:null,l);if(!s||!o)l();if(t.input.is(":visible")&&!t.input.is(":disabled"))t.input.focus();$.datepicker._curInst=t}},_updateDatepicker:function(e){var t=this;t.maxRows=4;var i=$.datepicker._getBorders(e.dpDiv);instActive=e;e.dpDiv.empty().append(this._generateHTML(e));var n=e.dpDiv.find("iframe.ui-datepicker-cover");if(!!n.length){n.css({left:-i[0],top:-i[1],width:e.dpDiv.outerWidth(),height:e.dpDiv.outerHeight()})}e.dpDiv.find("."+this._dayOverClass+" a").mouseover();var a=this._getNumberOfMonths(e);var r=a[1];var s=17;e.dpDiv.removeClass("ui-datepicker-multi-2 ui-datepicker-multi-3 ui-datepicker-multi-4").width("");if(r>1)e.dpDiv.addClass("ui-datepicker-multi-"+r).css("width",s*r+"em");e.dpDiv[(a[0]!=1||a[1]!=1?"add":"remove")+"Class"]("ui-datepicker-multi");e.dpDiv[(this._get(e,"isRTL")?"add":"remove")+"Class"]("ui-datepicker-rtl");if(e==$.datepicker._curInst&&$.datepicker._datepickerShowing&&e.input&&e.input.is(":visible")&&!e.input.is(":disabled")&&e.input[0]!=document.activeElement)e.input.focus();if(e.yearshtml){var o=e.yearshtml;setTimeout(function(){if(o===e.yearshtml&&e.yearshtml){e.dpDiv.find("select.ui-datepicker-year:first").replaceWith(e.yearshtml)}o=e.yearshtml=null},0)}},_getBorders:function(e){var t=function(e){return{thin:1,medium:2,thick:3}[e]||e};return[parseFloat(t(e.css("border-left-width"))),parseFloat(t(e.css("border-top-width")))]},_checkOffset:function(e,t,i){var n=e.dpDiv.outerWidth();var a=e.dpDiv.outerHeight();var r=e.input?e.input.outerWidth():0;var s=e.input?e.input.outerHeight():0;var o=document.documentElement.clientWidth+$(document).scrollLeft();var l=document.documentElement.clientHeight+$(document).scrollTop();t.left-=this._get(e,"isRTL")?n-r:0;t.left-=i&&t.left==e.input.offset().left?$(document).scrollLeft():0;t.top-=i&&t.top==e.input.offset().top+s?$(document).scrollTop():0;t.left-=Math.min(t.left,t.left+n>o&&o>n?Math.abs(t.left+n-o):0);t.top-=Math.min(t.top,t.top+a>l&&l>a?Math.abs(a+s):0);return t},_findPos:function(e){var t=this._getInst(e);var i=this._get(t,"isRTL");while(e&&(e.type=="hidden"||e.nodeType!=1||$.expr.filters.hidden(e))){e=e[i?"previousSibling":"nextSibling"]}var n=$(e).offset();return[n.left,n.top]},_triggerOnClose:function(e){var t=this._get(e,"onClose");if(t)t.apply(e.input?e.input[0]:null,[e.input?e.input.val():"",e])},_hideDatepicker:function(e){var t=this._curInst;if(!t||e&&t!=$.data(e,PROP_NAME))return;if(this._datepickerShowing){var i=this._get(t,"showAnim");var n=this._get(t,"duration");var a=function(){$.datepicker._tidyDialog(t);this._curInst=null};if($.effects&&$.effects[i])t.dpDiv.hide(i,$.datepicker._get(t,"showOptions"),n,a);else t.dpDiv[i=="slideDown"?"slideUp":i=="fadeIn"?"fadeOut":"hide"](i?n:null,a);if(!i)a();$.datepicker._triggerOnClose(t);this._datepickerShowing=false;this._lastInput=null;if(this._inDialog){this._dialogInput.css({position:"absolute",left:"0",top:"-100px"});if($.blockUI){$.unblockUI();$("body").append(this.dpDiv)}}this._inDialog=false}},_tidyDialog:function(e){e.dpDiv.removeClass(this._dialogClass).unbind(".ui-datepicker-calendar")},_checkExternalClick:function(e){if(!$.datepicker._curInst)return;var t=$(e.target);if(t[0].id!=$.datepicker._mainDivId&&t.parents("#"+$.datepicker._mainDivId).length==0&&!t.hasClass($.datepicker.markerClassName)&&!t.hasClass($.datepicker._triggerClass)&&$.datepicker._datepickerShowing&&!($.datepicker._inDialog&&$.blockUI))$.datepicker._hideDatepicker()},_adjustDate:function(e,t,i){var n=$(e);var a=this._getInst(n[0]);if(this._isDisabledDatepicker(n[0])){return}this._adjustInstDate(a,t+(i=="M"?this._get(a,"showCurrentAtPos"):0),i);this._updateDatepicker(a)},_gotoToday:function(e){var t=$(e);var i=this._getInst(t[0]);if(this._get(i,"gotoCurrent")&&i.currentDay){i.selectedDay=i.currentDay;i.drawMonth=i.selectedMonth=i.currentMonth;i.drawYear=i.selectedYear=i.currentYear}else{var n=new Date;i.selectedDay=n.getDate();i.drawMonth=i.selectedMonth=n.getMonth();i.drawYear=i.selectedYear=n.getFullYear()}this._notifyChange(i);this._adjustDate(t)},_selectMonthYear:function(e,t,i){var n=$(e);var a=this._getInst(n[0]);a["selected"+(i=="M"?"Month":"Year")]=a["draw"+(i=="M"?"Month":"Year")]=parseInt(t.options[t.selectedIndex].value,10);this._notifyChange(a);this._adjustDate(n)},_selectDay:function(e,t,i,n){var a=$(e);if($(n).hasClass(this._unselectableClass)||this._isDisabledDatepicker(a[0])){return}var r=this._getInst(a[0]);r.selectedDay=r.currentDay=$("a",n).html();r.selectedMonth=r.currentMonth=t;r.selectedYear=r.currentYear=i;this._selectDate(e,this._formatDate(r,r.currentDay,r.currentMonth,r.currentYear))},_clearDate:function(e){var t=$(e);var i=this._getInst(t[0]);this._selectDate(t,"")},_selectDate:function(e,t){var i=$(e);var n=this._getInst(i[0]);t=t!=null?t:this._formatDate(n);if(n.input)n.input.val(t);this._updateAlternate(n);var a=this._get(n,"onSelect");if(a)a.apply(n.input?n.input[0]:null,[t,n]);else if(n.input)n.input.trigger("change");if(n.inline)this._updateDatepicker(n);else{this._hideDatepicker();this._lastInput=n.input[0];if(typeof n.input[0]!="object")n.input.focus();this._lastInput=null}},_updateAlternate:function(e){var t=this._get(e,"altField");if(t){var i=this._get(e,"altFormat")||this._get(e,"dateFormat");var n=this._getDate(e);var a=this.formatDate(i,n,this._getFormatConfig(e));$(t).each(function(){$(this).val(a)})}},noWeekends:function(e){var t=e.getDay();return[t>0&&t<6,""]},iso8601Week:function(e){var t=new Date(e.getTime());t.setDate(t.getDate()+4-(t.getDay()||7));var i=t.getTime();t.setMonth(0);t.setDate(1);return Math.floor(Math.round((i-t)/864e5)/7)+1},parseDate:function(e,t,i){if(e==null||t==null)throw"Invalid arguments";t=typeof t=="object"?t.toString():t+"";if(t=="")return null;var n=(i?i.shortYearCutoff:null)||this._defaults.shortYearCutoff;n=typeof n!="string"?n:(new Date).getFullYear()%100+parseInt(n,10);var a=(i?i.dayNamesShort:null)||this._defaults.dayNamesShort;var r=(i?i.dayNames:null)||this._defaults.dayNames;var s=(i?i.monthNamesShort:null)||this._defaults.monthNamesShort;var o=(i?i.monthNames:null)||this._defaults.monthNames;var l=-1;var c=-1;var u=-1;var d=-1;var f=false;var h=function(t){var i=b+1<e.length&&e.charAt(b+1)==t;if(i)b++;return i};var p=function(e){var i=h(e);var n=e=="@"?14:e=="!"?20:e=="y"&&i?4:e=="o"?3:2;var a=new RegExp("^\\d{1,"+n+"}");var r=t.substring(v).match(a);if(!r)throw"Missing number at position "+v;v+=r[0].length;return parseInt(r[0],10)};var m=function(e,i,n){var a=$.map(h(e)?n:i,function(e,t){return[[t,e]]}).sort(function(e,t){return-(e[1].length-t[1].length)});var r=-1;$.each(a,function(e,i){var n=i[1];if(t.substr(v,n.length).toLowerCase()==n.toLowerCase()){r=i[0];v+=n.length;return false}});if(r!=-1)return r+1;else throw"Unknown name at position "+v};var g=function(){if(t.charAt(v)!=e.charAt(b))throw"Unexpected literal at position "+v;v++};var v=0;for(var b=0;b<e.length;b++){if(f)if(e.charAt(b)=="'"&&!h("'"))f=false;else g();else switch(e.charAt(b)){case"d":u=p("d");break;case"D":m("D",a,r);break;case"o":d=p("o");break;case"m":c=p("m");break;case"M":c=m("M",s,o);break;case"y":l=p("y");break;case"@":var y=new Date(p("@"));l=y.getFullYear();c=y.getMonth()+1;u=y.getDate();break;case"!":var y=new Date((p("!")-this._ticksTo1970)/1e4);l=y.getFullYear();c=y.getMonth()+1;u=y.getDate();break;case"'":if(h("'"))g();else f=true;break;default:g()}}if(v<t.length){throw"Extra/unparsed characters found in date: "+t.substring(v)}if(l==-1)l=(new Date).getFullYear();else if(l<100)l+=(new Date).getFullYear()-(new Date).getFullYear()%100+(l<=n?0:-100);if(d>-1){c=1;u=d;do{var _=this._getDaysInMonth(l,c-1);if(u<=_)break;c++;u-=_}while(true)}var y=this._daylightSavingAdjust(new Date(l,c-1,u));if(y.getFullYear()!=l||y.getMonth()+1!=c||y.getDate()!=u)throw"Invalid date";return y},ATOM:"yy-mm-dd",COOKIE:"D, dd M yy",ISO_8601:"yy-mm-dd",RFC_822:"D, d M y",RFC_850:"DD, dd-M-y",RFC_1036:"D, d M y",RFC_1123:"D, d M yy",RFC_2822:"D, d M yy",RSS:"D, d M y",TICKS:"!",TIMESTAMP:"@",W3C:"yy-mm-dd",_ticksTo1970:((1970-1)*365+Math.floor(1970/4)-Math.floor(1970/100)+Math.floor(1970/400))*24*60*60*1e7,formatDate:function(e,t,i){if(!t)return"";var n=(i?i.dayNamesShort:null)||this._defaults.dayNamesShort;var a=(i?i.dayNames:null)||this._defaults.dayNames;var r=(i?i.monthNamesShort:null)||this._defaults.monthNamesShort;var s=(i?i.monthNames:null)||this._defaults.monthNames;var o=function(t){var i=f+1<e.length&&e.charAt(f+1)==t;if(i)f++;return i};var l=function(e,t,i){var n=""+t;if(o(e))while(n.length<i)n="0"+n;return n};var c=function(e,t,i,n){return o(e)?n[t]:i[t]};var u="";var d=false;if(t)for(var f=0;f<e.length;f++){if(d)if(e.charAt(f)=="'"&&!o("'"))d=false;else u+=e.charAt(f);else switch(e.charAt(f)){case"d":u+=l("d",t.getDate(),2);break;case"D":u+=c("D",t.getDay(),n,a);break;case"o":u+=l("o",Math.round((new Date(t.getFullYear(),t.getMonth(),t.getDate()).getTime()-new Date(t.getFullYear(),0,0).getTime())/864e5),3);break;case"m":u+=l("m",t.getMonth()+1,2);break;case"M":u+=c("M",t.getMonth(),r,s);break;case"y":u+=o("y")?t.getFullYear():(t.getYear()%100<10?"0":"")+t.getYear()%100;break;case"@":u+=t.getTime();break;case"!":u+=t.getTime()*1e4+this._ticksTo1970;break;case"'":if(o("'"))u+="'";else d=true;break;default:u+=e.charAt(f)}}return u},_possibleChars:function(e){var t="";var i=false;var n=function(t){var i=a+1<e.length&&e.charAt(a+1)==t;if(i)a++;return i};for(var a=0;a<e.length;a++)if(i)if(e.charAt(a)=="'"&&!n("'"))i=false;else t+=e.charAt(a);else switch(e.charAt(a)){case"d":case"m":case"y":case"@":t+="0123456789";break;case"D":case"M":return null;case"'":if(n("'"))t+="'";else i=true;break;default:t+=e.charAt(a)}return t},_get:function(e,t){return e.settings[t]!==undefined?e.settings[t]:this._defaults[t]},_setDateFromField:function(e,t){if(e.input.val()==e.lastVal){return}var i=this._get(e,"dateFormat");var n=e.lastVal=e.input?e.input.val():null;var a,r;a=r=this._getDefaultDate(e);var s=this._getFormatConfig(e);try{a=this.parseDate(i,n,s)||r}catch(o){this.log(o);n=t?"":n}e.selectedDay=a.getDate();e.drawMonth=e.selectedMonth=a.getMonth();e.drawYear=e.selectedYear=a.getFullYear();e.currentDay=n?a.getDate():0;e.currentMonth=n?a.getMonth():0;e.currentYear=n?a.getFullYear():0;this._adjustInstDate(e)},_getDefaultDate:function(e){return this._restrictMinMax(e,this._determineDate(e,this._get(e,"defaultDate"),new Date))},_determineDate:function(e,t,i){var n=function(e){var t=new Date;t.setDate(t.getDate()+e);return t};var a=function(t){try{return $.datepicker.parseDate($.datepicker._get(e,"dateFormat"),t,$.datepicker._getFormatConfig(e))}catch(i){}var n=(t.toLowerCase().match(/^c/)?$.datepicker._getDate(e):null)||new Date;var a=n.getFullYear();var r=n.getMonth();var s=n.getDate();var o=/([+-]?[0-9]+)\s*(d|D|w|W|m|M|y|Y)?/g;var l=o.exec(t);while(l){switch(l[2]||"d"){case"d":case"D":s+=parseInt(l[1],10);break;case"w":case"W":s+=parseInt(l[1],10)*7;break;case"m":case"M":r+=parseInt(l[1],10);s=Math.min(s,$.datepicker._getDaysInMonth(a,r));break;case"y":case"Y":a+=parseInt(l[1],10);s=Math.min(s,$.datepicker._getDaysInMonth(a,r));break}l=o.exec(t)}return new Date(a,r,s)};var r=t==null||t===""?i:typeof t=="string"?a(t):typeof t=="number"?isNaN(t)?i:n(t):new Date(t.getTime());r=r&&r.toString()=="Invalid Date"?i:r;if(r){r.setHours(0);r.setMinutes(0);r.setSeconds(0);r.setMilliseconds(0)}return this._daylightSavingAdjust(r)},_daylightSavingAdjust:function(e){if(!e)return null;e.setHours(e.getHours()>12?e.getHours()+2:0);return e},_setDate:function(e,t,i){var n=!t;var a=e.selectedMonth;var r=e.selectedYear;var s=this._restrictMinMax(e,this._determineDate(e,t,new Date));e.selectedDay=e.currentDay=s.getDate();e.drawMonth=e.selectedMonth=e.currentMonth=s.getMonth();e.drawYear=e.selectedYear=e.currentYear=s.getFullYear();if((a!=e.selectedMonth||r!=e.selectedYear)&&!i)this._notifyChange(e);this._adjustInstDate(e);if(e.input){e.input.val(n?"":this._formatDate(e))}},_getDate:function(e){var t=!e.currentYear||e.input&&e.input.val()==""?null:this._daylightSavingAdjust(new Date(e.currentYear,e.currentMonth,e.currentDay));return t},_generateHTML:function(e){var t=new Date;t=this._daylightSavingAdjust(new Date(t.getFullYear(),t.getMonth(),t.getDate()));var i=this._get(e,"isRTL");var n=this._get(e,"showButtonPanel");var a=this._get(e,"hideIfNoPrevNext");var r=this._get(e,"navigationAsDateFormat");var s=this._getNumberOfMonths(e);var o=this._get(e,"showCurrentAtPos");var l=this._get(e,"stepMonths");var c=s[0]!=1||s[1]!=1;var u=this._daylightSavingAdjust(!e.currentDay?new Date(9999,9,9):new Date(e.currentYear,e.currentMonth,e.currentDay));var d=this._getMinMaxDate(e,"min");var f=this._getMinMaxDate(e,"max");var h=e.drawMonth-o;var p=e.drawYear;if(h<0){h+=12;p--}if(f){var m=this._daylightSavingAdjust(new Date(f.getFullYear(),f.getMonth()-s[0]*s[1]+1,f.getDate()));m=d&&m<d?d:m;while(this._daylightSavingAdjust(new Date(p,h,1))>m){h--;if(h<0){h=11;p--}}}e.drawMonth=h;e.drawYear=p;var g=this._get(e,"prevText");g=!r?g:this.formatDate(g,this._daylightSavingAdjust(new Date(p,h-l,1)),this._getFormatConfig(e));var v=this._canAdjustMonth(e,-1,p,h)?'<a class="ui-datepicker-prev ui-corner-all" onclick="DP_jQuery_'+dpuuid+".datepicker._adjustDate('#"+e.id+"', -"+l+", 'M');\""+' title="'+g+'"><span class="ui-icon ui-icon-circle-triangle-'+(i?"e":"w")+'">'+g+"</span></a>":a?"":'<a class="ui-datepicker-prev ui-corner-all ui-state-disabled" title="'+g+'"><span class="ui-icon ui-icon-circle-triangle-'+(i?"e":"w")+'">'+g+"</span></a>";var b=this._get(e,"nextText");b=!r?b:this.formatDate(b,this._daylightSavingAdjust(new Date(p,h+l,1)),this._getFormatConfig(e));var y=this._canAdjustMonth(e,+1,p,h)?'<a class="ui-datepicker-next ui-corner-all" onclick="DP_jQuery_'+dpuuid+".datepicker._adjustDate('#"+e.id+"', +"+l+", 'M');\""+' title="'+b+'"><span class="ui-icon ui-icon-circle-triangle-'+(i?"w":"e")+'">'+b+"</span></a>":a?"":'<a class="ui-datepicker-next ui-corner-all ui-state-disabled" title="'+b+'"><span class="ui-icon ui-icon-circle-triangle-'+(i?"w":"e")+'">'+b+"</span></a>";var _=this._get(e,"currentText");var w=this._get(e,"gotoCurrent")&&e.currentDay?u:t;_=!r?_:this.formatDate(_,w,this._getFormatConfig(e));var k=!e.inline?'<button type="button" class="ui-datepicker-close ui-state-default ui-priority-primary ui-corner-all" onclick="DP_jQuery_'+dpuuid+'.datepicker._hideDatepicker();">'+this._get(e,"closeText")+"</button>":"";var x=n?'<div class="ui-datepicker-buttonpane ui-widget-content">'+(i?k:"")+(this._isInRange(e,w)?'<button type="button" class="ui-datepicker-current ui-state-default ui-priority-secondary ui-corner-all" onclick="DP_jQuery_'+dpuuid+".datepicker._gotoToday('#"+e.id+"');\""+">"+_+"</button>":"")+(i?"":k)+"</div>":"";var C=parseInt(this._get(e,"firstDay"),10);C=isNaN(C)?0:C;var D=this._get(e,"showWeek");var P=this._get(e,"dayNames");var I=this._get(e,"dayNamesShort");var S=this._get(e,"dayNamesMin");var M=this._get(e,"monthNames");var T=this._get(e,"monthNamesShort");var A=this._get(e,"beforeShowDay");var j=this._get(e,"showOtherMonths");var N=this._get(e,"selectOtherMonths");var z=this._get(e,"calculateWeek")||this.iso8601Week;var E=this._getDefaultDate(e);var O="";for(var F=0;F<s[0];F++){var H="";this.maxRows=4;for(var R=0;R<s[1];R++){var L=this._daylightSavingAdjust(new Date(p,h,e.selectedDay));var W=" ui-corner-all";var Y="";if(c){Y+='<div class="ui-datepicker-group';if(s[1]>1)switch(R){case 0:Y+=" ui-datepicker-group-first";W=" ui-corner-"+(i?"right":"left");break;case s[1]-1:Y+=" ui-datepicker-group-last";W=" ui-corner-"+(i?"left":"right");break;default:Y+=" ui-datepicker-group-middle";W="";break}Y+='">'}Y+='<div class="ui-datepicker-header ui-widget-header ui-helper-clearfix'+W+'">'+(/all|left/.test(W)&&F==0?i?y:v:"")+(/all|right/.test(W)&&F==0?i?v:y:"")+this._generateMonthYearHeader(e,h,p,d,f,F>0||R>0,M,T)+'</div><table class="ui-datepicker-calendar"><thead>'+"<tr>";var q=D?'<th class="ui-datepicker-week-col">'+this._get(e,"weekHeader")+"</th>":"";for(var B=0;B<7;B++){var V=(B+C)%7;q+="<th"+((B+C+6)%7>=5?' class="ui-datepicker-week-end"':"")+">"+'<span title="'+P[V]+'">'+S[V]+"</span></th>"}Y+=q+"</tr></thead><tbody>";var U=this._getDaysInMonth(p,h);if(p==e.selectedYear&&h==e.selectedMonth)e.selectedDay=Math.min(e.selectedDay,U);var K=(this._getFirstDayOfMonth(p,h)-C+7)%7;var Q=Math.ceil((K+U)/7);var J=c?this.maxRows>Q?this.maxRows:Q:Q;this.maxRows=J;var G=this._daylightSavingAdjust(new Date(p,h,1-K));for(var X=0;X<J;X++){Y+="<tr>";var Z=!D?"":'<td class="ui-datepicker-week-col">'+this._get(e,"calculateWeek")(G)+"</td>";for(var B=0;B<7;B++){var et=A?A.apply(e.input?e.input[0]:null,[G]):[true,""];var tt=G.getMonth()!=h;var it=tt&&!N||!et[0]||d&&G<d||f&&G>f;Z+='<td class="'+((B+C+6)%7>=5?" ui-datepicker-week-end":"")+(tt?" ui-datepicker-other-month":"")+(G.getTime()==L.getTime()&&h==e.selectedMonth&&e._keyEvent||E.getTime()==G.getTime()&&E.getTime()==L.getTime()?" "+this._dayOverClass:"")+(it?" "+this._unselectableClass+" ui-state-disabled":"")+(tt&&!j?"":" "+et[1]+(G.getTime()==u.getTime()?" "+this._currentClass:"")+(G.getTime()==t.getTime()?" ui-datepicker-today":""))+'"'+((!tt||j)&&et[2]?' title="'+et[2]+'"':"")+(it?"":' onclick="DP_jQuery_'+dpuuid+".datepicker._selectDay('#"+e.id+"',"+G.getMonth()+","+G.getFullYear()+', this);return false;"')+">"+(tt&&!j?"&#xa0;":it?'<span class="ui-state-default">'+G.getDate()+"</span>":'<a class="ui-state-default'+(G.getTime()==t.getTime()?" ui-state-highlight":"")+(G.getTime()==u.getTime()?" ui-state-active":"")+(tt?" ui-priority-secondary":"")+'" href="#">'+G.getDate()+"</a>")+"</td>";G.setDate(G.getDate()+1);G=this._daylightSavingAdjust(G)}Y+=Z+"</tr>"}h++;if(h>11){h=0;p++}Y+="</tbody></table>"+(c?"</div>"+(s[0]>0&&R==s[1]-1?'<div class="ui-datepicker-row-break"></div>':""):"");H+=Y}O+=H}O+=x+($.browser.msie&&parseInt($.browser.version,10)<7&&!e.inline?'<iframe src="javascript:false;" class="ui-datepicker-cover" frameborder="0"></iframe>':"");e._keyEvent=false;return O},_generateMonthYearHeader:function(e,t,i,n,a,r,s,o){var l=this._get(e,"changeMonth");var c=this._get(e,"changeYear");var u=this._get(e,"showMonthAfterYear");var d='<div class="ui-datepicker-title">';var f="";if(r||!l)f+='<span class="ui-datepicker-month">'+s[t]+"</span>";else{var h=n&&n.getFullYear()==i;var p=a&&a.getFullYear()==i;f+='<select class="ui-datepicker-month" '+'onchange="DP_jQuery_'+dpuuid+".datepicker._selectMonthYear('#"+e.id+"', this, 'M');\" "+">";for(var m=0;m<12;m++){if((!h||m>=n.getMonth())&&(!p||m<=a.getMonth()))f+='<option value="'+m+'"'+(m==t?' selected="selected"':"")+">"+o[m]+"</option>"}f+="</select>"}if(!u)d+=f+(r||!(l&&c)?"&#xa0;":"");if(!e.yearshtml){e.yearshtml="";if(r||!c)d+='<span class="ui-datepicker-year">'+i+"</span>";else{var g=this._get(e,"yearRange").split(":");var v=(new Date).getFullYear();var b=function(e){var t=e.match(/c[+-].*/)?i+parseInt(e.substring(1),10):e.match(/[+-].*/)?v+parseInt(e,10):parseInt(e,10);return isNaN(t)?v:t};var y=b(g[0]);var _=Math.max(y,b(g[1]||""));y=n?Math.max(y,n.getFullYear()):y;_=a?Math.min(_,a.getFullYear()):_;e.yearshtml+='<select class="ui-datepicker-year" '+'onchange="DP_jQuery_'+dpuuid+".datepicker._selectMonthYear('#"+e.id+"', this, 'Y');\" "+">";for(;y<=_;y++){e.yearshtml+='<option value="'+y+'"'+(y==i?' selected="selected"':"")+">"+y+"</option>"}e.yearshtml+="</select>";d+=e.yearshtml;e.yearshtml=null}}d+=this._get(e,"yearSuffix");if(u)d+=(r||!(l&&c)?"&#xa0;":"")+f;d+="</div>";return d},_adjustInstDate:function(e,t,i){var n=e.drawYear+(i=="Y"?t:0);var a=e.drawMonth+(i=="M"?t:0);var r=Math.min(e.selectedDay,this._getDaysInMonth(n,a))+(i=="D"?t:0);
var s=this._restrictMinMax(e,this._daylightSavingAdjust(new Date(n,a,r)));e.selectedDay=s.getDate();e.drawMonth=e.selectedMonth=s.getMonth();e.drawYear=e.selectedYear=s.getFullYear();if(i=="M"||i=="Y")this._notifyChange(e)},_restrictMinMax:function(e,t){var i=this._getMinMaxDate(e,"min");var n=this._getMinMaxDate(e,"max");var a=i&&t<i?i:t;a=n&&a>n?n:a;return a},_notifyChange:function(e){var t=this._get(e,"onChangeMonthYear");if(t)t.apply(e.input?e.input[0]:null,[e.selectedYear,e.selectedMonth+1,e])},_getNumberOfMonths:function(e){var t=this._get(e,"numberOfMonths");return t==null?[1,1]:typeof t=="number"?[1,t]:t},_getMinMaxDate:function(e,t){return this._determineDate(e,this._get(e,t+"Date"),null)},_getDaysInMonth:function(e,t){return 32-this._daylightSavingAdjust(new Date(e,t,32)).getDate()},_getFirstDayOfMonth:function(e,t){return new Date(e,t,1).getDay()},_canAdjustMonth:function(e,t,i,n){var a=this._getNumberOfMonths(e);var r=this._daylightSavingAdjust(new Date(i,n+(t<0?t:a[0]*a[1]),1));if(t<0)r.setDate(this._getDaysInMonth(r.getFullYear(),r.getMonth()));return this._isInRange(e,r)},_isInRange:function(e,t){var i=this._getMinMaxDate(e,"min");var n=this._getMinMaxDate(e,"max");return(!i||t.getTime()>=i.getTime())&&(!n||t.getTime()<=n.getTime())},_getFormatConfig:function(e){var t=this._get(e,"shortYearCutoff");t=typeof t!="string"?t:(new Date).getFullYear()%100+parseInt(t,10);return{shortYearCutoff:t,dayNamesShort:this._get(e,"dayNamesShort"),dayNames:this._get(e,"dayNames"),monthNamesShort:this._get(e,"monthNamesShort"),monthNames:this._get(e,"monthNames")}},_formatDate:function(e,t,i,n){if(!t){e.currentDay=e.selectedDay;e.currentMonth=e.selectedMonth;e.currentYear=e.selectedYear}var a=t?typeof t=="object"?t:this._daylightSavingAdjust(new Date(n,i,t)):this._daylightSavingAdjust(new Date(e.currentYear,e.currentMonth,e.currentDay));return this.formatDate(this._get(e,"dateFormat"),a,this._getFormatConfig(e))}});function bindHover(e){var t="button, .ui-datepicker-prev, .ui-datepicker-next, .ui-datepicker-calendar td a";return e.bind("mouseout",function(e){var i=$(e.target).closest(t);if(!i.length){return}i.removeClass("ui-state-hover ui-datepicker-prev-hover ui-datepicker-next-hover")}).bind("mouseover",function(i){var n=$(i.target).closest(t);if($.datepicker._isDisabledDatepicker(instActive.inline?e.parent()[0]:instActive.input[0])||!n.length){return}n.parents(".ui-datepicker-calendar").find("a").removeClass("ui-state-hover");n.addClass("ui-state-hover");if(n.hasClass("ui-datepicker-prev"))n.addClass("ui-datepicker-prev-hover");if(n.hasClass("ui-datepicker-next"))n.addClass("ui-datepicker-next-hover")})}function extendRemove(e,t){$.extend(e,t);for(var i in t)if(t[i]==null||t[i]==undefined)e[i]=t[i];return e}function isArray(e){return e&&($.browser.safari&&typeof e=="object"&&e.length||e.constructor&&e.constructor.toString().match(/\Array\(\)/))}$.fn.datepicker=function(e){if(!this.length){return this}if(!$.datepicker.initialized){$(document).mousedown($.datepicker._checkExternalClick).find("body").append($.datepicker.dpDiv);$.datepicker.initialized=true}var t=Array.prototype.slice.call(arguments,1);if(typeof e=="string"&&(e=="isDisabled"||e=="getDate"||e=="widget"))return $.datepicker["_"+e+"Datepicker"].apply($.datepicker,[this[0]].concat(t));if(e=="option"&&arguments.length==2&&typeof arguments[1]=="string")return $.datepicker["_"+e+"Datepicker"].apply($.datepicker,[this[0]].concat(t));return this.each(function(){typeof e=="string"?$.datepicker["_"+e+"Datepicker"].apply($.datepicker,[this].concat(t)):$.datepicker._attachDatepicker(this,e)})};$.datepicker=new Datepicker;$.datepicker.initialized=false;$.datepicker.uuid=(new Date).getTime();$.datepicker.version="1.8.16";window["DP_jQuery_"+dpuuid]=$})(jQuery);(function(e,t){e.widget("ui.sortable",e.ui.mouse,{widgetEventPrefix:"sort",options:{appendTo:"parent",axis:false,connectWith:false,containment:false,cursor:"auto",cursorAt:false,dropOnEmpty:true,forcePlaceholderSize:false,forceHelperSize:false,grid:false,handle:false,helper:"original",items:"> *",opacity:false,placeholder:false,revert:false,scroll:true,scrollSensitivity:20,scrollSpeed:20,scope:"default",tolerance:"intersect",zIndex:1e3},_create:function(){var e=this.options;this.containerCache={};this.element.addClass("ui-sortable");this.refresh();this.floating=this.items.length?e.axis==="x"||/left|right/.test(this.items[0].item.css("float"))||/inline|table-cell/.test(this.items[0].item.css("display")):false;this.offset=this.element.offset();this._mouseInit()},destroy:function(){this.element.removeClass("ui-sortable ui-sortable-disabled").removeData("sortable").unbind(".sortable");this._mouseDestroy();for(var e=this.items.length-1;e>=0;e--)this.items[e].item.removeData("sortable-item");return this},_setOption:function(t,i){if(t==="disabled"){this.options[t]=i;this.widget()[i?"addClass":"removeClass"]("ui-sortable-disabled")}else{e.Widget.prototype._setOption.apply(this,arguments)}},_mouseCapture:function(t,i){if(this.reverting){return false}if(this.options.disabled||this.options.type=="static")return false;this._refreshItems(t);var n=null,a=this,r=e(t.target).parents().each(function(){if(e.data(this,"sortable-item")==a){n=e(this);return false}});if(e.data(t.target,"sortable-item")==a)n=e(t.target);if(!n)return false;if(this.options.handle&&!i){var s=false;e(this.options.handle,n).find("*").andSelf().each(function(){if(this==t.target)s=true});if(!s)return false}this.currentItem=n;this._removeCurrentsFromItems();return true},_mouseStart:function(t,i,n){var a=this.options,r=this;this.currentContainer=this;this.refreshPositions();this.helper=this._createHelper(t);this._cacheHelperProportions();this._cacheMargins();this.scrollParent=this.helper.scrollParent();this.offset=this.currentItem.offset();this.offset={top:this.offset.top-this.margins.top,left:this.offset.left-this.margins.left};this.helper.css("position","absolute");this.cssPosition=this.helper.css("position");e.extend(this.offset,{click:{left:t.pageX-this.offset.left,top:t.pageY-this.offset.top},parent:this._getParentOffset(),relative:this._getRelativeOffset()});this.originalPosition=this._generatePosition(t);this.originalPageX=t.pageX;this.originalPageY=t.pageY;a.cursorAt&&this._adjustOffsetFromHelper(a.cursorAt);this.domPosition={prev:this.currentItem.prev()[0],parent:this.currentItem.parent()[0]};if(this.helper[0]!=this.currentItem[0]){this.currentItem.hide()}this._createPlaceholder();if(a.containment)this._setContainment();if(a.cursor){if(e("body").css("cursor"))this._storedCursor=e("body").css("cursor");e("body").css("cursor",a.cursor)}if(a.opacity){if(this.helper.css("opacity"))this._storedOpacity=this.helper.css("opacity");this.helper.css("opacity",a.opacity)}if(a.zIndex){if(this.helper.css("zIndex"))this._storedZIndex=this.helper.css("zIndex");this.helper.css("zIndex",a.zIndex)}if(this.scrollParent[0]!=document&&this.scrollParent[0].tagName!="HTML")this.overflowOffset=this.scrollParent.offset();this._trigger("start",t,this._uiHash());if(!this._preserveHelperProportions)this._cacheHelperProportions();if(!n){for(var s=this.containers.length-1;s>=0;s--){this.containers[s]._trigger("activate",t,r._uiHash(this))}}if(e.ui.ddmanager)e.ui.ddmanager.current=this;if(e.ui.ddmanager&&!a.dropBehaviour)e.ui.ddmanager.prepareOffsets(this,t);this.dragging=true;this.helper.addClass("ui-sortable-helper");this._mouseDrag(t);return true},_mouseDrag:function(t){this.position=this._generatePosition(t);this.positionAbs=this._convertPositionTo("absolute");if(!this.lastPositionAbs){this.lastPositionAbs=this.positionAbs}if(this.options.scroll){var i=this.options,n=false;if(this.scrollParent[0]!=document&&this.scrollParent[0].tagName!="HTML"){if(this.overflowOffset.top+this.scrollParent[0].offsetHeight-t.pageY<i.scrollSensitivity)this.scrollParent[0].scrollTop=n=this.scrollParent[0].scrollTop+i.scrollSpeed;else if(t.pageY-this.overflowOffset.top<i.scrollSensitivity)this.scrollParent[0].scrollTop=n=this.scrollParent[0].scrollTop-i.scrollSpeed;if(this.overflowOffset.left+this.scrollParent[0].offsetWidth-t.pageX<i.scrollSensitivity)this.scrollParent[0].scrollLeft=n=this.scrollParent[0].scrollLeft+i.scrollSpeed;else if(t.pageX-this.overflowOffset.left<i.scrollSensitivity)this.scrollParent[0].scrollLeft=n=this.scrollParent[0].scrollLeft-i.scrollSpeed}else{if(t.pageY-e(document).scrollTop()<i.scrollSensitivity)n=e(document).scrollTop(e(document).scrollTop()-i.scrollSpeed);else if(e(window).height()-(t.pageY-e(document).scrollTop())<i.scrollSensitivity)n=e(document).scrollTop(e(document).scrollTop()+i.scrollSpeed);if(t.pageX-e(document).scrollLeft()<i.scrollSensitivity)n=e(document).scrollLeft(e(document).scrollLeft()-i.scrollSpeed);else if(e(window).width()-(t.pageX-e(document).scrollLeft())<i.scrollSensitivity)n=e(document).scrollLeft(e(document).scrollLeft()+i.scrollSpeed)}if(n!==false&&e.ui.ddmanager&&!i.dropBehaviour)e.ui.ddmanager.prepareOffsets(this,t)}this.positionAbs=this._convertPositionTo("absolute");if(!this.options.axis||this.options.axis!="y")this.helper[0].style.left=this.position.left+"px";if(!this.options.axis||this.options.axis!="x")this.helper[0].style.top=this.position.top+"px";for(var a=this.items.length-1;a>=0;a--){var r=this.items[a],s=r.item[0],o=this._intersectsWithPointer(r);if(!o)continue;if(s!=this.currentItem[0]&&this.placeholder[o==1?"next":"prev"]()[0]!=s&&!e.ui.contains(this.placeholder[0],s)&&(this.options.type=="semi-dynamic"?!e.ui.contains(this.element[0],s):true)){this.direction=o==1?"down":"up";if(this.options.tolerance=="pointer"||this._intersectsWithSides(r)){this._rearrange(t,r)}else{break}this._trigger("change",t,this._uiHash());break}}this._contactContainers(t);if(e.ui.ddmanager)e.ui.ddmanager.drag(this,t);this._trigger("sort",t,this._uiHash());this.lastPositionAbs=this.positionAbs;return false},_mouseStop:function(t,i){if(!t)return;if(e.ui.ddmanager&&!this.options.dropBehaviour)e.ui.ddmanager.drop(this,t);if(this.options.revert){var n=this;var a=n.placeholder.offset();n.reverting=true;e(this.helper).animate({left:a.left-this.offset.parent.left-n.margins.left+(this.offsetParent[0]==document.body?0:this.offsetParent[0].scrollLeft),top:a.top-this.offset.parent.top-n.margins.top+(this.offsetParent[0]==document.body?0:this.offsetParent[0].scrollTop)},parseInt(this.options.revert,10)||500,function(){n._clear(t)})}else{this._clear(t,i)}return false},cancel:function(){var t=this;if(this.dragging){this._mouseUp({target:null});if(this.options.helper=="original")this.currentItem.css(this._storedCSS).removeClass("ui-sortable-helper");else this.currentItem.show();for(var i=this.containers.length-1;i>=0;i--){this.containers[i]._trigger("deactivate",null,t._uiHash(this));if(this.containers[i].containerCache.over){this.containers[i]._trigger("out",null,t._uiHash(this));this.containers[i].containerCache.over=0}}}if(this.placeholder){if(this.placeholder[0].parentNode)this.placeholder[0].parentNode.removeChild(this.placeholder[0]);if(this.options.helper!="original"&&this.helper&&this.helper[0].parentNode)this.helper.remove();e.extend(this,{helper:null,dragging:false,reverting:false,_noFinalSort:null});if(this.domPosition.prev){e(this.domPosition.prev).after(this.currentItem)}else{e(this.domPosition.parent).prepend(this.currentItem)}}return this},serialize:function(t){var i=this._getItemsAsjQuery(t&&t.connected);var n=[];t=t||{};e(i).each(function(){var i=(e(t.item||this).attr(t.attribute||"id")||"").match(t.expression||/(.+)[-=_](.+)/);if(i)n.push((t.key||i[1]+"[]")+"="+(t.key&&t.expression?i[1]:i[2]))});if(!n.length&&t.key){n.push(t.key+"=")}return n.join("&")},toArray:function(t){var i=this._getItemsAsjQuery(t&&t.connected);var n=[];t=t||{};i.each(function(){n.push(e(t.item||this).attr(t.attribute||"id")||"")});return n},_intersectsWith:function(e){var t=this.positionAbs.left,i=t+this.helperProportions.width,n=this.positionAbs.top,a=n+this.helperProportions.height;var r=e.left,s=r+e.width,o=e.top,l=o+e.height;var c=this.offset.click.top,u=this.offset.click.left;var d=n+c>o&&n+c<l&&t+u>r&&t+u<s;if(this.options.tolerance=="pointer"||this.options.forcePointerForContainers||this.options.tolerance!="pointer"&&this.helperProportions[this.floating?"width":"height"]>e[this.floating?"width":"height"]){return d}else{return r<t+this.helperProportions.width/2&&i-this.helperProportions.width/2<s&&o<n+this.helperProportions.height/2&&a-this.helperProportions.height/2<l}},_intersectsWithPointer:function(t){var i=e.ui.isOverAxis(this.positionAbs.top+this.offset.click.top,t.top,t.height),n=e.ui.isOverAxis(this.positionAbs.left+this.offset.click.left,t.left,t.width),a=i&&n,r=this._getDragVerticalDirection(),s=this._getDragHorizontalDirection();if(!a)return false;return this.floating?s&&s=="right"||r=="down"?2:1:r&&(r=="down"?2:1)},_intersectsWithSides:function(t){var i=e.ui.isOverAxis(this.positionAbs.top+this.offset.click.top,t.top+t.height/2,t.height),n=e.ui.isOverAxis(this.positionAbs.left+this.offset.click.left,t.left+t.width/2,t.width),a=this._getDragVerticalDirection(),r=this._getDragHorizontalDirection();if(this.floating&&r){return r=="right"&&n||r=="left"&&!n}else{return a&&(a=="down"&&i||a=="up"&&!i)}},_getDragVerticalDirection:function(){var e=this.positionAbs.top-this.lastPositionAbs.top;return e!=0&&(e>0?"down":"up")},_getDragHorizontalDirection:function(){var e=this.positionAbs.left-this.lastPositionAbs.left;return e!=0&&(e>0?"right":"left")},refresh:function(e){this._refreshItems(e);this.refreshPositions();return this},_connectWith:function(){var e=this.options;return e.connectWith.constructor==String?[e.connectWith]:e.connectWith},_getItemsAsjQuery:function(t){var i=this;var n=[];var a=[];var r=this._connectWith();if(r&&t){for(var s=r.length-1;s>=0;s--){var o=e(r[s]);for(var l=o.length-1;l>=0;l--){var c=e.data(o[l],"sortable");if(c&&c!=this&&!c.options.disabled){a.push([e.isFunction(c.options.items)?c.options.items.call(c.element):e(c.options.items,c.element).not(".ui-sortable-helper").not(".ui-sortable-placeholder"),c])}}}}a.push([e.isFunction(this.options.items)?this.options.items.call(this.element,null,{options:this.options,item:this.currentItem}):e(this.options.items,this.element).not(".ui-sortable-helper").not(".ui-sortable-placeholder"),this]);for(var s=a.length-1;s>=0;s--){a[s][0].each(function(){n.push(this)})}return e(n)},_removeCurrentsFromItems:function(){var e=this.currentItem.find(":data(sortable-item)");for(var t=0;t<this.items.length;t++){for(var i=0;i<e.length;i++){if(e[i]==this.items[t].item[0])this.items.splice(t,1)}}},_refreshItems:function(t){this.items=[];this.containers=[this];var i=this.items;var n=this;var a=[[e.isFunction(this.options.items)?this.options.items.call(this.element[0],t,{item:this.currentItem}):e(this.options.items,this.element),this]];var r=this._connectWith();if(r){for(var s=r.length-1;s>=0;s--){var o=e(r[s]);for(var l=o.length-1;l>=0;l--){var c=e.data(o[l],"sortable");if(c&&c!=this&&!c.options.disabled){a.push([e.isFunction(c.options.items)?c.options.items.call(c.element[0],t,{item:this.currentItem}):e(c.options.items,c.element),c]);this.containers.push(c)}}}}for(var s=a.length-1;s>=0;s--){var u=a[s][1];var d=a[s][0];for(var l=0,f=d.length;l<f;l++){var h=e(d[l]);h.data("sortable-item",u);i.push({item:h,instance:u,width:0,height:0,left:0,top:0})}}},refreshPositions:function(t){if(this.offsetParent&&this.helper){this.offset.parent=this._getParentOffset()}for(var i=this.items.length-1;i>=0;i--){var n=this.items[i];if(n.instance!=this.currentContainer&&this.currentContainer&&n.item[0]!=this.currentItem[0])continue;var a=this.options.toleranceElement?e(this.options.toleranceElement,n.item):n.item;if(!t){n.width=a.outerWidth();n.height=a.outerHeight()}var r=a.offset();n.left=r.left;n.top=r.top}if(this.options.custom&&this.options.custom.refreshContainers){this.options.custom.refreshContainers.call(this)}else{for(var i=this.containers.length-1;i>=0;i--){var r=this.containers[i].element.offset();this.containers[i].containerCache.left=r.left;this.containers[i].containerCache.top=r.top;this.containers[i].containerCache.width=this.containers[i].element.outerWidth();this.containers[i].containerCache.height=this.containers[i].element.outerHeight()}}return this},_createPlaceholder:function(t){var i=t||this,n=i.options;if(!n.placeholder||n.placeholder.constructor==String){var a=n.placeholder;n.placeholder={element:function(){var t=e(document.createElement(i.currentItem[0].nodeName)).addClass(a||i.currentItem[0].className+" ui-sortable-placeholder").removeClass("ui-sortable-helper")[0];if(!a)t.style.visibility="hidden";return t},update:function(e,t){if(a&&!n.forcePlaceholderSize)return;if(!t.height()){t.height(i.currentItem.innerHeight()-parseInt(i.currentItem.css("paddingTop")||0,10)-parseInt(i.currentItem.css("paddingBottom")||0,10))}if(!t.width()){t.width(i.currentItem.innerWidth()-parseInt(i.currentItem.css("paddingLeft")||0,10)-parseInt(i.currentItem.css("paddingRight")||0,10))}}}}i.placeholder=e(n.placeholder.element.call(i.element,i.currentItem));i.currentItem.after(i.placeholder);n.placeholder.update(i,i.placeholder)},_contactContainers:function(t){var i=null,n=null;for(var a=this.containers.length-1;a>=0;a--){if(e.ui.contains(this.currentItem[0],this.containers[a].element[0]))continue;if(this._intersectsWith(this.containers[a].containerCache)){if(i&&e.ui.contains(this.containers[a].element[0],i.element[0]))continue;i=this.containers[a];n=a}else{if(this.containers[a].containerCache.over){this.containers[a]._trigger("out",t,this._uiHash(this));this.containers[a].containerCache.over=0}}}if(!i)return;if(this.containers.length===1){this.containers[n]._trigger("over",t,this._uiHash(this));this.containers[n].containerCache.over=1}else if(this.currentContainer!=this.containers[n]){var r=1e4;var s=null;var o=this.positionAbs[this.containers[n].floating?"left":"top"];for(var l=this.items.length-1;l>=0;l--){if(!e.ui.contains(this.containers[n].element[0],this.items[l].item[0]))continue;var c=this.items[l][this.containers[n].floating?"left":"top"];if(Math.abs(c-o)<r){r=Math.abs(c-o);s=this.items[l]}}if(!s&&!this.options.dropOnEmpty)return;this.currentContainer=this.containers[n];s?this._rearrange(t,s,null,true):this._rearrange(t,null,this.containers[n].element,true);this._trigger("change",t,this._uiHash());this.containers[n]._trigger("change",t,this._uiHash(this));this.options.placeholder.update(this.currentContainer,this.placeholder);this.containers[n]._trigger("over",t,this._uiHash(this));this.containers[n].containerCache.over=1}},_createHelper:function(t){var i=this.options;var n=e.isFunction(i.helper)?e(i.helper.apply(this.element[0],[t,this.currentItem])):i.helper=="clone"?this.currentItem.clone():this.currentItem;if(!n.parents("body").length)e(i.appendTo!="parent"?i.appendTo:this.currentItem[0].parentNode)[0].appendChild(n[0]);if(n[0]==this.currentItem[0])this._storedCSS={width:this.currentItem[0].style.width,height:this.currentItem[0].style.height,position:this.currentItem.css("position"),top:this.currentItem.css("top"),left:this.currentItem.css("left")};if(n[0].style.width==""||i.forceHelperSize)n.width(this.currentItem.width());if(n[0].style.height==""||i.forceHelperSize)n.height(this.currentItem.height());return n},_adjustOffsetFromHelper:function(t){if(typeof t=="string"){t=t.split(" ")}if(e.isArray(t)){t={left:+t[0],top:+t[1]||0}}if("left"in t){this.offset.click.left=t.left+this.margins.left}if("right"in t){this.offset.click.left=this.helperProportions.width-t.right+this.margins.left}if("top"in t){this.offset.click.top=t.top+this.margins.top}if("bottom"in t){this.offset.click.top=this.helperProportions.height-t.bottom+this.margins.top}},_getParentOffset:function(){this.offsetParent=this.helper.offsetParent();var t=this.offsetParent.offset();if(this.cssPosition=="absolute"&&this.scrollParent[0]!=document&&e.ui.contains(this.scrollParent[0],this.offsetParent[0])){t.left+=this.scrollParent.scrollLeft();t.top+=this.scrollParent.scrollTop()}if(this.offsetParent[0]==document.body||this.offsetParent[0].tagName&&this.offsetParent[0].tagName.toLowerCase()=="html"&&e.browser.msie)t={top:0,left:0};return{top:t.top+(parseInt(this.offsetParent.css("borderTopWidth"),10)||0),left:t.left+(parseInt(this.offsetParent.css("borderLeftWidth"),10)||0)}},_getRelativeOffset:function(){if(this.cssPosition=="relative"){var e=this.currentItem.position();return{top:e.top-(parseInt(this.helper.css("top"),10)||0)+this.scrollParent.scrollTop(),left:e.left-(parseInt(this.helper.css("left"),10)||0)+this.scrollParent.scrollLeft()}}else{return{top:0,left:0}}},_cacheMargins:function(){this.margins={left:parseInt(this.currentItem.css("marginLeft"),10)||0,top:parseInt(this.currentItem.css("marginTop"),10)||0}},_cacheHelperProportions:function(){this.helperProportions={width:this.helper.outerWidth(),height:this.helper.outerHeight()}},_setContainment:function(){var t=this.options;if(t.containment=="parent")t.containment=this.helper[0].parentNode;if(t.containment=="document"||t.containment=="window")this.containment=[0-this.offset.relative.left-this.offset.parent.left,0-this.offset.relative.top-this.offset.parent.top,e(t.containment=="document"?document:window).width()-this.helperProportions.width-this.margins.left,(e(t.containment=="document"?document:window).height()||document.body.parentNode.scrollHeight)-this.helperProportions.height-this.margins.top];if(!/^(document|window|parent)$/.test(t.containment)){var i=e(t.containment)[0];var n=e(t.containment).offset();var a=e(i).css("overflow")!="hidden";this.containment=[n.left+(parseInt(e(i).css("borderLeftWidth"),10)||0)+(parseInt(e(i).css("paddingLeft"),10)||0)-this.margins.left,n.top+(parseInt(e(i).css("borderTopWidth"),10)||0)+(parseInt(e(i).css("paddingTop"),10)||0)-this.margins.top,n.left+(a?Math.max(i.scrollWidth,i.offsetWidth):i.offsetWidth)-(parseInt(e(i).css("borderLeftWidth"),10)||0)-(parseInt(e(i).css("paddingRight"),10)||0)-this.helperProportions.width-this.margins.left,n.top+(a?Math.max(i.scrollHeight,i.offsetHeight):i.offsetHeight)-(parseInt(e(i).css("borderTopWidth"),10)||0)-(parseInt(e(i).css("paddingBottom"),10)||0)-this.helperProportions.height-this.margins.top]}},_convertPositionTo:function(t,i){if(!i)i=this.position;var n=t=="absolute"?1:-1;var a=this.options,r=this.cssPosition=="absolute"&&!(this.scrollParent[0]!=document&&e.ui.contains(this.scrollParent[0],this.offsetParent[0]))?this.offsetParent:this.scrollParent,s=/(html|body)/i.test(r[0].tagName);return{top:i.top+this.offset.relative.top*n+this.offset.parent.top*n-(e.browser.safari&&this.cssPosition=="fixed"?0:(this.cssPosition=="fixed"?-this.scrollParent.scrollTop():s?0:r.scrollTop())*n),left:i.left+this.offset.relative.left*n+this.offset.parent.left*n-(e.browser.safari&&this.cssPosition=="fixed"?0:(this.cssPosition=="fixed"?-this.scrollParent.scrollLeft():s?0:r.scrollLeft())*n)}},_generatePosition:function(t){var i=this.options,n=this.cssPosition=="absolute"&&!(this.scrollParent[0]!=document&&e.ui.contains(this.scrollParent[0],this.offsetParent[0]))?this.offsetParent:this.scrollParent,a=/(html|body)/i.test(n[0].tagName);if(this.cssPosition=="relative"&&!(this.scrollParent[0]!=document&&this.scrollParent[0]!=this.offsetParent[0])){this.offset.relative=this._getRelativeOffset()}var r=t.pageX;var s=t.pageY;if(this.originalPosition){if(this.containment){if(t.pageX-this.offset.click.left<this.containment[0])r=this.containment[0]+this.offset.click.left;if(t.pageY-this.offset.click.top<this.containment[1])s=this.containment[1]+this.offset.click.top;if(t.pageX-this.offset.click.left>this.containment[2])r=this.containment[2]+this.offset.click.left;if(t.pageY-this.offset.click.top>this.containment[3])s=this.containment[3]+this.offset.click.top}if(i.grid){var o=this.originalPageY+Math.round((s-this.originalPageY)/i.grid[1])*i.grid[1];s=this.containment?!(o-this.offset.click.top<this.containment[1]||o-this.offset.click.top>this.containment[3])?o:!(o-this.offset.click.top<this.containment[1])?o-i.grid[1]:o+i.grid[1]:o;var l=this.originalPageX+Math.round((r-this.originalPageX)/i.grid[0])*i.grid[0];r=this.containment?!(l-this.offset.click.left<this.containment[0]||l-this.offset.click.left>this.containment[2])?l:!(l-this.offset.click.left<this.containment[0])?l-i.grid[0]:l+i.grid[0]:l}}return{top:s-this.offset.click.top-this.offset.relative.top-this.offset.parent.top+(e.browser.safari&&this.cssPosition=="fixed"?0:this.cssPosition=="fixed"?-this.scrollParent.scrollTop():a?0:n.scrollTop()),left:r-this.offset.click.left-this.offset.relative.left-this.offset.parent.left+(e.browser.safari&&this.cssPosition=="fixed"?0:this.cssPosition=="fixed"?-this.scrollParent.scrollLeft():a?0:n.scrollLeft())}},_rearrange:function(e,t,i,n){i?i[0].appendChild(this.placeholder[0]):t.item[0].parentNode.insertBefore(this.placeholder[0],this.direction=="down"?t.item[0]:t.item[0].nextSibling);this.counter=this.counter?++this.counter:1;var a=this,r=this.counter;window.setTimeout(function(){if(r==a.counter)a.refreshPositions(!n)},0)},_clear:function(t,i){this.reverting=false;var n=[],a=this;if(!this._noFinalSort&&this.currentItem.parent().length)this.placeholder.before(this.currentItem);this._noFinalSort=null;if(this.helper[0]==this.currentItem[0]){for(var r in this._storedCSS){if(this._storedCSS[r]=="auto"||this._storedCSS[r]=="static")this._storedCSS[r]=""}this.currentItem.css(this._storedCSS).removeClass("ui-sortable-helper")}else{this.currentItem.show()}if(this.fromOutside&&!i)n.push(function(e){this._trigger("receive",e,this._uiHash(this.fromOutside))});if((this.fromOutside||this.domPosition.prev!=this.currentItem.prev().not(".ui-sortable-helper")[0]||this.domPosition.parent!=this.currentItem.parent()[0])&&!i)n.push(function(e){this._trigger("update",e,this._uiHash())});if(!e.ui.contains(this.element[0],this.currentItem[0])){if(!i)n.push(function(e){this._trigger("remove",e,this._uiHash())});for(var r=this.containers.length-1;r>=0;r--){if(e.ui.contains(this.containers[r].element[0],this.currentItem[0])&&!i){n.push(function(e){return function(t){e._trigger("receive",t,this._uiHash(this))}}.call(this,this.containers[r]));n.push(function(e){return function(t){e._trigger("update",t,this._uiHash(this))}}.call(this,this.containers[r]))}}}for(var r=this.containers.length-1;r>=0;r--){if(!i)n.push(function(e){return function(t){e._trigger("deactivate",t,this._uiHash(this))}}.call(this,this.containers[r]));if(this.containers[r].containerCache.over){n.push(function(e){return function(t){e._trigger("out",t,this._uiHash(this))}}.call(this,this.containers[r]));this.containers[r].containerCache.over=0}}if(this._storedCursor)e("body").css("cursor",this._storedCursor);if(this._storedOpacity)this.helper.css("opacity",this._storedOpacity);if(this._storedZIndex)this.helper.css("zIndex",this._storedZIndex=="auto"?"":this._storedZIndex);this.dragging=false;if(this.cancelHelperRemoval){if(!i){this._trigger("beforeStop",t,this._uiHash());for(var r=0;r<n.length;r++){n[r].call(this,t)}this._trigger("stop",t,this._uiHash())}return false}if(!i)this._trigger("beforeStop",t,this._uiHash());this.placeholder[0].parentNode.removeChild(this.placeholder[0]);if(this.helper[0]!=this.currentItem[0])this.helper.remove();this.helper=null;if(!i){for(var r=0;r<n.length;r++){n[r].call(this,t)}this._trigger("stop",t,this._uiHash())}this.fromOutside=false;return true},_trigger:function(){if(e.Widget.prototype._trigger.apply(this,arguments)===false){this.cancel()}},_uiHash:function(t){var i=t||this;return{helper:i.helper,placeholder:i.placeholder||e([]),position:i.position,originalPosition:i.originalPosition,offset:i.positionAbs,item:i.currentItem,sender:t?t.element:null}}});e.extend(e.ui.sortable,{version:"1.8.16"})})(jQuery);var truncate=function(){function e(t,i){var n=t.childNodes;var a="";if(n.length){for(var r=0;r<n.length;r++){a+=e(n[r])}}else{a=t.textContent}if(i){return a.replace(/^\s+|\s+$/g,"")}return a}var t=function(){var e=document.createElement("div");e.innerHTML='<div style="text-overflow: ellipsis"></div>';var t=e.firstChild.style;return"textOverflow"in t||"OTextOverflow"in t}();function i(i,n){n=n||{};if(t&&(!n.dir||n.dir!="v"))return this;var a=n.showTitle||false;var r=n.dir&&n.dir[0]||"h";var s=r=="h"?"scrollWidth":"scrollHeight";var o=r=="h"?"offsetWidth":"offsetHeight";var l=n.truncText||"&hellip;";var c=n.trim||false;var u=n.textEl||i;var d=[" ",""],f,h;var p,m,g;var v=u.getAttribute("data-oldtext")||e(u,c);u.setAttribute("data-oldtext",v);for(var b=0;b<d.length;b++){g=d[b];p=v.split(g);m=p.length;h=false;if(u.getAttribute("data-oldtext")){u.innerHTML=v}if(i[s]-i[o]<1){i.removeAttribute("data-truncated",null);break}var y=Math.ceil(p.length/2),_=0,w;for(f=0;f<15;f++){u.innerHTML=p.slice(0,m).join(g)+l;w=i[s]-i[o];if(m<1){break}else if(w<2&&y==_){if(r==="h"||g===""&&i.scrollWidth<i.offsetWidth){h=true;i.setAttribute("data-truncated",true);break}}else if(w>1){m-=y}else{m+=y}_=y;y=Math.ceil(y/2)}if(h)break}if(a&&v!=e(u,c)){u.setAttribute("title",v)}}return i}();$.fn.truncate=function(e){this.each(function(){truncate(this,e)});return this};$.fn.untruncate=function(){this.each(function(){var e=$(this),t=e.attr("oldtext");if(t){e.text(t)}});return this};$.fn.lineclamp=function(e){if(!e){return this}return this.each(function(){var t=$(this),i=t.css("line-height");if(typeof i=="string"&&i.substr(-2)=="px"){i=parseFloat(i.replace("px",""));var n=Math.ceil(i)*e,a;if(this.scrollHeight-n>2){t.css({height:n+2,overflow:"hidden","text-overflow":"ellipsis"});t.truncate({dir:"v"})}else{t.css({"max-height":n,overflow:"hidden","text-overflow":"ellipsis"})}}})};$.fn.linefit=function(e){var t=7;e=e||1;return this.each(function(){var i=$(this),n=parseFloat(i.css("font-size").replace("px","")),a=Math.ceil(parseFloat(i.css("line-height").replace("px","")))*e,r=i.height();while(r>a&&n>t){n-=.5;i.css("font-size",n);r=i.height()}})};function objEqual(e,t){return JSON.stringify(e)==JSON.stringify(t)}z._AjaxCache={};z.AjaxCache=function(){return function(e){if(z._AjaxCache[e]===undefined){z._AjaxCache[e]={previous:{args:"",data:""},items:{}}}return z._AjaxCache[e]}}();(function(e){e.ajaxCache=function(t){t=e.extend({url:"",type:"get",data:{},newItems:e.noop,cacheSuccess:e.noop,ajaxSuccess:e.noop,ajaxFailure:e.noop},t);if(!z.capabilities.JSON||parseFloat(jQuery.fn.jquery)<1.5){return e.ajax({url:t.url,type:t.method,data:t.data,success:function(e){t.newItems(e,e);t.ajaxSuccess(e,r)},errors:function(e){t.ajaxFailure(e)}})}var i=z.AjaxCache(t.url+":"+t.type),n=JSON.stringify(t.data),a=JSON.stringify(i.previous.args),r,s;if(n!=a){if(!!i.items[n]){r=i.items[n];if(t.newItems){t.newItems(null,r)}if(t.cacheSuccess){t.cacheSuccess(null,r)}}else{s=e.ajax({url:t.url,type:t.method,data:t.data});s.done(function(e){var a;if(!objEqual(e,i.previous.data)){a=e}t.newItems(e,a);t.ajaxSuccess(e,a);i.items[n]=e;i.previous.data=e;i.previous.args=n});if(t.failure){s.fail(function(e){t.ajaxFailure(e)})}}}return s}})(jQuery);$(document).ajaxSend(function(e,t,i){var n,a;if(!/^((https?:)|:?[/]{2})/.test(i.url)){a=$("meta[name=csrf]");if(!z.anonymous&&a.length){n=a.attr("content")}else{n=$("input[name='csrfmiddlewaretoken']").val()}if(n){t.setRequestHeader("X-CSRFToken",n)}}}).ajaxSuccess(function(e,t,i){$(window).trigger("resize")});z.uid=0;jQuery.fn.tooltip=function(e){var t=$(e),i=$("span",t),n=this,a=false,r,s,o;function l(){if(!r)return;var e=r.offset(),n=s.attr("title"),l=s.attr("data-tooltip-html");o=s.is("[data-delay]")?s.attr("data-delay"):300;if(!l&&n.indexOf("::")>0){var c=n.split("::");i.text("");i.append($("<strong>",{text:c[0].trim()}));i.append($("<span>",{text:c[1].trim()}))}else{i[l?"html":"text"](n)}s.attr("data-oldtitle",n).attr("title","");var u=t.outerWidth(false)/2,d=t.outerHeight(false),f=e.left+r.innerWidth()/2-u-1,h=e.top-r.innerHeight()-d-2;a=setTimeout(function(){t.css({left:f+"px",top:h+"px"}).show()},o)}$(document.body).bind("tooltip_change",l);function c(e){r=$(this);if(r.hasClass("formerror"))t.addClass("error");
s=r.attr("title")?r:$("[title]",r).first();if(s.length){l()}}function u(e){clearTimeout(a);t.hide().removeClass("error");if(s&&s.length){r=$(this);s.attr("title",s.attr("data-oldtitle")).attr("data-oldtitle","")}}if(parseFloat(jQuery.fn.jquery)<1.7){n.live("mouseover",c).live("mouseout",u)}else{n.on("mouseover",c).on("mouseout",u)}};$(document).ready(function(){$(".tooltip").tooltip("#tooltip")});function makeBlurHideCallback(e){var t=function(t){_root=e.get(0);if(t){if(t.type=="click"&&_root==t.target||_.indexOf($(t.target).parents(),_root)!=-1){return}}e.hideMe();if(e.o.emptyme){e.empty()}if(e.o.deleteme){e.remove()}};return t}$.fn.popup=function(e,t){t=t||{};var i=$(e),n=this,a=z.uid++,r=0;n.o=$.extend({delegate:false,callback:false,container:false,hideme:true,emptyme:false,pointTo:false,offset:{},width:300},t);n.setWidth=function(e){n.css({width:e});return n};n.setPos=function(e,t){t=t||n.o.offset;e=e||n.o.pointTo;if(!e)return false;n.detach().appendTo("body");var i=$(e),a=i.offset(),r=i.outerWidth(false)/2,s=i.outerHeight(false),o=a.left+r>$("body").outerWidth(false)/2,l=o?n.outerWidth(false)-84:63,c=a.left+(t.x||r)-l,u=a.top+(t.y||s)+4;n.removeClass("left");if(o)n.addClass("left");n.css({left:c,top:u,right:"inherit",bottom:"inherit"});n.o.pointTo=e;return n};n.hideMe=function(){n.hide();n.unbind();n.undelegate();$(document.body).unbind("click."+a,n.hider);return n};function s(e){e.preventDefault();r=e.timeStamp;var i=t.callback?t.callback.call(n,{click_target:this,evt:e}):true;n.o=$.extend({click_target:this},n.o,i);if(i){n.render()}}n.render=function(){var e=n.o,t=makeBlurHideCallback(n);n.hider=function(e){if(e.timeStamp!=r){t.call(this,e)}};if(e.hideme){setTimeout(function(){$(document.body).bind("click."+a,n.hider)},0)}n.delegate(".close","click",function(e){e.preventDefault();n.hideMe()});i.trigger("popup_show",[n]);if(e.container&&e.container.length)n.detach().appendTo(e.container);if(e.pointTo){n.setPos(e.pointTo)}setTimeout(function(){n.show()},0);return n};if(n.o.delegate){$(n.o.delegate).delegate(e,"click",s)}else{i.click(s)}n.setWidth(n.o.width);return n};$.fn.modal=function(e,t){t=t||{};var i=$(e),n=this;n.o=$.extend({delegate:false,callback:false,onresize:function(){n.setPos()},hideme:true,emptyme:false,deleteme:false,offset:{},width:450},t);n.setWidth=function(e){n.css({width:e});return n};n.setPos=function(e){e=e||n.o.offset;n.detach().appendTo("body");var t=($(window).width()-n.outerWidth(false))/2,i=$(window).scrollTop()+26;n.css({left:t,top:i+"px",right:"inherit",bottom:"inherit",position:"absolute"});return n};n.hideMe=function(){var e=n.o;n.hide();n.unbind();n.undelegate();$(document.body).unbind("click newmodal",n.hider);$(window).unbind("keydown.lightboxDismiss");$(window).bind("resize",e.onresize);$(".modal-overlay").remove();return n};function a(e){e.preventDefault();var i=t.callback?t.callback.call(n,{click_target:this,evt:e})!==false:true;n.o=$.extend({click_target:this},n.o,i);if(i){$(".modal").trigger("close");n.render()}}n.render=function(){var e=n.o;n.hider=makeBlurHideCallback(n);if(e.hideme){try{setTimeout(function(){$(".modal-overlay, .close").bind("click modal",n.hider)},0)}catch(t){if(typeof console!=="undefined"){console.error("Could not close modal:",t)}}}if(e.close){var a=$("<a>",{"class":"close",text:"X"});n.append(a)}$(".popup").hide();n.delegate(".close","click",function(e){e.preventDefault();n.trigger("close")});n.bind("close",function(t){if(e.emptyme){n.empty()}if(e.deleteme){n.remove()}t.preventDefault();n.hideMe()});i.trigger("modal_show",[n]);if(e.container&&e.container.length)n.detach().appendTo(e.container);$('<div class="modal-overlay"></div>').appendTo("body");n.setPos();setTimeout(function(){n.show()},0);$(window).bind("resize",e.onresize).bind("keydown.lightboxDismiss",function(e){if(e.which==27){n.hideMe()}});return n};if(n.o.delegate){$(n.o.delegate).delegate(e,"click",a)}else{i.click(a)}n.setWidth(n.o.width);return n};function modalFromURL(e,t){var i=$("<a>"),n={deleteme:true,close:true},t=t||{},a=t["data"]||{},r=t["callback"];delete t["callback"];t=$.extend(n,t);var s=$("<div>",{"class":"modal-inside",text:gettext("Loading...")}),o=$("<div>",{"class":"modal"}).modal(i,t);o.append(s);i.trigger("click");$.get(e,a,function(e){o.appendTo("body");s.html("").append(e);if(r){r.call(o)}});return o}function load_unicode(){var e=$(document.body);e.append("<script src='"+e.attr("data-media-url")+"/js/zamboni/unicode.js'></script>")}function makeslug(e,t){if(!e)return"";var i=new RegExp("[^\\w"+z.unicode_letters+"\\s-]+","g");e=$.trim(e.replace(i," "));e=e.replace(/[-\s]+/g,t||"-").toLowerCase();return e}function show_slug_edit(e){$("#slug_readonly").hide();$("#slug_edit").show();$("#id_slug").focus();e.preventDefault()}function slugify(){if(z==null||z.unicode_letters){var e=$("#id_slug");url_customized=e.attr("data-customized")==0||!e.attr("data-customized");if(url_customized||!e.val()){var t=makeslug($("#id_name").val());e.val(t);name_val=t;$("#slug_value").text(t)}else{$("#slug_value").text($("#id_slug").val())}}else{load_unicode()}}function initCharCount(){var e=function(e,t){var i=$(e),n=i.val(),a=parseInt(t.attr("data-maxlength"),10),r=n.split("\n").length-1,s=a-n.length-r;t.html(format(ngettext("<b>{0}</b> character left.","<b>{0}</b> characters left.",s),[s])).toggleClass("error",s<0)};$(".char-count").each(function(){var t=$(this),i=$(this).closest("form"),n;if(t.attr("data-for-startswith")!==undefined){n=$('textarea[id^="'+t.attr("data-for-startswith")+'"]:visible',i)}else{n=$("textarea#"+t.attr("data-for"),i)}n.bind("keyup blur",function(){e(this,t)}).trigger("blur")})}(function(){var e=typeof FormData!="undefined";z.FormData=function(){this.fields={};this.xhr=new XMLHttpRequest;this.boundary="z"+(new Date).getTime()+""+Math.floor(Math.random()*1e7);if(e){this.formData=new FormData}else{this.output=""}this.append=function(t,i){if(e){this.formData.append(t,i)}else{if(typeof i=="object"&&"fileName"in i){this.output+="--"+this.boundary+"\r\n";this.output+='Content-Disposition: form-data; name="'+t.replace(/[^\w]/g,"")+'";';this.output+=' filename="'+unescape(encodeURIComponent(i.fileName))+'";\r\n';this.output+="Content-Type: "+i.type;this.output+="\r\n\r\n";this.output+=i.getAsBinary();this.output+="\r\n"}else{this.output+="--"+this.boundary+"\r\n";this.output+='Content-Disposition: form-data; name="'+t+'";';this.output+="\r\n\r\n";this.output+=""+i;this.output+="\r\n"}}};this.open=function(e,t,i,n,a){this.xhr.open(e,t,i,n,a)};this.send=function(){if(e){this.xhr.send(this.formData)}else{content_type="multipart/form-data;boundary="+this.boundary;this.xhr.setRequestHeader("Content-Type",content_type);this.output+="--"+this.boundary+"--";this.xhr.sendAsBinary(this.output)}}}})();$.fn.exists=function(e,t){var i=$(this),n=i.length;if(n&&e){e.apply(null,t)}return n>0};$(document).delegate(".mobile-link","click",function(){$.cookie("mamo","on",{expires:30,path:"/"});window.location.reload()});(function(e){"use strict";var t=window.performance||window.msPerformance||window.webkitPerformance||window.mozPerformance;var i=function(e){if(z.capabilities.performance){var t=$("body").attr("data-collect-timings");if(t){t=t.split(":",2);e.client="stick";if(Math.random()<parseFloat(t[1])){$.post(t[0],e)}}}};e.basic=function(){if(z.capabilities.performance){setTimeout(function(){i({"window.performance.timing.navigationStart":t.timing.navigationStart,"window.performance.timing.domComplete":t.timing.domComplete,"window.performance.timing.domInteractive":t.timing.domInteractive,"window.performance.timing.domLoading":t.timing.domLoading,"window.performance.timing.loadEventEnd":t.timing.loadEventEnd,"window.performance.timing.responseStart":t.timing.responseStart,"window.performance.navigation.redirectCount":t.navigation.redirectCount,"window.performance.navigation.type":t.navigation.type})},1e3)}};e.custom=function(e){e["window.performance.timing.navigationStart"]=0;i(e)}})(typeof exports==="undefined"?this.stick={}:exports);$(".island .listing-grid").bind("grid.init",function(e,t){var i=t.self,n=t.maxPage;if(n>0){var a=$('<nav class="pager">');a.append('<a href="#" class="prev">&laquo;</a>');for(var r=0;r<=n;r++){a.append('<a href="#" class="'+(r==0?"selected ":"")+'dot"><b></b></a>')}a.append('<a href="#" class="next">&raquo;</a>');i.parent().prepend(a);a.delegate("a","click",function(e){e.preventDefault();var t=$(this);if(t.hasClass("dot")){i.go(t.index()-1)}else if(t.hasClass("prev")){i.prevPage()}else if(t.hasClass("next")){i.nextPage()}});i.bind("grid.update",function(e,t){a.find(".dot").removeClass("selected").eq(t.current).addClass("selected")})}});z.visitor=z.Storage("visitor");(function(){if(!z.visitor.get("seen_badbrowser_warning")&&$("body").hasClass("badbrowser")){$("#site-nonfx").show()}})();function hoverTruncate(e){var t=$(e);if(t.hasClass("hovercard")){t=t.parent()}t.find(".hovercard h3").truncate();t.delegate(".hovercard","mouseover",function(){var e=$(this);setTimeout(function(){e.find("h3").untruncate()},100)}).delegate(".hovercard","mouseout",function(){var e=$(this);setTimeout(function(){e.find("h3").truncate()},100)})}function listing_grid(){var e=$(this),t=e.find("section"),i=0,n=t.length-1;e.trigger("grid.init",{self:e,current:i,maxPage:n});e.go=function(a){if(a!=i){a=a<0?0:a>n?n:a;i=a;t.hide().eq(a).show().find(".hovercard h3").truncate();e.trigger("grid.update",{self:e,current:i,maxPage:n})}};e.prevPage=function(){e.go(i-1)};e.nextPage=function(){e.go(i+1)};hoverTruncate(this);e.css({width:e.width()+"px",height:e.height()+"px"});return e}$(function(){"use strict";initBanners();$(".listing-grid").each(listing_grid);$(".hovercard").each(function(){hoverTruncate(this)});$("img[data-defer-src]").each(function(){var e=$(this);e.attr("src",e.attr("data-defer-src"))});$("span.emaillink").each(function(){var e=$(this);e.find(".i").remove();var t=e.text().split("").reverse().join("");e.prev("a").attr("href","mailto:"+t)});$("#page").delegate(".expando .toggle","click",_pd(function(){$(this).closest(".expando").toggleClass("expanded")}));$("#page").delegate(".scrollto","click",function(e){e.preventDefault();var t=$(this).attr("href"),i=$(t.match(/#.*$/)[0]);if(i.hasClass("expando")){i.addClass("expanded")}var n=i.offset().top-15;$(document.documentElement).animate({scrollTop:n},500)});contributions.init();$("select[name='rating']").ratingwidget()});function initBanners(e){var t=$(e||document.body);if(!z.visitor.get("seen_impala_first_visit")){$("body").addClass("firstvisit");z.visitor.set("seen_impala_first_visit",1)}if(!z.visitor.get("seen_acr_pitch")&&$("body").hasClass("acr-pitch")){t.find("#acr-pitch").show()}if(z.browser.firefox&&!z.visitor.get("seen_appruntime_pitch")&&!z.capabilities.app_runtime){t.find("#appruntime-pitch").show()}t.delegate(".site-balloon .close, .site-tip .close","click",_pd(function(){var e=$(this).closest(".site-balloon, .site-tip");e.fadeOut();if(e.is("#site-nonfx")){z.visitor.set("seen_badbrowser_warning",1)}else if(e.is("#acr-pitch")){z.visitor.set("seen_acr_pitch",1)}else if(e.is("#appruntime-pitch")){z.visitor.set("seen_appruntime_pitch",1)}}))}$(function(){$("form.ajax-submit, .ajax-submit form").live("submit",function(){var e=$(this),t=e.is(".ajax-submit")?e:e.closest(".ajax-submit"),i=e.serializeArray();e.find(".submit, button[type=submit], submit").attr("disabled",true).addClass("loading-submit");$.post(e.attr("action"),i,function(e){var i=$(e);t.replaceWith(i);i.trigger("ajax-submit-loaded");i.find(".ajax-submit").trigger("ajax-submit-loaded")});return false})});$(function(){"use strict";$(document).ready(function(){stick.basic()})});$.fn.ratingwidget=function(e){this.each(function(t,i){if(!e){e=""}var n=$(i),a="ratingwidget stars stars-0 "+e,r=$('<span class="'+a+'"></span>'),s="",o=function(e){r.removeClass("stars-0 stars-1 stars-2 stars-3 stars-4 stars-5").addClass("stars-"+e)},l=function(e){if(c==e)return;var t=r.find(format('[value="{0}"]',e));t.click();o(e);c=e},c=null;if($("option[selected]",n).length){var u=n.val();l(u);c=parseInt(u,10)}for(var d=1;d<=5;d++){var f=c===d?" checked":"";s+=format('<label data-stars="{0}">{1}<input type="radio" name="rating"{2} value="{3}"></label>',[d,format(ngettext("{0} star","{0} stars",d),[d]),f,d])}r.click(function(e){var t=$(e.target);if(t.is("input[type=radio]")){o(c=t.attr("value"));if(!t.val()){t.attr("checked",true)}}}).mouseover(function(e){var t=$(e.target);if(t.attr("data-stars")){o(t.attr("data-stars"))}}).mouseout(function(e){o(c||0)}).bind("touchmove touchend",function(e){var t=r.width();var i=r.offset().left;var n=(e.originalEvent.touches[0].clientX-i)/t*5+1;n=~~Math.min(Math.max(n,1),5);l(n)});r.html(s);n.before(r).detach()});return this};(function(e){e.fn.jqm=function(n){var a={overlay:50,overlayClass:"jqmOverlay",closeClass:"jqmClose",trigger:".jqModal",ajax:r,ajaxText:"",target:r,modal:r,toTop:r,onShow:r,onHide:r,onLoad:r};return this.each(function(){if(this._jqm)return i[this._jqm].c=e.extend({},i[this._jqm].c,n);t++;this._jqm=t;i[t]={c:e.extend(a,e.jqm.params,n),a:r,w:e(this).addClass("jqmID"+t),s:t};if(a.trigger)e(this).jqmAddTrigger(a.trigger)})};e.fn.jqmAddClose=function(e){return d(this,e,"jqmHide")};e.fn.jqmAddTrigger=function(e){return d(this,e,"jqmShow")};e.fn.jqmShow=function(t){return this.each(function(){t=t||window.event;e.jqm.open(this._jqm,t)})};e.fn.jqmHide=function(t){return this.each(function(){t=t||window.event;e.jqm.close(this._jqm,t)})};e.jqm={hash:{},open:function(t,s){var l=i[t],u=l.c,d="."+u.closeClass,f=parseInt(l.w.css("z-index")),f=f>0?f:3e3,h=e("<div></div>").css({height:"100%",width:"100%",position:"fixed",left:0,top:0,"z-index":f-1,opacity:u.overlay/100});if(l.a)return r;l.t=s;l.a=true;l.w.css("z-index",f);if(u.modal){if(!n[0])c("bind");n.push(t)}else if(u.overlay>0)l.w.jqmAddClose(h);else h=r;l.o=h?h.addClass(u.overlayClass).prependTo("body"):r;if(a){e("html,body").css({height:"100%",width:"100%"});if(h){h=h.css({position:"absolute"})[0];for(var p in{Top:1,Left:1})h.style.setExpression(p.toLowerCase(),"(_=(document.documentElement.scroll"+p+" || document.body.scroll"+p+"))+'px'")}}if(u.ajax){var m=u.target||l.w,g=u.ajax,m=typeof m=="string"?e(m,l.w):e(m),g=g.substr(0,1)=="@"?e(s).attr(g.substring(1)):g;m.html(u.ajaxText).load(g,function(){if(u.onLoad)u.onLoad.call(this,l);if(d)l.w.jqmAddClose(e(d,l.w));o(l)})}else if(d)l.w.jqmAddClose(e(d,l.w));if(u.toTop&&l.o)l.w.before('<span id="jqmP'+l.w[0]._jqm+'"></span>').insertAfter(l.o);u.onShow?u.onShow(l):l.w.show();o(l);return r},close:function(t){var a=i[t];if(!a.a)return r;a.a=r;if(n[0]){n.pop();if(!n[0])c("unbind")}if(a.c.toTop&&a.o)e("#jqmP"+a.w[0]._jqm).after(a.w).remove();if(a.c.onHide)a.c.onHide(a);else{a.w.hide();if(a.o)a.o.remove()}return r},params:{}};var t=0,i=e.jqm.hash,n=[],a=e.browser.msie&&e.browser.version=="6.0",r=false,s=e('<iframe src="javascript:false;document.write(\'\');" class="jqm"></iframe>').css({opacity:0}),o=function(t){if(a)if(t.o)t.o.html('<p style="width:100%;height:100%"/>').prepend(s);else if(!e("iframe.jqm",t.w)[0])t.w.prepend(s);l(t)},l=function(t){try{e(":input:visible",t.w)[0].focus()}catch(i){}},c=function(t){e()[t]("keypress",u)[t]("keydown",u)[t]("mousedown",u)},u=function(t){var a=i[n[n.length-1]],r=!e(t.target).parents(".jqmID"+a.s)[0];if(r)l(a);return!r},d=function(t,n,a){return t.each(function(){var t=this._jqm;e(n).each(function(){if(!this[a]){this[a]=[];e(this).click(function(){for(var e in{jqmShow:1,jqmHide:1})for(var t in this[e])if(i[this[e][t]])i[this[e][t]].w[e](this);return r})}this[a].push(t)})})}})(jQuery);(function(){var e=$("body").attr("data-default-locale");if(e){$(format(".trans>:not([lang='{0}'])",e)).hide();$(format(".trans [lang='{0}']",e)).show()}})();$(document).ready(function(){if(!$("#l10n-menu").length)return;var e=[],t=$("body").attr("data-default-locale"),i=t,n=$("#modal-l10n-unsaved .msg").html(),a=$("#modal-l10n-unsaved").modal(),r=$("#modal-l10n-rm .msg").html(),s=$("#modal-l10n-rm").modal(),o=$(".modal-actions",a),l={};$(".primary").delegate(".trans input, .trans textarea","change keyup paste blur",d);$("form").submit(function(){$(this).find(".trans .cloned").remove()});function c(e){e.find(".trans input[lang], .trans textarea[lang]").each(function(){var e=$(this),t=e.closest(".trans"),i=t.attr("data-name")+"_"+e.attr("lang");l[i]=e.val()})}function u(){g();$el=$("#existing_locales").empty();$("#all_locales li").show();$.each(_.without(e,t),function(){var e=$(format("#all_locales a[href$='{0}']",[this])).parent();if(e.length){$el.append(format("<li><a title='{msg}'class='remove' href='#'>x</a>{row}</li>",{msg:gettext("Remove this localization"),row:e.html()}));e.hide()}})}function d(e,i){var n=e.originalEvent?$(this):$(format("[lang='{0}']",[e]),i),a=n.closest(".trans"),r=e.originalEvent?n.attr("lang"):e,s=$(format("[lang='{0}']",[t]),a),o=a.attr("data-name")+"_"+r;if(n.length==0||n.is("span")){return}if(!(o in l)){l[o]=n.val()}if(r!=t){if(n.val()==s.val()&&n.val().trim().length){n.addClass("cloned")}else if(!n.val().trim().length){if(e.originalEvent&&e.type=="focusout"){n.val(s.val()).addClass("cloned")}else{n.removeClass("cloned")}}else{n.removeClass("cloned")}}if(l[o]!=n.val()){n.addClass("unsaved")}else{n.removeClass("unsaved")}}$(".primary").delegate(".errorlist .l10n","click",h);$("#all_locales").delegate("a","switch",h);var f=t;if($("#l10n-menu:visible").length){f=$.cookie("current_locale")}$(format("#all_locales a[href$='{0}']",[f])).trigger("switch");function h(e){e.preventDefault();$tgt=$(this);var t=$tgt.attr("data-lang")||$tgt.attr("href").substring(1);var r=$("form .trans .unsaved");if(r.length&&t!=i){a.children(".msg").html(format(n,[$("#change-locale").text()]));a.render();$("#l10n-save-changes").unbind().click(function(){var e=$("form:has(.trans .unsaved)");var n=e.length;var r=0;o.addClass("ajax-loading");o.find("button").addClass("disabled");e.each(function(){var e=$(this);$.ajax({url:e.attr("action"),type:"post",data:e.serialize(),error:function(){o.removeClass("ajax-loading")},success:function(s){var l=$(s);if(e.attr("id")&&l.find("#"+e.attr("id")).length){l=l.find("#"+e.attr("id"))}annotateLocalizedErrors(l);n--;if(l.find(".errorlist").length){e.html(l.html());m();if(l.find(format(".errorlist li[data-lang='{0}']",i)).length){r++}}else{c(e);e.find(".unsaved").removeClass("unsaved");e.find(".errorlist").remove()}if(n<1){if(r){window.scrollTo(0,$(".errorlist .l10n").closest("form").offset().top);$(".errorlist").first().siblings(".trans").find("input:visible, textarea:visible").focus()}else{m(t)}}o.removeClass("ajax-loading");o.find("button").removeClass("disabled");a.hideMe()}})})});$("#l10n-discard-changes").click(function(){$(".trans .unsaved").remove();m(t);a.hideMe()});$("#l10n-cancel-changes").click(function(){a.hideMe()})}else{m(t)}if(p){p.hideMe()}}var p=$("#locale-popup").popup("#change-locale",{pointTo:"#change-locale",width:200,callback:function(){u();$("#locale-popup").delegate("a:not(.remove)","click",h);$("#locale-popup").delegate("a.remove","click",function(e){e.preventDefault();e.stopPropagation();var n=$(this).closest("li").find("a:not(.remove)").attr("href").substring(1);s.children(".msg").html(format(r,n));s.render();$("#l10n-cancel-rm").unbind().click(s.hideMe);function a(){$(".modal-actions",s).removeClass("ajax-loading");s.hideMe()}$("#l10n-confirm-rm").unbind().click(function(e){$(".modal-actions",s).addClass("ajax-loading");$.ajax({url:$("#l10n-menu").attr("data-rm-locale"),type:"post",data:{locale:n},error:function(){a()},success:function(){if(i==n){m(t)}$(".trans [lang="+n+"]").remove();a()}})})});return true}});function m(n){n=n||i;if(i!=n){i=n}if(!_.include(e,n)){e.push(n)}var a=$(format("#locale-popup [href$='{0}']",[n])).first().clone();a.find("em").remove();$("#change-locale").text(a.text());$(".trans").each(function(){var e=$(this),i=e.attr("data-name"),a=$(format("label[data-for='{0}']",[i]));if(!e.find(format("[lang='{0}']",[n])).length){if(e.children(".trans-init").length){var r=e.children(".trans-init").clone();r.attr({"class":"",lang:n,id:format("id_{0}_{1}",i,n),name:[i,n].join("_"),value:e.find(format("[lang='{0}']",[t])).val()});if(n!=t)r.addClass("cloned")}else{var r=e.find(format("[lang='{0}']",t)).clone();r.attr({"class":"cloned",lang:n})}e.append(r)}d(n,e);if(a.length){a.children(".locale").remove();a.append(format("<span class='locale'>{0}</span>",[$("#change-locale").text()]));label_for=e.children(format("[lang='{0}']",[n])).attr("id");a.attr("for",label_for)}});$(format(".trans>:not([lang='{0}'])",i)).hide();$(format(".trans [lang='{0}']",i)).show();initCharCount();if($.cookie("current_locale")!=i&&i!=t){$.cookie("current_locale",null);$.cookie("current_locale",i,{expires:0})}}function g(t){var i={};$(".trans [lang]").each(function(){i[$(this).attr("lang")]=true});e=_.keys(i)}z.refreshL10n=function(e){m(e)};m()});function annotateLocalizedErrors(e){e.find(".errorlist li[data-lang]:not(.l10n)").each(function(){var e=$(this),t=e.text(),i=$(format("#locale-popup [href$='{0}']",[e.attr("data-lang")])).first().text();e.text(format("{0}: ",[i])+t).addClass("l10n")})}function loc(e){return e}function clearErrors(e){$(".errorlist",e).remove();$(".error",e).removeClass("error")}function populateErrors(e,t){clearErrors(e);var i=$('<ul class="errorlist"></ul>');$.each(t,function(t,n){var a=$("[name="+t+"]",e).closest(".row");a.addClass("error");a.append(i.append($(format("<li>{0}</li>",n))))})}function fieldFocused(e){var t=/input|keygen|meter|option|output|progress|select|textarea/i;return t.test(e.target.nodeName)}function postUnsaved(e){$('input[name="unsaved_data"]').val(JSON.stringify(e))}function loadUnsaved(){return JSON.parse($('input[name="unsaved_data"]').val()||"{}")}function initPromos(e,t,i,n){if(!e){e=$(document.body)}var a=$("#promos[data-promo-url]",e);if(!a.length){return}var r=a.attr("data-promo-url");if(!i){i=z.browserVersion}if(!n){n=z.platform}if(z.badBrowser&&!i&&!n){i="5.0";n="mac"}var s={};if(t!="discovery"){s={version:i,platform:n}}$.get(r,s,function(e){$(".slider",a).append($(e));if($(".panel",a).length){a.trigger("promos_shown",[a]);$(".persona-preview",a).previewPersona(true)}})}$.fn.promoPager=function(){$.each(this,function(t,i){var n=$(".dot",i);n.click(_pd(function(t){$(".selected",i).removeClass("selected");e(i,n,n.index(t.target))}))});function e(e,t,i){var n=-271*i+"px";t.eq(i).addClass("selected");$(e).siblings(".pages").css("top",n)}};(function(){$(document).delegate("#holiday .addons a","click",function(){dcsMultiTrack("DCS.dcssip","addons.mozilla.org","DCS.dcsuri",location.pathname,"WT.ti","Link: "+$("h3",this).text(),"WT.dl",99,"WT.z_convert","HolidayShopping")})})();(function(){$(".toplist .name").truncate({showTitle:true});initPromos();$(document).bind("promos_shown",function(e,t){hideHomePromo();t.slideDown("slow").append('<a href="#" class="control prev">&laquo;</a>                        <a href="#" class="control next">&raquo;</a>');$("div",t).zCarousel({circular:true,btnPrev:$(".prev",t),btnNext:$(".next",t)});$(".pager",t).promoPager();$(".addons h3",t).truncate({dir:"h"});$(".addons .desc",t).truncate({dir:"v"});$(".install",t).installButton();var i=$(".disabled, .concealed",t);if(i.length){i.closest(".wrap").addClass("hide-install")}$("#monthly .blurb > p").lineclamp(4);$(".ryff .desc").lineclamp(6);$("h2:not(.multiline)",t).linefit()})})();function hideHomePromo(e){if(typeof e==="undefined"){e=$(document.body)}if(!$("#promos",e).length){return}var t="amo_home_promo_seen",i=5,n=z.Storage("visitor"),a=parseInt(n.get(t)||0,10);if(a>=i){$("#starter",e).closest(".panel").remove()}else{n.set(t,a+1)}}(function(e){e.fn.lightBox=function(t){t=jQuery.extend({overlayBgColor:"#000",overlayOpacity:.8,imageLoading:"images/lightbox-ico-loading.gif",imageBtnPrev:"images/lightbox-btn-prev.gif",imageBtnNext:"images/lightbox-btn-next.gif",imageBtnClose:"images/lightbox-btn-close.gif",imageBlank:"images/lightbox-blank.gif",containerBorderSize:10,containerResizeSpeed:400,txtImage:"Image",txtOf:"of",keyToClose:"c",keyToPrev:"p",keyToNext:"n",imageArray:[],activeImage:0},t);var i=this;function n(){a(this,i);return false}function a(i,n){e("embed, object, select").css({visibility:"hidden"});r();t.imageArray.length=0;t.activeImage=0;if(n.length==1){t.imageArray.push(new Array(i.getAttribute("href"),i.getAttribute("title")))}else{for(var a=0;a<n.length;a++){t.imageArray.push(new Array(n[a].getAttribute("href"),n[a].getAttribute("title")))}}while(t.imageArray[t.activeImage][0]!=i.getAttribute("href")){t.activeImage++}s()}function r(){e("body").append('<div id="jquery-overlay"></div><div id="jquery-lightbox"><div id="lightbox-container-image-box"><div id="lightbox-container-image"><img id="lightbox-image"><div style="" id="lightbox-nav"><a href="#" id="lightbox-nav-btnPrev"></a><a href="#" id="lightbox-nav-btnNext"></a></div><div id="lightbox-loading"><a href="#" id="lightbox-loading-link"><img src="'+t.imageLoading+'"></a></div></div></div><div id="lightbox-container-image-data-box"><div id="lightbox-container-image-data"><div id="lightbox-image-details"><span id="lightbox-image-details-caption"></span><span id="lightbox-image-details-currentNumber"></span></div><div id="lightbox-secNav"><a href="#" id="lightbox-secNav-btnClose"><img src="'+t.imageBtnClose+'"></a></div></div></div></div>');var i=g();e("#jquery-overlay").css({backgroundColor:t.overlayBgColor,opacity:t.overlayOpacity,width:i[0],height:i[1]}).fadeIn();var n=v();e("#jquery-lightbox").css({top:n[1]+i[3]/10,left:n[0]}).show();e("#jquery-overlay,#jquery-lightbox").click(function(){m()});e("#lightbox-loading-link,#lightbox-secNav-btnClose").click(function(){m();return false});e(window).resize(function(){var t=g();e("#jquery-overlay").css({width:t[0],height:t[1]});var i=v();e("#jquery-lightbox").css({top:i[1]+t[3]/10,left:i[0]})})}function s(){e("#lightbox-loading").show();e("#lightbox-image,#lightbox-nav,#lightbox-nav-btnPrev,#lightbox-nav-btnNext,#lightbox-container-image-data-box,#lightbox-image-details-currentNumber").hide();var i=new Image;i.onload=function(){e("#lightbox-image").attr("src",t.imageArray[t.activeImage][0]);o(i.width,i.height);i.onload=function(){}};i.src=t.imageArray[t.activeImage][0]}function o(i,n){var a=e("#lightbox-container-image-box").width();var r=e("#lightbox-container-image-box").height();var s=i+t.containerBorderSize*2;var o=n+t.containerBorderSize*2;var c=a-s;var u=r-o;e("#lightbox-container-image-box").animate({width:s,height:o},t.containerResizeSpeed,function(){l()});if(c==0&&u==0){if(e.browser.msie){b(250)}else{b(100)}}e("#lightbox-nav-btnPrev,#lightbox-nav-btnNext").css({height:n+t.containerBorderSize*2});e("#lightbox-container-image-data-box").css({width:i})}function l(){e("#lightbox-loading").hide();e("#lightbox-image").fadeIn(function(){c();u()});p()}function c(){e("#lightbox-container-image-data-box").slideDown("fast");e("#lightbox-image-details-caption").hide();if(t.imageArray[t.activeImage][1]){e("#lightbox-image-details-caption").text(t.imageArray[t.activeImage][1]).show()}if(t.imageArray.length>1){e("#lightbox-image-details-currentNumber").html(t.txtImage+" "+(t.activeImage+1)+" "+t.txtOf+" "+t.imageArray.length).show()}}function u(){e("#lightbox-nav").show();e("#lightbox-nav-btnPrev,#lightbox-nav-btnNext").css({background:"transparent url("+t.imageBlank+") no-repeat"});if(t.activeImage!=0){e("#lightbox-nav-btnPrev").unbind().hover(function(){e(this).css({background:"url("+t.imageBtnPrev+") left 45% no-repeat"})},function(){e(this).css({background:"transparent url("+t.imageBlank+") no-repeat"})}).show().bind("click",function(){t.activeImage=t.activeImage-1;s();return false})}if(t.activeImage!=t.imageArray.length-1){e("#lightbox-nav-btnNext").unbind().hover(function(){e(this).css({background:"url("+t.imageBtnNext+") right 45% no-repeat"})},function(){e(this).css({background:"transparent url("+t.imageBlank+") no-repeat"})}).show().bind("click",function(){t.activeImage=t.activeImage+1;s();return false})}d()}function d(){e(document).keydown(function(e){h(e)})}function f(){e(document).unbind()}function h(e){if(e==null){keycode=event.keyCode;escapeKey=27}else{keycode=e.keyCode;escapeKey=e.DOM_VK_ESCAPE}key=String.fromCharCode(keycode).toLowerCase();if(key==t.keyToClose||key=="x"||keycode==escapeKey){m()}if(key==t.keyToPrev||keycode==37){if(t.activeImage!=0){t.activeImage=t.activeImage-1;s();f()}}if(key==t.keyToNext||keycode==39){if(t.activeImage!=t.imageArray.length-1){t.activeImage=t.activeImage+1;s();f()}}}function p(){if(t.imageArray.length-1>t.activeImage){objNext=new Image;objNext.src=t.imageArray[t.activeImage+1][0]}if(t.activeImage>0){objPrev=new Image;objPrev.src=t.imageArray[t.activeImage-1][0]}}function m(){e("#jquery-lightbox").remove();e("#jquery-overlay").fadeOut(function(){e("#jquery-overlay").remove()});e("embed, object, select").css({visibility:"visible"})}function g(){var e,t;if(window.innerHeight&&window.scrollMaxY){e=window.innerWidth+window.scrollMaxX;t=window.innerHeight+window.scrollMaxY}else if(document.body.scrollHeight>document.body.offsetHeight){e=document.body.scrollWidth;t=document.body.scrollHeight}else{e=document.body.offsetWidth;t=document.body.offsetHeight}var i,n;if(self.innerHeight){if(document.documentElement.clientWidth){i=document.documentElement.clientWidth}else{i=self.innerWidth}n=self.innerHeight}else if(document.documentElement&&document.documentElement.clientHeight){i=document.documentElement.clientWidth;n=document.documentElement.clientHeight}else if(document.body){i=document.body.clientWidth;n=document.body.clientHeight}if(t<n){pageHeight=n}else{pageHeight=t}if(e<i){pageWidth=e}else{pageWidth=i}arrayPageSize=new Array(pageWidth,pageHeight,i,n);return arrayPageSize}function v(){var e,t;if(self.pageYOffset){t=self.pageYOffset;e=self.pageXOffset}else if(document.documentElement&&document.documentElement.scrollTop){t=document.documentElement.scrollTop;e=document.documentElement.scrollLeft}else if(document.body){t=document.body.scrollTop;e=document.body.scrollLeft}arrayPageScroll=new Array(e,t);return arrayPageScroll}function b(e){var t=new Date;i=null;do{var i=new Date}while(i-t<e)}return this.unbind("click").click(n)}})(jQuery);var purchases={init:function(){$("#contribute-why").popup("#contribute-more-info",{pointTo:"#contribute-more-info"});$(".price-wrapper a").live("click",_pd(function(e){var t=$(".price-wrapper");$(this).hide().next().show();t.find("select").live("change",_pd(function(e){t.find(".price").text(t.find("option:selected").attr("data-display"))}))}));$("button.paypal").live("click",function(e){var t=this,i="ajax-loading loading-submit disabled",n=$(t).closest("form").attr("action"),a={result_type:"json"};if($(".price-wrapper option:selected").length){a.currency=$(".price-wrapper option:selected").val()}if($(t).attr("data-realurl")){a.realurl=encodeURIComponent($(t).attr("data-realurl"))}$(t).addClass(i);$.ajax({type:"POST",url:n,data:a,dataType:"json",async:false,success:function(e){$(t).removeClass(i);$(".modal").trigger("close");if(e.status=="COMPLETED"){modalFromURL($(t).attr("data-thanksurl"))}else if(e.paykey){dgFlow=new PAYPAL.apps.DGFlow({clicked:t.id});dgFlow.startFlow(e.url)}else{if(!$("#paypal-error").length){$(t).closest("div").append('<div id="paypal-error" class="popup"></div>')}$("#paypal-error").text(e.error).popup(t,{pointTo:t}).render()}}});setTimeout(purchases.waiting_thanks,1e3);return false});purchases.result()},waiting_thanks:function(){if($(".paypal-thank-you").length){purchases.thanks(window)}else{setTimeout(purchases.waiting_thanks,1e3)}},record:function(e,t){if(e.attr("data-record-url")){$.ajax({url:e.attr("data-record-url"),dataType:"json",type:"POST",success:function(e){if(t){t.apply(this,[e.receipt])}}})}},result:function(){if($("#paypal-result").length){var e=window.top,t=e.dgFlow;if(!t&&top.opener&&top.opener.top.dgFlow){e=top.opener.top;t=e.dgFlow}if(t!==null){var i=$("#paypal-thanks").attr("href"),n=$("#paypal-error").attr("href"),a=window.frameElement;
if(i){e.modalFromURL(i)}else if(n){e.modalFromURL(n)}t.closeFlow();if(a){a.close()}else{top.close()}}}},reset:function(e,t){var i=e.closest(".install");if(i.hasClass("premium")){i.removeClass("premium");e.removeClass("premium");if(i.hasClass("webapp")){e.unbind().attr("href","#");e.find("span").text(gettext("Install App"));i.attr("data-manifest-url",$(".trigger_app_install",t).attr("data-manifest-url"));i.removeAttr("data-start-purchase")}i.installButton()}},find_button:function(e){return $(".install[data-addon="+$("#addon_info",e).attr("data-addon")+"]:visible",e).find("a.button")},thanks:function(e){var t=$(e.document).find("body"),i=purchases.find_button(t);purchases.reset(i,t);purchases.trigger(t)},trigger:function(e){if($(".trigger_download",e).exists()){z.installAddon($(".addon-title",e).text(),$(".trigger_download",e).attr("href"))}else if($(".trigger_app_install",e).exists()){var t=$(".trigger_app_install",e).attr("data-manifest-url"),i=$(".trigger_app_install",e).attr("data-receipt");purchases.install_app(t,i);$(".trigger_app_install",e).click(_pd(function(){purchases.install_app(t,$(this).attr("data-receipt"))}))}},install_app:function(e,t){var i={};if(t){i.receipt=t}apps.install(e,{data:i})}};$(document).ready(function(){purchases.init()});var contributions={commentlimit:255,init:function(){var e=$("#contribute-box");var t=parseFloat($("#contrib-too-much").attr("data-max-amount"));e.find("li label").click(function(e){e.preventDefault();$(this).siblings(":radio").attr("checked","checked");$(this).children("input:text").focus()}).end().find("input:text").keypress(function(){$(this).parent().siblings(":radio").attr("checked","checked")}).end().find("textarea").keyup(function(){var e=$(this).val(),t=contributions.commentlimit,i=$(this).siblings(".commentlen");if(e.length>t){$(this).val(e.substr(0,t))}i.text(t-Math.min(e.length,t))}).keyup().end().find("#contrib-too-much").hide().end().find("#contrib-too-little").hide().end().find("#contrib-not-entered").hide().end().find("form").submit(function(){var e=$(this).find("input:checked").val();if(e=="onetime"){var i=$(this).find('input[name="'+e+'-amount"]').val();$(this).find(".error").hide();if(isNaN(parseFloat(i))||+i!=i){$(this).find("#contrib-not-entered").show();return false}if(i>t){$(this).find("#contrib-too-much").show();return false}if(parseFloat(i)<.01){$(this).find("#contrib-too-little").show();return false}}var n=$(this);n.find("#contribute-actions").children().toggleClass("js-hidden");$.ajax({type:"POST",url:$(this).attr("action")+"?result_type=json",data:$(this).serialize(),async:false,success:function(e){if(e.status=="COMPLETED"){n.find("#paypal-complete").show();n.find("#contribute-actions").hide()}else if(e.paykey){dgFlow=new PAYPAL.apps.DGFlow({clicked:"contribute-box"});dgFlow.startFlow(e.url);n.find("span.cancel a").click()}else{n.find("#paypal-error").show()}}});n.find("#contribute-actions").children().toggleClass("js-hidden");return false});if(!e.jqm){return}e.jqm({overlay:100,overlayClass:"contrib-overlay",onShow:function(e){if($.browser.opera){this.inputs=$(":input:visible").css("visibility","hidden")}e.w.find(".error").hide();e.w.find("input:text").val("").end().find("textarea").val("").keyup().end().find("input:radio:first").attr("checked","checked").end().fadeIn()},onHide:function(e){if($.browser.opera){this.inputs.css("visibility","visible")}e.w.fadeOut();e.w.find("#paypal-complete").hide().end().find("#contribute-actions").show().end().find(".error").hide();e.o.remove()},trigger:"#contribute-button",toTop:true}).jqmAddClose(e.find(".cancel a"));if(window.location.hash==="#contribute-confirm"){$("#contribute-button").click()}}};$(function(){if(!$("body").hasClass("addon-details"))return;$(".previews").zCarousel({btnNext:".previews .next",btnPrev:".previews .prev",itemsPerPage:3});(function(){var e=$(document),t=$("#lightbox"),i=$("#lightbox .content"),n=$("#lightbox .caption span"),a=$(".previews"),r,s,o=template('<img id="preview{0}" src="{1}">');if(!t.length)return;function l(){t.show();u(this);$(window).bind("keydown.lightboxDismiss",function(e){switch(e.which){case z.keys.ESCAPE:e.preventDefault();c();break;case z.keys.LEFT:e.preventDefault();f();break;case z.keys.RIGHT:e.preventDefault();d();break}});setTimeout(function(){t.addClass("show")},0)}function c(){t.removeClass("show");setTimeout(function(){t.hide()},500);$(window).unbind("keydown.lightboxDismiss")}function u(e){var l=$(e),c=t.find("img");r=l.parent().index();s=l.closest("ul").find("li");a.find(".panel").removeClass("active").eq(r).addClass("active");var u=$("#preview"+r);if(u.length){c.css("opacity",0);u.css({opacity:1})}else{u=$(o([r,l.attr("href")]));i.append(u);u.load(function(e){c.css("opacity",0);u.css({opacity:1});for(var t=0;t<s.length;t++){if(t!=r){var n=s.eq(t).find("a");i.append(o([t,n.attr("href")]))}}})}n.text(l.attr("title"));t.find(".control").removeClass("disabled");if(r<1){t.find(".control.prev").addClass("disabled")}if(r==s.length-1){t.find(".control.next").addClass("disabled")}}function d(){if(r<s.length-1){u(s.eq(r+1).find("a"));if(!this.window){$(this).blur()}}}function f(){if(r>0){u(s.eq(r-1).find("a"));if(!this.window){$(this).blur()}}}$("#lightbox .next").click(_pd(d));$("#lightbox .prev").click(_pd(f));$(".previews ul a").click(_pd(l));$("#lightbox").click(_pd(function(e){if($(e.target).is(".close, #lightbox")){c()}}))})();if($("#more-webpage").exists()){var e=$("#more-webpage");url=e.attr("data-more-url");$.get(url,function(t){var i=$(t);e.replaceWith(i);i.find(".listing-grid h3").truncate({dir:"h"});i.find(".install").installButton();i.find(".listing-grid").each(listing_grid);$("#reviews-link").addClass("scrollto").attr("href","#reviews")})}if($("#review-add-box").exists())$("#review-add-box").modal("#add-review",{delegate:"#page",width:"650px"});if($("#privacy-policy").exists())$("#privacy-policy").modal(".privacy-policy",{width:"500px"});if($("#addon[data-id], #persona[data-id]").exists()){$("#addon .icon").click(function(){window.location.hash="id="+$("#addon, #persona").attr("data-id")})}$("#abuse-modal").modal("#report-abuse",{delegate:"#page"})});$(function(){var e=$("fieldset.abuse");if(e.find("legend a").length){var t=e.find("ol");t.hide();e.find("legend a, .cancel").click(_pd(function(){t.slideToggle("fast")}))}});$(document).ready(function(){var e=$(".review-reason").html(),t=$(window);$(".review-reason").popup(".flag-review",{delegate:$(document.body),width:"inherit",callback:function(t){var i=$(t.click_target),n=this;n.hideMe();function a(e,t){$.ajax({type:"POST",url:i.attr("href"),data:{flag:e,note:t},success:function(){n.removeClass("other").hideMe();i.closest(".item").addClass("flagged");i.replaceWith(gettext("Flagged for review")).addClass("flagged")},error:function(){},dataType:"json"})}n.delegate("li a","click",function(e){e.preventDefault();var t=$(e.target);if(t.attr("href")=="#review_flag_reason_other"){n.addClass("other").delegate("form","submit",function(e){e.preventDefault();var t=n.find("#id_note").val();if(!t){alert(gettext("Your input is required"))}else{a("review_flag_reason_other",t)}}).setPos(i).find("input[type=text]").focus()}else{a(t.attr("href").slice(1))}});n.removeClass("other");n.html(e);return{pointTo:i}}});$(".primary").delegate(".review-edit","click",function(e){e.preventDefault();var i=$("#review-edit-form"),n=$(this).closest(".review"),a=n.attr("data-rating"),r=$("a.permalink",n).attr("href")+"edit",s=$("#review-edit-cancel"),o;clearErrors(i);i.unbind().hide();$(".review").not(n).show();i.detach().insertAfter(n);if(n.find("h4").length){i.find("fieldset h3").remove();o="h4 > b";i.find("fieldset").prepend(n.find("h3").clone())}else{o="h3 > b"}i.find("#id_title").val(n.find(o).text());i.find(".ratingwidget input:radio[value="+a+"]").click();i.find("#id_body").val(n.children("p.description").text());n.hide();i.show();t.resize();location.hash="#review-edit-form";function l(){clearErrors(i);i.unbind().hide();n.show();s.unbind();t.resize()}s.click(_pd(l));i.submit(function(e){e.preventDefault();$.ajax({type:"POST",url:r,data:i.serialize(),success:function(e,t){clearErrors(i);n.find(o).text(i.find("#id_title").val());var a=i.find(".ratingwidget input:radio:checked").val();$(".stars",n).removeClass("stars-0 stars-1 stars-2 stars-3 stars-4 stars-5").addClass("stars-"+a);a=n.attr("data-rating",a);n.children("p.description").html(i.find("#id_body").val().replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace("\n","<br>","g"));l()},error:function(e){var t=$.parseJSON(e.responseText);populateErrors(i,t)},dataType:"json"});return false})});$(".delete-review").click(function(e){e.preventDefault();var t=$(e.target);$.post(t.attr("href"),function(){t.replaceWith(gettext("Marked for deletion"))});t.closest(".review").addClass("deleted")});$('select[name="rating"]').ratingwidget();$("#detail-review-link").click(_pd(function(e){$("#review-add-box form").append('<input type="hidden" name="detailed" value="1">').submit()}))});$(function(){$(".performance-note .popup").each(function(e,t){var i=$(this),n=i.siblings("a").first();i.popup(n,{width:300,pointTo:n})});initListingCompat();$(".theme-grid .hovercard.theme").each(function(){var e=$(this);if(e.find(".acr-override").length){e.addClass("acr")}else if(e.find(".concealed").length==e.find(".button").length){e.addClass("incompatible");var t=format(gettext("This theme is incompatible with your version of {0}"),[z.appName]);e.append(format('<span class="notavail">{0}</span>',t))}});$(document.body).bind("newStatic",function(){$(".install-note:visible").closest(".item").addClass("static")}).bind("closeStatic",function(){$(".item.static").removeClass("static")})});function initListingCompat(e){e=e||document.body;$(".listing .item.addon",e).each(function(){var e=$(this);if(e.find(".acr-override").length){e.addClass("acr")}else if(!e.hasClass("ignore-compatibility")&&e.find(".concealed").length==e.find(".button").length){e.addClass("incompatible")}})}(function(e){e.fn.hoverIntent=function(t,i){var n={sensitivity:7,interval:100,timeout:0};n=e.extend(n,i?{over:t,out:i}:t);var a,r,s,o;var l=function(e){a=e.pageX;r=e.pageY};var c=function(t,i){i.hoverIntent_t=clearTimeout(i.hoverIntent_t);if(Math.abs(s-a)+Math.abs(o-r)<n.sensitivity){e(i).unbind("mousemove",l);i.hoverIntent_s=1;return n.over.apply(i,[t])}else{s=a;o=r;i.hoverIntent_t=setTimeout(function(){c(t,i)},n.interval)}};var u=function(e,t){t.hoverIntent_t=clearTimeout(t.hoverIntent_t);t.hoverIntent_s=0;return n.out.apply(t,[e])};var d=function(t){var i=jQuery.extend({},t);var a=this;if(a.hoverIntent_t){a.hoverIntent_t=clearTimeout(a.hoverIntent_t)}if(t.type=="mouseenter"){s=i.pageX;o=i.pageY;e(a).bind("mousemove",l);if(a.hoverIntent_s!=1){a.hoverIntent_t=setTimeout(function(){c(i,a)},n.interval)}}else{e(a).unbind("mousemove",l);if(a.hoverIntent_s==1){a.hoverIntent_t=setTimeout(function(){u(i,a)},n.timeout)}}};return this.bind("mouseenter",d).bind("mouseleave",d)}})(jQuery);function dispatchPersonaEvent(e,t,i,n){var a={PreviewPersona:"PreviewBrowserTheme",ResetPersona:"ResetBrowserThemePreview",SelectPersona:"InstallBrowserTheme"};try{if(!t.hasAttribute("data-browsertheme")){return}var r=$(t).attr("data-browsertheme");if(n){r=r.replace(/http:\/\//g,"https://")}$(t).attr("persona",r);var s=a[e];var o=[e,s];for(var l=0;l<o.length;l++){var c=o[l];var u=document.createEvent("Events");u.initEvent(c,true,false);t.dispatchEvent(u)}if(i){i()}}catch(d){}}$.hasPersonas=function(){if(!jQuery.browser.mozilla)return false;if(VersionCompare.compareVersions($.browser.version,"1.9.2")>-1){return true}var e=document.getElementsByTagName("body")[0];try{var t=document.createEvent("Events");t.initEvent("CheckPersonas",true,false);e.dispatchEvent(t)}catch(i){}return e.getAttribute("personas")=="true"};$(document).ready(initPreviewTheme);function initPreviewTheme(e){var t=$(".persona-preview, .theme-preview");if(!t.length){return}if(BrowserUtils().browser.firefox!==true){$(".artist-tools, .persona-install").addClass("incompat-browser");$(".persona-install button").addClass("disabled")}$(".persona-install .add").click(_pd(function(e){dispatchPersonaEvent("SelectPersona",$(this).closest(".persona").find(".persona-preview a")[0])}));if(e===true){z.mktThemeFlag=true;bindPreviewListeners(t)}else{t.previewPersona()}}function bindPreviewListeners(e){e.each(function(){var e=$(this).find("div[data-browsertheme]");e.unbind("click").click(_pd(function(e){var t=$(this),i=e.target.nodeName=="EM"?e.target.parentNode:e.target;$(".theme-preview").find("em").addClass("hidden");if(t.attr("data-clicktoreset")=="true"){dispatchPersonaEvent("ResetPersona",i);t.attr("data-clicktoreset","false");t.find("em").addClass("hidden")}else{dispatchPersonaEvent("PreviewPersona",i);t.attr("data-clicktoreset","true");t.find("em").removeClass("hidden")}}))})}$.fn.previewPersona=function(e){if(!$.hasPersonas()){return}e=$.extend({resetOnClick:true,activeClass:"persona-hover"},e||{});var t=$(this);if(e.resetOnClick){t.click(function(e){if(z.mktThemeFlag){return}dispatchPersonaEvent("ResetPersona",e.target)})}t.hoverIntent({interval:100,over:function(t){if(z.mktThemeFlag){return}$(this).closest(".persona").addClass(e.activeClass);dispatchPersonaEvent("PreviewPersona",t.target)},out:function(t){if(z.mktThemeFlag){return}$(this).closest(".persona").removeClass(e.activeClass);dispatchPersonaEvent("ResetPersona",t.target)}})};$.fn.personasButton=function(e,t){var i=$(this).closest(".persona");if(!i.length){i=$(".theme-large").parent()}i.hoverIntent({interval:100,over:function(e){dispatchPersonaEvent("PreviewPersona",e.currentTarget)},out:function(e){dispatchPersonaEvent("ResetPersona",e.currentTarget)}});i.click(function(e){dispatchPersonaEvent("SelectPersona",e.currentTarget,t);return false})};function VerticalCarousel(e){this.container=$(e);this.currentPage=1;this.items=this.container.find("> li");this.numItems=this.items.length;this.singleHeight=$(this.items[0]).height();this.numVisible=3;this.numPages=Math.ceil(this.numItems/this.numVisible);this.prevButton=$('<a class="arrow prev">^</a>');this.nextButton=$('<a class="arrow next">&gt;</a>');this.container.before(this.prevButton);this.container.after(this.nextButton);this.interval=false;function t(e,t){return new Array(t+1).join(e)}var i=this.numItems%this.numVisible;if(i>0){this.container.append(t('<li style="height:'+this.singleHeight+'px" class="empty" />',i));this.items=this.container.find("> li")}this.items.filter(":first").before(this.items.slice(-this.numVisible).clone().addClass("cloned"));this.items.filter(":last").after(this.items.slice(0,this.numVisible).clone().addClass("cloned"));this.items=this.container.find("> li");this.container.scrollTop(this.singleHeight*this.numVisible)}VerticalCarousel.prototype.gotoPage=function(e){var t=e<this.currentPage?-1:1,i=Math.abs(this.currentPage-e),n=this.singleHeight*t*this.numVisible*i,a=this;if(this.container){this.container.filter(":not(:animated)").animate({scrollTop:"+="+n},500,function(){if(!a.container){return false}if(e===0){a.container.scrollTop(a.singleHeight*a.numVisible*a.numPages);e=a.numPages}else if(e>a.numPages){a.container.scrollTop(a.singleHeight*a.numVisible);e=1}a.currentPage=e})}return false};VerticalCarousel.prototype.autoAdvance=function(){clearInterval(this.interval);var e=this;this.interval=setInterval(function(){e.gotoPage(e.currentPage+1)},5e3)};VerticalCarousel.prototype.pause=function(){clearInterval(this.interval);clearTimeout(this.interval)};VerticalCarousel.prototype.init=function(){var e=this;this.prevButton.click(function(t){e.gotoPage(e.currentPage-1)});this.nextButton.click(function(t){e.gotoPage(e.currentPage+1)});function t(t){e.pause()}function i(t){e.interval=setTimeout(function(){e.autoAdvance()},1e3)}this.prevButton.mouseenter(t);this.nextButton.mouseenter(t);this.container.mouseenter(t);this.prevButton.mouseleave(i);this.nextButton.mouseleave(i);this.container.mouseleave(i);this.autoAdvance()};$(document).ready(function(){new VerticalCarousel($(".personas-slider")).init()});$.fn.objectUrl=function(e){var t=$(this)[0].files,i=false;if(z.capabilities.fileAPI&&t.length){e=e||0;var n=t[e];if(typeof window.URL!=="undefined"){i=window.URL.createObjectURL(n)}else if(typeof window.webkitURL=="function"){i=window.webkitURL.createObjectURL(n)}else if(typeof n.getAsDataURL=="function"){i=n.getAsDataURL()}}return i};(function(e){var t=0,i="BoUnDaRyStRiNg";e.fn.imageUploader=function(){var i=this,n=0,a=i[0].files,r=i.attr("data-upload-url"),s=i.closest("form").find("input[name^=csrf]").val();if(!z.capabilities.fileAPI||a.length===0){return false}i.trigger("upload_start_all");e.each(a,function(e,a){var o="",l={instance:t,name:a.name||a.fileName,size:a.size,type:a.type,aborted:false,dataURL:false},c=function(){n--;if(n<=0){i.trigger("upload_finished_all")}i.trigger("upload_finished",[l])},u=new z.FormData;t++;n++;if(i.attr("data-allowed-types").split("|").indexOf(l.type)<0){var d=[gettext("Images must be either PNG or JPG.")];if(typeof i.attr("multiple")!=="undefined"){if(i.attr("data-allowed-types").indexOf("video")>-1){d.push([gettext("Videos must be in WebM.")])}}i.trigger("upload_start",[l]);i.trigger("upload_errors",[l,d]);c();return}l.dataURL=i.objectUrl(e);i.trigger("upload_start",[l]);u.open("POST",r,true);u.append("csrfmiddlewaretoken",s);u.append("upload_image",a);u.xhr.onreadystatechange=function(){if(u.xhr.readyState==4&&u.xhr.responseText&&(u.xhr.status==200||u.xhr.status==304)){var e={};try{e=JSON.parse(u.xhr.responseText)}catch(t){var n=gettext("There was a problem contacting the server.");i.trigger("upload_errors",[l,n]);c();return false}if(e.errors.length){i.trigger("upload_errors",[l,e.errors])}else{i.trigger("upload_success",[l,e.upload_hash])}c()}};u.send()});i.val("")}})(jQuery);if(jQuery)(function(e){e.extend(e.fn,{miniColors:function(t,i){var n=function(t,i,n){var a=g(t.val())||"cccccc",r=w(a);var c=e('<a class="miniColors-trigger" style="background-color: #'+a+'" href="#"></a>');c.insertBefore(t);t.addClass("miniColors").attr("maxlength",7).attr("autocomplete","off");t.data("trigger",c);t.data("hsb",r);if(i.change)t.data("change",i.change);if(i.readonly)t.attr("readonly",true);if(i.disabled)s(t);c.bind("click.miniColors",function(e){e.preventDefault();t.trigger("focus")});t.bind("focus.miniColors",function(e){o(t)});t.bind("blur.miniColors",function(e){var i=g(t.val());t.val(i?"#"+i:"")});t.bind("keydown.miniColors",function(e){if(e.keyCode===9)l(t)});t.bind("keyup.miniColors",function(e){var i=t.val().replace(/[^A-F0-9#]/gi,"");t.val(i);if(!f(t)){t.data("trigger").css("backgroundColor","#fff")}});t.bind("paste.miniColors",function(e){setTimeout(function(){t.trigger("keyup")},5)})};var a=function(t){l();t=e(t);t.data("trigger").remove();t.removeAttr("autocomplete");t.removeData("trigger");t.removeData("selector");t.removeData("hsb");t.removeData("huePicker");t.removeData("colorPicker");t.removeData("mousebutton");t.removeData("moving");t.unbind("click.miniColors");t.unbind("focus.miniColors");t.unbind("blur.miniColors");t.unbind("keyup.miniColors");t.unbind("keydown.miniColors");t.unbind("paste.miniColors");e(document).unbind("mousedown.miniColors");e(document).unbind("mousemove.miniColors")};var r=function(e){e.attr("disabled",false);e.data("trigger").css("opacity",1)};var s=function(e){l(e);e.attr("disabled",true);e.data("trigger").css("opacity",.5)};var o=function(t){if(t.attr("disabled"))return false;l();var i=e('<div class="miniColors-selector"></div>');i.append('<div class="miniColors-colors" style="background-color: #fff"><div class="miniColors-colorPicker"></div></div>');i.append('<div class="miniColors-hues"><div class="miniColors-huePicker"></div></div>');var n,a;if(t.is(":visible")){n=t.offset().top+t.outerHeight();a=t.offset().left}else{n=t.data("trigger").offset().top+t.data("trigger").outerHeight();a=t.data("trigger").offset().left}i.css({top:n,left:a,display:"none"}).addClass(t.attr("class"));var r=t.data("hsb");i.find(".miniColors-colors").css("backgroundColor","#"+$({h:r.h,s:100,b:100}));var s=t.data("colorPosition")||p(r);i.find(".miniColors-colorPicker").css("top",s.y+"px").css("left",s.x+"px");var o=t.data("huePosition")||m(r);i.find(".miniColors-huePicker").css("top",o.y+"px");t.data("selector",i);t.data("huePicker",i.find(".miniColors-huePicker"));t.data("colorPicker",i.find(".miniColors-colorPicker"));t.data("mousebutton",0);e(document.body).append(i);i.fadeIn(100);i.bind("selectstart",function(){return false});e(document).bind("mousedown.miniColors",function(i){t.data("mousebutton",1);if(e(i.target).parents().andSelf().hasClass("miniColors-colors")){i.preventDefault();t.data("moving","colors");c(t,i)}if(e(i.target).parents().andSelf().hasClass("miniColors-hues")){i.preventDefault();t.data("moving","hues");u(t,i)}if(e(i.target).parents().andSelf().hasClass("miniColors-selector")){i.preventDefault();return}if(e(i.target).parents().andSelf().hasClass("miniColors"))return;l(t)});e(document).bind("mouseup.miniColors",function(e){t.data("mousebutton",0);t.removeData("moving")});e(document).bind("mousemove.miniColors",function(e){if(t.data("mousebutton")===1){if(t.data("moving")==="colors")c(t,e);if(t.data("moving")==="hues")u(t,e)}})};var l=function(t){if(!t)t=".miniColors";e(t).each(function(){var t=e(this).data("selector");e(this).removeData("selector");e(t).fadeOut(100,function(){e(this).remove()})});e(document).unbind("mousedown.miniColors");e(document).unbind("mousemove.miniColors")};var c=function(t,i){var n=t.data("colorPicker");n.hide();var a={x:i.clientX-t.data("selector").find(".miniColors-colors").offset().left+e(document).scrollLeft()-5,y:i.clientY-t.data("selector").find(".miniColors-colors").offset().top+e(document).scrollTop()-5};if(a.x<=-5)a.x=-5;if(a.x>=144)a.x=144;if(a.y<=-5)a.y=-5;if(a.y>=144)a.y=144;t.data("colorPosition",a);n.css("left",a.x).css("top",a.y).show();var r=Math.round((a.x+5)*.67);if(r<0)r=0;if(r>100)r=100;var s=100-Math.round((a.y+5)*.67);if(s<0)s=0;if(s>100)s=100;var o=t.data("hsb");o.s=r;o.b=s;d(t,o,true)};var u=function(t,i){var n=t.data("huePicker");n.hide();var a={y:i.clientY-t.data("selector").find(".miniColors-colors").offset().top+e(document).scrollTop()-1};if(a.y<=-1)a.y=-1;if(a.y>=149)a.y=149;t.data("huePosition",a);n.css("top",a.y).show();var r=Math.round((150-a.y-1)*2.4);if(r<0)r=0;if(r>360)r=360;var s=t.data("hsb");s.h=r;d(t,s,true)};var d=function(e,t,i){e.data("hsb",t);var n=$(t),a=y(n);if(i)e.val("#"+n);e.data("trigger").css("backgroundColor","#"+n).attr("data-color",[a.r,a.g,a.b]);if(e.data("selector")){e.data("selector").find(".miniColors-colors").css("backgroundColor","#"+$({h:t.h,s:100,b:100}))}if(e.data("change")){e.data("change").call(e,"#"+n,v(t))}};var f=function(t){var i=g(t.val());if(!i)return false;var n=w(i);var a=t.data("hsb");if(n.h===a.h&&n.s===a.s&&n.b===a.b)return true;var r=p(n),s=e(t.data("colorPicker"));s.css("top",r.y+"px").css("left",r.x+"px");var o=m(n),l=e(t.data("huePicker"));l.css("top",o.y+"px");d(t,n,false);return true};var p=function(e){var t=Math.ceil(e.s/.67);if(t<0)t=0;if(t>150)t=150;var i=150-Math.ceil(e.b/.67);if(i<0)i=0;if(i>150)i=150;return{x:t-5,y:i-5}};var m=function(e){var t=150-e.h/2.4;if(t<0)h=0;if(t>150)h=150;return{y:t-1}};var g=function(e){e=e.replace(/[^A-Fa-f0-9]/,"");if(e.length==3){e=e[0]+e[0]+e[1]+e[1]+e[2]+e[2]}return e.length===6?e:null};var v=function(e){var t={},i=Math.round(e.h),n=Math.round(e.s*255/100),a=Math.round(e.b*255/100);if(n==0){t.r=t.g=t.b=a}else{var r=a,s=(255-n)*a/255,o=(r-s)*(i%60)/60;if(i==360)i=0;if(i<60){t.r=r;t.b=s;t.g=s+o}else if(i<120){t.g=r;t.b=s;t.r=r-o}else if(i<180){t.g=r;t.r=s;t.b=s+o}else if(i<240){t.b=r;t.r=s;t.g=r-o}else if(i<300){t.b=r;t.g=s;t.r=s+o}else if(i<360){t.r=r;t.g=s;t.b=r-o}else{t.r=0;t.g=0;t.b=0}}return{r:Math.round(t.r),g:Math.round(t.g),b:Math.round(t.b)}};var b=function(t){var i=[t.r.toString(16),t.g.toString(16),t.b.toString(16)];e.each(i,function(e,t){if(t.length==1)i[e]="0"+t});return i.join("")};var y=function(e){var e=parseInt(e.indexOf("#")>-1?e.substring(1):e,16);return{r:e>>16,g:(e&65280)>>8,b:e&255}};var _=function(e){var t={h:0,s:0,b:0};var i=Math.min(e.r,e.g,e.b),n=Math.max(e.r,e.g,e.b),a=n-i;t.b=n;t.s=n!=0?255*a/n:0;if(t.s!=0){if(e.r==n){t.h=(e.g-e.b)/a}else if(e.g==n){t.h=2+(e.b-e.r)/a}else{t.h=4+(e.r-e.g)/a}}else{t.h=-1}t.h*=60;if(t.h<0){t.h+=360}t.s*=100/255;t.b*=100/255;return t};var w=function(e){var t=_(y(e));if(t.s===0)t.h=360;return t};var $=function(e){return b(v(e))};var k=e(this);switch(t){case"readonly":k.each(function(){e(this).attr("readonly",i)});return k;break;case"disabled":k.each(function(){if(i){s(e(this))}else{r(e(this))}});return e(this);case"value":k.each(function(){e(this).val(i).trigger("keyup")});return e(this);break;case"destroy":k.each(function(){a(e(this))});return e(this);default:t=t||{};k.each(function(){if(e(this)[0].tagName.toLowerCase()!=="input")return;if(e(this).data("trigger"))return;n(e(this),t,i)});return e(this)}}})})(jQuery);(function(){if(!$("#submit-persona").length){return}$(document).delegate(".email-autocomplete","keyup paste",s);s();a();var e=$(".owner-email form");e.delegate("input, select, textarea","change keyup paste",function(e){i()});i();var t=$("#submit-persona form");t.delegate("input, select, textarea","change keyup paste",function(e){d(e.target.form)});d(t[0]);o();initCharCount();c();u();function i(){e.find("button").prop("disabled",!e.find("input").hasClass("valid"))}function n(){if(location.hash=="#ownership"){$(".owner-email").removeClass("hidden").find("input").focus()}else{$(".owner-email").addClass("hidden").find("input").blur()}}function a(){$(".transfer-ownership").click(function(e){if(location.hash=="#ownership"){location.hash="";e.preventDefault()}});window.addEventListener("hashchange",function(){n()},false);n()}var r;function s(e){var t=e?$(this):$(".email-autocomplete");if(t.val()&&t.val().length>2){var n,a;if(n){clearTimeout(n)}n=setTimeout(function(){t.addClass("ui-autocomplete-loading").removeClass("invalid valid");r=t.val();a=$.ajax({url:t.attr("data-src"),data:{q:r},success:function(e){t.removeClass("ui-autocomplete-loading tooltip formerror").removeAttr("title").removeAttr("data-oldtitle");$("#tooltip").hide();if(e.status==1){t.addClass("valid")}else{t.addClass("invalid tooltip formerror").attr("title",e.message)}i()},error:function(){t.removeClass("ui-autocomplete-loading").addClass("invalid")}})},500)}}function o(){var e=$("#id_license");var i={copyr:{id:1,name:gettext("All Rights Reserved")},"cc-attrib":{id:2,name:gettext("Creative Commons Attribution 3.0"),url:"http://creativecommons.org/licenses/by/3.0/"},"cc-attrib cc-noncom":{id:3,name:gettext("Creative Commons Attribution-NonCommercial 3.0"),url:"http://creativecommons.org/licenses/by-nc/3.0/"},"cc-attrib cc-noncom cc-noderiv":{id:4,name:gettext("Creative Commons Attribution-NonCommercial-NoDerivs 3.0"),url:"http://creativecommons.org/licenses/by/3.0/"},"cc-attrib cc-noncom cc-share":{id:5,name:gettext("Creative Commons Attribution-NonCommercial-Share Alike 3.0"),url:"http://creativecommons.org/licenses/by-nc-sa/3.0/"},"cc-attrib cc-noderiv":{id:6,name:gettext("Creative Commons Attribution-NoDerivs 3.0"),url:"http://creativecommons.org/licenses/by-nd/3.0/"},"cc-attrib cc-share":{id:7,name:gettext("Creative Commons Attribution-ShareAlike 3.0"),url:"http://creativecommons.org/licenses/by/3.0/"}};var n=_.object(_.map(i,function(e,t){return[e.id,t]}));function a(t){$("#cc-chooser .radios").each(function(){var e=$(this);if(!e.find("input:checked").length){e.find('input[value="0"]').prop("checked",true)}});var n;if($('input[data-cc="copyr"]:checked').length){n="copyr"}else{n=$("input[data-cc]:checked").map(function(){return $(this).data("cc")}).toArray().join(" ")}var a=i[n];if(a){var r=a.name;if(a.url){r=format('<a href="{0}" target="_blank">{1}</a>',a.url,r)}var s=$("#persona-license");s.show().find("#cc-license").html(r).attr("class","license icon "+n);e.val(a.id);if(t){l()}}}var r=$(".noncc"),s=$("#persona-license-list");function o(e){if(e){r.addClass("disabled");$('input[name="cc-noncom"][value=1], input[name="cc-noderiv"][value=2]').prop("checked",true)}else{r.removeClass("disabled")}}t.delegate('input[name="cc-attrib"]',"change",function(){o(+e.val()==i.copyr.id)}).delegate("#persona-license-list input[type=radio][name=license]","change",function(){$(".noncc.disabled").removeClass("disabled");$('input[name^="cc-"]').prop("checked",false);_.each(n[+s.find("input[name=license]:checked").val()].split(" "),function(e){$('input[type=radio][data-cc="'+e+'"]').prop("checked",true);o(e=="copyr")});a(false)});if(!e.val()){e.val(i.copyr.id);$('input[data-cc="copyr"]').prop("checked",true);o(+e.val()==i.copyr.id)}else{_.each(n[+e.val()].split(" "),function(e){$('input[type=radio][data-cc="'+e+'"]').prop("checked",true)})}o(+e.val()==i.copyr.id);a();$('input[name^="cc-"]').change(a);function l(){s.find('input[value="'+e.val()+'"]').prop("checked",true)}$("#persona-license .select-license").click(_pd(function(){$("#persona-license-list").toggle();l()}));l()}var l={};function c(){var e=$("#persona-design"),t=function(e){$(this).closest(".row").find(".preview").removeClass("loading");$("#submit-persona button").attr("disabled",false);r()},i=function(e,t){var i=$(this).closest(".row"),n=i.find(".errorlist");if(n.length==2){n.eq(0).remove()}i.find(".errorlist").html("");i.find(".preview").addClass("loading").removeClass("error-loading");$("#submit-persona button").attr("disabled",true)},n=function(e,t,i){var n=$(this).closest(".row");n.find('input[type="hidden"]').val(i);n.find("input[type=file], .note").hide();n.find(".preview").attr("src",t.dataURL).addClass("loaded");l[i]=t.dataURL;r();n.find(".preview, .reset").show()},a=function(e,t,i){var n=$(this).closest(".row"),a=n.find(".errorlist");n.find(".preview").addClass("error-loading");$.each(i,function(e,t){a.append("<li>"+t+"</li>")})};e.delegate(".reset","click",_pd(function(){var e=$(this),t=e.closest(".row");t.find('input[type="hidden"]').val("");t.find("input[type=file], .note").show();t.find(".preview").removeAttr("src").removeClass("loaded");r();e.hide()}));e.delegate('input[type="file"]',"upload_finished",t).delegate('input[type="file"]',"upload_start",i).delegate('input[type="file"]',"upload_success",n).delegate('input[type="file"]',"upload_errors",a).delegate('input[type="file"]',"change",function(e){$(this).imageUploader()});function r(){var t=$("#persona-header .preview").attr("src"),i=$("#persona-preview .persona-viewer");if(t){i.css("background-image","url("+t+")")}var n={id:"0"};$.each(["name","accentcolor","textcolor"],function(t,i){n[i]=e.find("#id_"+i).val()});n.header=n.headerURL=e.find("#persona-header .preview").attr("src");n.footer=n.footerURL=e.find("#persona-footer .preview").attr("src");i.attr("data-browsertheme",JSON.stringify(n));var a=e.find("#id_accentcolor").attr("data-rgb"),r=e.find("#id_textcolor").val();i.find(".title, .author").css({"background-color":format("rgba({0}, .7)",a),color:r})}var s=$("#submit-persona input[type=color]");s.change(function(){var e=$(this),t=e.val();if(t.indexOf("#")===0){var i=p(t);e.attr("data-rgb",format("{0},{1},{2}",i.r,i.g,i.b))}r()}).trigger("change");if(s[0].type==="color"){$(".miniColors-trigger").hide()}else{s.miniColors({change:function(){s.trigger("change");r()}})}$("#id_name").bind("change keyup paste blur",_.throttle(function(){$("#persona-preview-name").text($(this).val()||gettext("Your Theme's Name"));slugify()},250)).trigger("change");$("#submit-persona").submit(function(){h(l)});l=f();_.each(l,function(e,t){$('input[value="'+t+'"]').siblings("input[type=file]").trigger("upload_success",[{dataURL:e},t])})}function u(){$(".reupload").click(_pd(function(){$(".theme-design").slideToggle();$(".reupload, .theme-preview").toggle()}))}function d(e){if(e){$(e).find("button[type=submit]").attr("disabled",!e.checkValidity())}}function f(){return JSON.parse($('input[name="unsaved_data"]').val()||"{}")
}function h(e){$('input[name="unsaved_data"]').val(JSON.stringify(e))}function p(e){e=parseInt(e.indexOf("#")>-1?e.substring(1):e,16);return{r:e>>16,g:(e&65280)>>8,b:e&255}}})();var collections={};(function(){var e=$("h2.collection[data-collectionid]");if(e.length){e.find("img").click(function(){window.location.hash="id="+e.attr("data-collectionid")})}RECENTLY_VIEWED_LIMIT=5;jQuery.extend({keys:function(e){var t=[];$.each(e,function(e){t.push(e)});return t},values:function(e){var t=[];$.each(e,function(e,i){t.push(i)});return t},items:function(e){var t=[];$.each(e,function(e,i){t.push([e,i])});return t},fmap:function(e,t){var i=[];$.each(e,function(e,n){i.push(t(n,e))});return i},dict:function(e){var t={};$.each(e,function(e,i){t[i[0]]=i[1]});return t}});var t=function(e,t){if(t===undefined){var t=function(e){return e}}var i={};$.each(e.reverse(),function(e,n){i[t(n)]=[e,n]});var n=$.values(i).sort(function(e,t){return e[0]-t[0]});return $.fmap(n.reverse(),function(e){return e[1]})};RecentlyViewed=function(e){var t={limit:10,storage:z.Storage(),storageKey:"recently-viewed",uniqueFunc:function(e){return e[1]}};$.extend(this,t,e)};RecentlyViewed.prototype={add:function(e){var i=this._list();i.push([Date.parse(new Date),e]);i.sort(function(e,t){return t[0]-e[0]});i=t(i,this.uniqueFunc);return this._save(i)},list:function(){return $.fmap(this._list(),function(e){return e[1]})},_save:function(e){e=e.slice(0,this.limit);this.storage.set(this.storageKey,JSON.stringify(e));return e},_list:function(){var e=this.storage.get(this.storageKey);if(e===null||e===undefined){return[]}else{return JSON.parse(e)}},clear:function(){this.storage.remove(this.storageKey)}};collections.recently_viewed=function(){var e=new RecentlyViewed({storageKey:"recently-viewed-collections",uniqueFunc:function(e){return e[1].uuid}});var t=$("#add-to-recents");if(t.size()){var i=$.dict($.fmap(["disp","url","uuid"],function(e){return[e,$.trim(t.attr("data-"+e))]}));var n=i.uuid;if(i.disp){e.add(i)}}else{var n=""}var a=$.map(e.list(),function(e){if(e.uuid!=n){return $("<li></li>").append($('<a class="collectionitem" href="'+e.url+'"></a>').text(e.disp))[0]}});if(a.length!=0){a=a.slice(0,RECENTLY_VIEWED_LIMIT);var r=$('<ul class="addon-collections"></ul>').append($(a));$("#recently-viewed").append(r).append('<a id="clear-recents" href="#">'+gettext("clear recently viewed")+"</a>").show();$("#clear-recents").click(function(t){t.preventDefault();e.clear();$("#recently-viewed").hide()})}};var i=function(e){var t=0;$.each(e,function(e,i){t+=i});return t};var n=function(e){if($.cookie("collections-leave-me-alone"))return;var t=$('<div class="modal-subscription">'+e+"</div>");t.appendTo(document.body).jqm().jqmAddClose("a.close-button").jqmShow();t.find("#bothersome").change(function(){$.cookie("collections-leave-me-alone",true,{expires:365,path:collections.cookie_path});t.jqmHide()})};collections.hijack_favorite_button=function(){var e=collections;$("form.favorite").submit(function(t){t.preventDefault();var i=$(this).attr("action")+"/ajax";var a=$(this).find("button");var r=a.html();var s=a.hasClass("fav");var o=function(t){var i=e[t+"_text"];if(a.find("img").length){var n=e[t+"_img"];a.html('<img src="'+n+'"/>'+i)}else{a.html(i)}};a.css("min-width",a.outerWidth());a.addClass("loading-fav").attr("disabled","disabled");o(s?"removing":"adding");a.css("min-width",a.outerWidth());$.ajax({type:"POST",data:$(this).serialize(),url:i,success:function(e){if(s){a.removeClass("fav");o("add")}else{n(e);a.addClass("fav");o("remove")}bandwagonRefreshEvent()},error:function(){a.html(r)},complete:function(){a.attr("disabled","");a.removeClass("loading-fav")}})})};$(document).ready(collections.recently_viewed);$(document).ready(function(){var e=false;var t=function(t){t.preventDefault();if(e)return;e=true;var i=$(this);$.post($(this).attr("action"),$(this).serialize(),function(t,n,a){e=false;if(a.status==200){var r=i.closest(".barometer");var s=$("input.voted",r);var o=$('input[type="submit"]',i);if(s.length){s.get(0).value--;s.removeClass("voted")}if(s.get(0)!==o.get(0)){o.get(0).value++;o.addClass("voted")}}})};if(z.anonymous){$(".barometer form").submit(function(e){e.preventDefault();var t=this;var i=$(".collection-rate-dropdown",$(t).closest(".barometer"));if($(t).hasClass("downvote")){i.addClass("left")}else{i.removeClass("left")}i.detach().appendTo(t).show();setTimeout(function(){function e(t){_root=i.get(0);if(t.type=="click"&&_root==t.target||_.indexOf($(t.target).parents(),_root)!=-1){return}i.hide();$(document.body).unbind("click newPopup",e)}$(document.body).bind("click newPopup",e)},0)})}else{$(".barometer form").submit(t)}});$(document).ready(function(){var e=collections;e.adding_img="/img/icons/white-loading-16x16.gif";e.adding_text=gettext("Adding to Favorites&hellip;");e.removing_img="/img/icons/white-loading-16x16.gif";e.removing_text=gettext("Removing Favorite&hellip;");e.add_img="/img/icons/buttons/plus-orange-16x16.gif";e.add_text=gettext("Add to Favorites");e.remove_img="/img/icons/buttons/minus-orange-16x16.gif";e.remove_text=gettext("Remove from Favorites");e.cookie_path="/";collections.hijack_favorite_button()});addon_ac=$("#addon-ac");if(addon_ac.length){addon_ac.autocomplete({minLength:3,width:300,source:function(e,t){$.getJSON($("#addon-ac").attr("data-src"),{q:e.term},t)},focus:function(e,t){$("#addon-ac").val(t.item.name);return false},select:function(e,t){$("#addon-ac").val(t.item.name).attr("data-id",t.item.id).attr("data-icon",t.item.icons[32]);return false}}).data("autocomplete")._renderItem=function(e,t){if(!$("#addons-list input[value="+t.id+"]").length){return $("<li>").data("item.autocomplete",t).append('<a><img src="'+t.icons[32]+'">'+t.name+"</a>").appendTo(e)}}}$("#addon-ac").keydown(function(e){if(e.which==13){e.preventDefault();$("#addon-select").click()}});$("#addon-select").click(function(e){e.preventDefault();var t=$("#addon-ac").attr("data-id");var i=$("#addon-ac").val();var n=$("#addon-ac").attr("data-icon");if($("input[name=addon][value="+t+"]").length){return false}if(t&&i&&n){var a=template("<tr>"+'<td class="item">'+'<input name="addon" value="{id}" type="hidden">'+'<img src="{icon}"><h3>{name}</h3>'+'<p class="comments">'+'<textarea name="addon_comment"></textarea>'+"</p></td>"+"<td>"+gettext("Pending")+"</td>"+'<td><a title="'+gettext("Add a comment")+'" class="comment">'+gettext("Comment")+"</a></td>"+'<td class="remove"><a title="'+gettext("Remove this add-on from the collection")+'" class="remove">'+gettext("Remove")+"</a></td>"+"</tr>");var r=a({id:t,name:i,icon:n});$("#addon-select").closest("tbody").append(r)}$("#addon-ac").val("")});var a=$("#addon-ac").closest("table");a.delegate(".remove","click",function(){$(this).closest("tr").remove()}).delegate(".comment","click",function(){var e=$(this).closest("tr");e.find(".comments").show();$(".comments textarea",e).focus()})})();if($("body.collections-contributors")){var user_row=template("<tr>"+"<td>"+'<input name="contributor" value="{id}" type="hidden">'+"{name}"+"</td><td>{email}</td>"+'<td class="contributor">Contributor</td>'+'<td class="remove"><a title="'+gettext("Remove this user as a contributor")+'" class="remove">'+gettext("Remove")+"</a></td>"+"</tr>");$("#contributor-ac-button").click(function(e){e.preventDefault();var t=$("#contributor-ac").val();var i=$("#contributor-ac").attr("data-src");var n=$("#contributor-ac").attr("data-owner");var a=$("#contributor-ac-error");if(!t){a.html(gettext("An email address is required.")).addClass("error");return}$("#contributor-ac").addClass("ui-autocomplete-loading");$.get(i,{q:t},function(e){$("#contributor-ac").removeClass("ui-autocomplete-loading");if(e.status){if($("input[name=contributor][value="+e.id+"]").length==0&&n!=e.id){var i=user_row({id:e.id,name:e.name,email:t});$("#contributor-ac-button").closest("tbody").append(i);a.html("").removeClass("error")}else if(e.id==n){a.html(gettext("You cannot add yourself as a contributor.")).addClass("error")}else{a.html(gettext("You have already added that user.")).addClass("error")}}else{a.html(e.message).addClass("error")}$("#contributor-ac").val("")})});var table=$("#contributors-list");table.delegate(".remove","click",function(){$(this).closest("tr").remove()});$("#change-owner").popup(".make-owner",{callback:function(e){var t=this,i=$(e.click_target);t.delegate("#change-owner-cancel","click",function(e){e.preventDefault();t.hideMe()});t.attr("data-newowner",i.parents(".contributor").children("input[name='contributor']").val());return{pointTo:i}}});$("#change-owner-submit").click(function(e){e.preventDefault();var t=$("#change-owner").attr("data-newowner");$("#users-edit form").append('<input type="hidden" name="new_owner" value="'+t+'">').submit()})}$(document).ready(function(){$("#remove_icon").click(function(){$.post($(this).attr("href"),{},function(e){$("#icon_upload .icon_preview img").attr("src",e.icon)});$(this).hide();return false})});$(document).ready(function(){var e=$("#id_name").val();$(document).bind("unicode_loaded",function(){$("#id_slug").attr("data-customized",!!$("#id_slug").val()&&$("#id_slug").val()!=makeslug(e)?1:0);slugify()});$("#details-edit form, .collection-create form").delegate("#id_name","keyup",slugify).delegate("#id_name","blur",slugify).delegate("#edit_slug","click",show_slug_edit).delegate("#id_slug","change",function(){$("#id_slug").attr("data-customized",1);if(!$("#id_slug").val()){$("#id_slug").attr("data-customized",0);slugify()}});var t=$("#add-to-collection").html();$("#add-to-collection").popup(".widgets .collection-add",{width:200,offset:{x:8},callback:function(e){var n=this,a=$(e.click_target),r=a.attr("data-listurl"),s=a.attr("data-removeurl"),o=a.attr("data-addurl"),l=a.attr("data-newurl"),c=a.attr("data-addonid");if(z.anonymous){return{pointTo:a}}function u(e){if(e)e.preventDefault();a.addClass("ajax-loading");$.ajax({url:r,data:{addon_id:c},success:d,error:function(){d(t)},dataType:"html"})}function d(e){n.html(e);n.show();a.removeClass("ajax-loading");$("a.outlink",n).click(i);if(!$(".errorlist li",n).length)n.setWidth(200);n.setPos(a);n.render()}function f(e){e.preventDefault();var t=$(this);var a={addon_id:c,id:t.attr("data-id")};var r=this.className=="selected"?s:o;if(t.hasClass("ajax-loading"))return;t.addClass("ajax-loading");$.post(r,a,function(e){n.html(e);$("a.outlink",n).click(i)},"html")}var h=function(e){e.preventDefault();var t=$(this);if(a.hasClass("ajax-loading"))return;a.addClass("ajax-loading");form_data=$("#add-to-collection form").serialize();$.post(l+"?addon_id="+c,form_data,d,"html")};var p=function(e){e.preventDefault();var t=$(this);$.get(l,{addon_id:c},function(e){n.html(e);n.setWidth(410);n.setPos(a);$("#id_name").focus()})};n.hideMe();n.unbind("click.popup",i);n.bind("click.popup",i);n.delegate("#ajax_collections_list li","click",f).delegate("#ajax_new_collection","click",p).delegate("#collections-new-cancel","click",u).delegate("#add-to-collection form","submit",h).delegate("#id_name","keyup",slugify).delegate("#id_name","blur",slugify).delegate("#edit_slug","click",show_slug_edit).delegate("#id_slug","change",function(){$("#id_slug").attr("data-customized",1);if(!$("#id_slug").val()){$("#id_slug").attr("data-customized",0);slugify()}});u();return false}});function i(e){e.stopPropagation()}});$(document).ready(function(){$(".widget.favorite").click(function(e){e.preventDefault();var t=$(this);var i={addon_id:t.attr("data-addonid")};var n=t.hasClass("faved");var a=n?t.attr("data-removeurl"):t.attr("data-addurl");var r=t.hasClass("condensed");if(t.hasClass("ajax-loading"))return;t.addClass("ajax-loading");$.ajax({url:a,data:i,type:"post",success:function(e){t.removeClass("ajax-loading");if(n){t.removeClass("faved");if(r)t.attr("title",gettext("Add to favorites"));else t.text(t.attr("data-unfavedtext"))}else{t.addClass("faved");if(r)t.attr("title",gettext("Remove from favorites"));else t.text(t.attr("data-favedtext"))}t.trigger("tooltip_change")},error:function(e){t.removeClass("ajax-loading")}})});$(".collection_widgets .watch").click(function(e){e.preventDefault();var t=$(this);if(t.hasClass("ajax-loading"))return;t.addClass("ajax-loading");var i=gettext("Follow this Collection");$.ajax({url:$(this).attr("href"),type:"POST",success:function(e){t.removeClass("ajax-loading");if(e.watching){t.addClass("watching");i=gettext("Stop following")}else{t.removeClass("watching")}if(t.hasClass("condensed")){t.attr("title",i);t.trigger("tooltip_change")}else{t.text(i)}},error:function(){t.removeClass("ajax-loading")}})});$("#sharing-popup").popup(".share.widget",{width:280,offset:{x:8},callback:function(e){var t={};var i=$(e.click_target);var n=this;var a=i.attr("data-base-url");var r=$.parseJSON(i.attr("data-share-counts"));n.hideMe();if(r){for(s in r){if(!r.hasOwnProperty(s))continue;var o=r[s];var l=$("li."+s,this);$(".share-count",l).text(o);$(".uniquify",l).attr("href",a+s)}}else{return false}t.pointTo=e.click_target;return t}});if($("#details-edit").length&&$("div.notification-box").length){$(document).scrollTop($("div.primary").position().top)}});$(function(){if(!$(document.body).hasClass("collections")){return}$(".watch").click(_pd(function(){var e=$(this),t=e.closest(".item");if(e.hasClass("ajax-loading"))return;e.addClass("ajax-loading");var i=gettext("Follow this Collection");$.ajax({url:$(this).attr("href"),type:"POST",success:function(n){t.removeClass("watching");e.removeClass("ajax-loading");if(n.watching){t.addClass("watching");i=gettext("Stop Following");$("<span>",{text:gettext("Following"),"class":"is-watching"}).insertBefore(e)}else{t.find(".is-watching").remove()}e.text(i)},error:function(){e.removeClass("ajax-loading")}})}))});(function(){$(document).ready(function(){"use strict";if($("#perf-results").length){e()}});function e(){"use strict";var e=$("#perf-results"),t=e.find("tbody tr").clone(),i=JSON.parse(e.attr("data-platforms")),n=[],a=e.attr("data-threshold");$("#perf-more a").click(function(t){t.preventDefault();$("#perf-more").remove();e.addClass("show-more")});i[gettext("All")]=0;e.find("tbody tr").each(function(e,t){var i=$(this).attr("data-platforms");n.push(i?JSON.parse(i):{})});if($("#show").length==0){return}r(gettext("All"));$("#show").delegate("a","click",function(e){e.preventDefault();r($.trim($(this).text()))});function r(r){var o=i[r],l=_.map(n,function(e,t){return[e[o]||0,t]}),c=$("<tbody>");l.sort(function(e,t){return t[0]-e[0]});var u=l[0][0];$.each(l,function(e,i){var n=i[0],r=i[1];if(n>a){var s=t.eq(r).clone();s.find(".slower b").text(n+"%");s.find(".bar").css("width",n/u*100+"%");s.find(".rank b").text(e+1);s.appendTo(c)}});e.find("tbody").replaceWith(c);s(r)}function s(e){var t=_.keys(i);t.sort();var n=$.map(t,function(t){var i=t==e?"<b>"+t+"</b>":t;return format('<a href="#">{0}</a>',i)});$("#show span").html(n.join(", "))}}})();$("#admin-login").click(function(){window.location=$(this).attr("data-url")});var RecaptchaOptions={theme:"custom"};$("#recaptcha_different").click(function(e){e.preventDefault();Recaptcha.reload()});$("#recaptcha_audio").click(function(e){e.preventDefault();var t=this.getAttribute("data-nextType")||"audio";Recaptcha.switch_type(t);this.setAttribute("data-nextType",t==="audio"?"image":"audio")});$("#recaptcha_help").click(function(e){e.preventDefault();Recaptcha.showhelp()});$(function(){$(".user-avatar img").click(_pd(function(e){window.location.hash="id="+$(".user-avatar").data("user-id");e.stopPropagation()}));$("#report-user-modal").modal("#report-user-abuse",{delegate:"#page"});if($("#user_edit").exists()){$(".more-all, .more-none").click(_pd(function(){var e=$(this);e.closest("li").find("input:not([disabled]").attr("checked",e.hasClass("more-all"))}))}$("#acct-password").hide();$("#change-acct-password").click(_pd(function(){$("#acct-password").fadeIn();$("#id_oldpassword").focus();$(this).closest("li").hide()}));$("#acct-password .errorlist li").exists(function(){$("#acct-password").show();$("#change-acct-password").closest("li").hide()});var e=$(".profile-photo .avatar"),t=$("<a>",{text:gettext("use original"),"class":"use-original delete",href:"#"}).hide();e.attr("data-original",e.attr("src"));function i(){$(".use-original").hide();$("#id_photo").val("");e.attr("src",e.attr("data-original"))}t.click(_pd(i));e.after(t);$("#id_photo").change(function(){var n=$(this).closest("li"),a=$(this)[0].files[0],r=a.name||a.fileName;n.find(".errorlist").remove();if(!r.match(/\.(jpg|png|jpeg)$/i)){$ul=$("<ul>",{"class":"errorlist"});$ul.append($("<li>",{text:gettext("Images must be either PNG or JPG.")}));n.append($ul);i();return}var s=$(this).objectUrl();if(s){t.css("display","inline");e.attr("src",s)}})});$("#admin-login").click(function(){window.location=$(this).attr("data-url")});z.getVars=function(e,t){if(typeof e==="undefined"){e=location.search}if(e&&e[0]=="?"){e=e.substr(1)}if(!e)return{};return _.chain(e.split("&")).map(function(e){return _.map(e.split("="),escape_)}).filter(function(e){return!!e[0]&&(!t||!_.isUndefined(e[1]))}).object().value()};JSON.parseNonNull=function(e){return JSON.parse(e,function(e,t){if(typeof t==="object"&&t===null){return""}return t})};function autofillPlatform(e){var t=$(e||document.body);$("#search",t).bind("autofill",function(e){var t=$(this);if(!t.find("#id_appver").length){return}var i=z.getVars(),n="",a="",r=typeof i.appver!=="undefined",s=typeof i.platform!=="undefined";if(r){n=i.appver}if(s){a=i.platform}if(z.appMatchesUserAgent){if(!r){n=z.browserVersion}if(!s){a=z.platform}}t.find("#id_appver").val(n);t.find("#id_platform").val(a)}).trigger("autofill")}autofillPlatform();$(function(){$("#search-facets").delegate("li.facet","click",function(e){var t=$(this);if(t.hasClass("active")){if($(e.target).is("a")){return}t.removeClass("active")}else{t.closest("ul").find(".active").removeClass("active");t.addClass("active")}}).delegate("a","highlight",function(e){var t=$(this);t.closest(".facet-group").find(".selected").removeClass("selected");t.closest("li").addClass("selected")}).delegate(".cnt","recount",function(e,t){var i=$(this);if(t.length&&i.html()!=t.html()){i.replaceWith(t)}}).delegate("a[data-params]","rebuild",function(e){var t=$(this),i=rebuildLink(t.attr("href"),t.attr("data-params"));t.attr("href",i)});if($("body").hasClass("pjax")&&$.support.pjax&&z.capabilities.JSON){$("#pjax-results").initSearchPjax($("#search-facets"))}});function rebuildLink(e,t,i){var n=JSON.parseNonNull(t),a=$.extend(z.getVars(i,true),n);return e.split("?")[0]+"?"+$.param(a)}$.fn.initSearchPjax=function(e){var t=$(this),i=t.selector,n;function a(e){var t=location.pathname+location.search;if(!!e&&e!="#"&&e!=t){$.pjax({url:e,container:i,timeout:5e3})}}function r(){n=$(this);a(n.attr("href"))}function s(){var e=t.closest(".results"),i=gettext("Updating results&hellip;"),n="updating";e.addClass("loading");if(t.outerHeight()>300){n+=" tall"}$("<div>",{"class":n,html:i}).insertBefore(t);t.trigger("search.loading")}function o(){var i=t.closest(".results");$.when(t.find(".install:not(.triggered)").installButton()).done(function(){t.find(".install").addClass("triggered");initListingCompat()});i.removeClass("loading").find(".updating").remove();e.find(".cnt").trigger("recount",[i.find(".cnt")]);e.find("a[data-params]").trigger("rebuild");if(n){n.trigger("highlight")}$("#search").trigger("autofill");$("html, body").animate({scrollTop:0},200);t.trigger("search.finished")}function l(e){if(fieldFocused(e)){return}if(e.which==$.ui.keyCode.LEFT||e.which==$.ui.keyCode.RIGHT){e.preventDefault();var i;if(e.which==$.ui.keyCode.LEFT){i=".paginator .prev:not(.disabled)"}else{i=".paginator .next:not(.disabled)"}a(t.find(i).attr("href"))}}$(".pjax-trigger a").live("click",_pd(r));t.bind("start.pjax",s).bind("end.pjax",o);$(document).keyup(_.throttle(l,300))};$.fn.highlightTerm=function(e){e=e.replace(/[^\w\s]/gi,"");var t=new RegExp(e,"gi");this.each(function(){var e=$(this),i=e.html(),n=i.replace(t,"<b>$&</b>");if(i!=n){e.html(n)}})};$.fn.searchSuggestions=function(e,t,i){var n=this,a=n.closest("form");if(!e.length){return}var r=e.attr("data-cat");if(i=="AMO"){var s;if(r=="themes"){s=gettext("Search themes for <b>{0}</b>")}else if(r=="apps"){s=gettext("Search apps for <b>{0}</b>")}else{s=gettext("Search add-ons for <b>{0}</b>")}var o=template('<div class="wrap">'+'<p><a class="sel" href="#"><span>{msg}</span></a></p><ul></ul>'+"</div>");e.html(o({msg:s}))}else if(i=="MKT"){e.html('<div class="wrap"><ul></ul></div>')}var l=[z.keys.SHIFT,z.keys.CONTROL,z.keys.ALT,z.keys.PAUSE,z.keys.CAPS_LOCK,z.keys.ESCAPE,z.keys.ENTER,z.keys.PAGE_UP,z.keys.PAGE_DOWN,z.keys.LEFT,z.keys.UP,z.keys.RIGHT,z.keys.DOWN,z.keys.HOME,z.keys.END,z.keys.COMMAND,z.keys.WINDOWS_RIGHT,z.keys.COMMAND_RIGHT,z.keys.WINDOWS_LEFT_OPERA,z.keys.WINDOWS_RIGHT_OPERA,z.keys.APPLE];var c=[z.keys.ESCAPE,z.keys.UP,z.keys.DOWN];function u(){e.find(".sel").removeClass("sel");e.removeClass("sel");e.find("a:first").addClass("sel")}function d(){e.find(".sel").removeClass("sel");e.removeClass("sel");e.find("a:last").addClass("sel")}function f(){e.removeClass("visible sel");if(i=="MKT"){$("#site-header").removeClass("suggestions");if(z.capabilities.mobile&&$("body.home").length===0){z.body.removeClass("show-search")}}}function h(t){if(!e.hasClass("visible")||$.inArray(t.which,c)<0||t.altKey||t.ctrlKey||t.metaKey||t.shiftKey){e.trigger("keyIgnored");return}t.preventDefault();if(t.which==z.keys.ESCAPE){f()}else if(t.which==z.keys.UP||t.which==z.keys.DOWN){var i=e.find(".sel"),n=e.find("a"),a=n.index(i.get(0));if(i.length&&a>=0){if(t.which==z.keys.UP){a=Math.max(0,a-1)}else{a=Math.min(a+1,n.length-1)}}else{a=0}i.removeClass("sel");n.eq(a).addClass("sel");e.addClass("sel").trigger("selectedRowUpdate",[a])}}function p(s){if(s.type==="paste"){g=true}var o=escape_(n.val());if(o.length<3){e.filter(".visible").removeClass("visible");return}var c={$results:e,$form:a,searchTerm:o};if(i=="AMO"||i=="MKT"){c["category"]=r}if((s.type==="keyup"&&typeof s.which==="undefined"||$.inArray(s.which,l)>=0)&&!g){e.trigger("inputIgnored")}else{t(c)}g=false}var m=0,g=false;if(z.capabilities.touch){n.focus(function(){if(m!==0){clearInterval(m)}m=setInterval(function(){h(n);p(n);return},150)})}else{n.bind("keydown",h).bind("keyup paste",_.throttle(p,250))}function v(e){clearInterval(m);_.delay(f,250);n.trigger("dismissed")}n.blur(v);a.submit(function(t){var i=e.find(".sel");if(i.length&&i.eq(0).attr("href")!="#"){t.stopPropagation();t.preventDefault();n.val("");i[0].click()}n.blur();v(t)});e.delegate("li, p","hover",function(){e.find(".sel").removeClass("sel");e.addClass("sel");$(this).find("a").addClass("sel")}).delegate("a","click",function(){v();n.val("")});e.bind("highlight",function(t,i){e.find("ul a span").highlightTerm(i);e.addClass("visible");if(!e.find(".sel").length){u()}});e.bind("dismiss",v);$(document).keyup(function(e){if(fieldFocused(e)){return}if(e.which==83){n.focus()}});return this};(function(){$("#search #search-q").searchSuggestions($("#site-search-suggestions"),e,"AMO");function e(e){if(!e||!e.category){return}e["$results"].find("p b").html(format('"{0}"',e.searchTerm));var t=template('<li><a href="{url}"><span {cls} {icon}>{name}</span>{subtitle}</a></li>');$.ajaxCache({url:e["$results"].attr("data-src"),data:e["$form"].serialize()+"&cat="+e.category,newItems:function(i,n){var a;if(n!==undefined){var r="";$.each(n,function(e,i){var n={url:escape_(i.url)||"#",icon:"",cls:"",subtitle:""};if(i.icon){n.icon=format('style="background-image:url({0})"',escape_(i.icon))}if(i.cls){n.cls=format('class="{0}"',escape_(i.cls));if(i.cls=="cat"){n.subtitle=format(' <em class="subtitle">{0}</em>',gettext("Category"))}}if(i.name){n.name=escape_(i.name);r+=t(n)}});e["$results"].find("ul").html(r)}e["$results"].trigger("highlight",[e.searchTerm]).trigger("resultsUpdated",[n])}})}})();if($(".login .browserid").length){$("#show-normal-login").click(_pd(function(e){$("#browserid-login").hide();$(".user-message").hide();$("#normal-login").show();$("#id_username").focus();$(window).trigger("resize")}));if($("form .notification-box, form .errorlist li").length||window.location.hash=="#open"){$("#show-normal-login").trigger("click")}}$(".login #id_username:visible").focus();setTimeout(function(){$(document).ready(function(){$('a[href^="http://outgoing.mozilla.org"]').each(function(e){var t=$(this),i=t.attr("href"),n=unescape(i.split("/").slice(5).join("/"));t.attr("href",n);t.click(function(e){t.attr("href",i);setTimeout(function(){t.attr("href",n)},100);return true})})})},50);